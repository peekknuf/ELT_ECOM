[0m18:00:02.470561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb72c2140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb522f2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb522f250>]}


============================== 18:00:02.473434 | 0fa2101d-8995-44cf-87b7-ffe5afb431ca ==============================
[0m18:00:02.473434 [info ] [MainThread]: Running with dbt=1.7.2
[0m18:00:02.473885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peek/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt init', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:00:10.448267 [debug] [MainThread]: Starter project path: /home/peek/.local/lib/python3.10/site-packages/dbt/include/starter_project
[0m18:00:10.452598 [info ] [MainThread]: 
Your new dbt project "ecom" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m18:00:10.453125 [info ] [MainThread]: Setting up your profile.
[0m18:00:16.668118 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 14.22924, "process_user_time": 1.411529, "process_kernel_time": 0.040329, "process_mem_max_rss": "120964", "process_in_blocks": "93040", "process_out_blocks": "80"}
[0m18:00:16.668719 [debug] [MainThread]: Command `dbt init` succeeded at 18:00:16.668592 after 14.23 seconds
[0m18:00:16.669088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb72c2140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb522f280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb522f4f0>]}
[0m18:00:16.669441 [debug] [MainThread]: Flushing usage events
[0m20:17:14.849413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d654360e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d6338b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d6338b3a0>]}


============================== 20:17:14.852085 | da2396a9-8dfc-432d-96bb-6b542e0e745a ==============================
[0m20:17:14.852085 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:17:14.852539 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peek/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/peek/code/ecom/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:17:15.075723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da2396a9-8dfc-432d-96bb-6b542e0e745a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d6338b430>]}
[0m20:17:15.137622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da2396a9-8dfc-432d-96bb-6b542e0e745a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d586ebfa0>]}
[0m20:17:15.139188 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m20:17:15.145217 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m20:17:15.145698 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:17:15.146058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'da2396a9-8dfc-432d-96bb-6b542e0e745a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d58630160>]}
[0m20:17:15.907681 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'OBT_ECON' in the 'models' section of file 'models/example/schema.yml'
[0m20:17:15.908888 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m20:17:15.975791 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.ecom.unique_OBT_ECON_id.12d027882e' (models/example/schema.yml) depends on a node named 'OBT_ECON' in package '' which was not found
[0m20:17:15.976356 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.ecom.not_null_OBT_ECON_id.e8ba306a20' (models/example/schema.yml) depends on a node named 'OBT_ECON' in package '' which was not found
[0m20:17:15.977701 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.ecom.unique_my_second_dbt_model_id.57a0f8c493' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m20:17:15.978128 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.ecom.not_null_my_second_dbt_model_id.151b76d778' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m20:17:15.999466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da2396a9-8dfc-432d-96bb-6b542e0e745a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d562800d0>]}
[0m20:17:16.008027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da2396a9-8dfc-432d-96bb-6b542e0e745a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d5840b940>]}
[0m20:17:16.008524 [info ] [MainThread]: Found 3 models, 11 seeds, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m20:17:16.008879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da2396a9-8dfc-432d-96bb-6b542e0e745a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d632f7d60>]}
[0m20:17:16.010145 [info ] [MainThread]: 
[0m20:17:16.010487 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:17:16.010923 [debug] [MainThread]: Command end result
[0m20:17:16.017109 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.2009126, "process_user_time": 2.44063, "process_kernel_time": 0.221875, "process_mem_max_rss": "136652", "process_in_blocks": "1424", "process_out_blocks": "2448"}
[0m20:17:16.017726 [debug] [MainThread]: Command `dbt test` succeeded at 20:17:16.017605 after 1.20 seconds
[0m20:17:16.018077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d654360e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d586ea2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d585b81c0>]}
[0m20:17:16.018433 [debug] [MainThread]: Flushing usage events
[0m20:23:47.947217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a35ba1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a151f430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a151f3d0>]}


============================== 20:23:47.950484 | 60f43b1c-429b-4ecf-ac94-e0bcbb971c1e ==============================
[0m20:23:47.950484 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:23:47.950981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peek/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/peek/code/ecom/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:23:48.109421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60f43b1c-429b-4ecf-ac94-e0bcbb971c1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a151f460>]}
[0m20:23:48.174506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60f43b1c-429b-4ecf-ac94-e0bcbb971c1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3965f76a0>]}
[0m20:23:48.175246 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m20:23:48.180700 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m20:23:48.188622 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:23:48.189163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '60f43b1c-429b-4ecf-ac94-e0bcbb971c1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3967cda20>]}
[0m20:23:48.191851 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading ecom: example/schema.yml - Runtime Error
    Syntax error near line 27
    ------------------------------
    24 |       - name: email
    25 |       - name: address
    26 |       - name: timestamp
    27 |       = name: revenue
    28 | 
    29 |   - name: aggregates
    30 |     description: "aggregates for dashboard"
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 19, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 27, column 7
[0m20:23:48.192611 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.27803054, "process_user_time": 1.623159, "process_kernel_time": 0.070136, "process_mem_max_rss": "127076", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m20:23:48.193101 [debug] [MainThread]: Command `dbt test` failed at 20:23:48.192984 after 0.28 seconds
[0m20:23:48.193462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a35ba1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff396667160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff396666b00>]}
[0m20:23:48.193803 [debug] [MainThread]: Flushing usage events
[0m20:24:14.648877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff74dbe60e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff74bb4b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff74bb4b370>]}


============================== 20:24:14.650878 | 7f3fc70d-ec76-4f41-8c63-4832a1a6dfb3 ==============================
[0m20:24:14.650878 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:24:14.651338 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peek/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/peek/code/ecom/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:24:14.802425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f3fc70d-ec76-4f41-8c63-4832a1a6dfb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff74bb4b400>]}
[0m20:24:14.868636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f3fc70d-ec76-4f41-8c63-4832a1a6dfb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff748d125c0>]}
[0m20:24:14.869437 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m20:24:14.875234 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m20:24:14.882343 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:24:14.882843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7f3fc70d-ec76-4f41-8c63-4832a1a6dfb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff74b9e86a0>]}
[0m20:24:15.644388 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ecom.revenue' (models/example/revenue.sql) depends on a node named 'OBT' which was not found
[0m20:24:15.645302 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.0272987, "process_user_time": 2.283132, "process_kernel_time": 0.12961, "process_mem_max_rss": "133808", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m20:24:15.645808 [debug] [MainThread]: Command `dbt test` failed at 20:24:15.645689 after 1.03 seconds
[0m20:24:15.646172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff74dbe60e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73284ace0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff732860520>]}
[0m20:24:15.646530 [debug] [MainThread]: Flushing usage events
[0m20:24:34.799415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff18bdc2140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff189d2b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff189d2b3d0>]}


============================== 20:24:34.801428 | 0f320614-b2c6-468b-b808-5559b8eeaddb ==============================
[0m20:24:34.801428 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:24:34.801920 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/peek/code/ecom/logs', 'profiles_dir': '/home/peek/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:24:34.951610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f320614-b2c6-468b-b808-5559b8eeaddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff189d2b460>]}
[0m20:24:35.017332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f320614-b2c6-468b-b808-5559b8eeaddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17f0e4e20>]}
[0m20:24:35.018096 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m20:24:35.023536 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m20:24:35.030881 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:24:35.031393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0f320614-b2c6-468b-b808-5559b8eeaddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1869291b0>]}
[0m20:24:35.814302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f320614-b2c6-468b-b808-5559b8eeaddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17cbe6530>]}
[0m20:24:35.822865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f320614-b2c6-468b-b808-5559b8eeaddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17cc18df0>]}
[0m20:24:35.823360 [info ] [MainThread]: Found 3 models, 11 seeds, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m20:24:35.823770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f320614-b2c6-468b-b808-5559b8eeaddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17cc1b610>]}
[0m20:24:35.825267 [info ] [MainThread]: 
[0m20:24:35.825626 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:24:35.826094 [debug] [MainThread]: Command end result
[0m20:24:35.833076 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.0652663, "process_user_time": 2.367818, "process_kernel_time": 0.039963, "process_mem_max_rss": "132880", "process_out_blocks": "2424", "process_in_blocks": "0"}
[0m20:24:35.833633 [debug] [MainThread]: Command `dbt test` succeeded at 20:24:35.833516 after 1.07 seconds
[0m20:24:35.833990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff18bdc2140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17ed12380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17cc18df0>]}
[0m20:24:35.834341 [debug] [MainThread]: Flushing usage events
[0m20:24:48.331762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c619a60e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5f90f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5f90f370>]}


============================== 20:24:48.333793 | c8b2f620-1851-4d94-b7c9-82e275ef6e2e ==============================
[0m20:24:48.333793 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:24:48.334252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/peek/code/ecom/logs', 'profiles_dir': '/home/peek/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:24:48.486097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8b2f620-1851-4d94-b7c9-82e275ef6e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5f90f400>]}
[0m20:24:48.551317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8b2f620-1851-4d94-b7c9-82e275ef6e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c54bed720>]}
[0m20:24:48.552109 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m20:24:48.557841 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m20:24:48.575155 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:24:48.575605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:24:48.580619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8b2f620-1851-4d94-b7c9-82e275ef6e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5480c0d0>]}
[0m20:24:48.588379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8b2f620-1851-4d94-b7c9-82e275ef6e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5490b0a0>]}
[0m20:24:48.588887 [info ] [MainThread]: Found 3 models, 11 seeds, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m20:24:48.589238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8b2f620-1851-4d94-b7c9-82e275ef6e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5490b220>]}
[0m20:24:48.590508 [info ] [MainThread]: 
[0m20:24:48.591166 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:24:48.592761 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m20:24:48.601341 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m20:24:48.601726 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m20:24:48.602047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:48.620752 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:24:48.623555 [debug] [ThreadPool]: On list_ecom: Close
[0m20:24:48.626216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m20:24:48.626861 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m20:24:48.630603 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:24:48.630950 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m20:24:48.631242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:48.635529 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:24:48.635997 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:24:48.636311 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m20:24:48.636894 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:24:48.637740 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m20:24:48.638052 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:24:48.638340 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m20:24:48.638702 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:24:48.639016 [debug] [ThreadPool]: On create_ecom_main: Close
[0m20:24:48.642181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m20:24:48.647011 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m20:24:48.647458 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m20:24:48.647774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:48.652793 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:24:48.653277 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m20:24:48.653583 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m20:24:48.665856 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:24:48.671676 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m20:24:48.672830 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m20:24:48.673144 [debug] [ThreadPool]: On list_ecom_main: Close
[0m20:24:48.675622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8b2f620-1851-4d94-b7c9-82e275ef6e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5484dd50>]}
[0m20:24:48.676338 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:48.676752 [debug] [MainThread]: On master: BEGIN
[0m20:24:48.677043 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:24:48.681084 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:24:48.681439 [debug] [MainThread]: On master: COMMIT
[0m20:24:48.681734 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:48.682020 [debug] [MainThread]: On master: COMMIT
[0m20:24:48.682354 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:24:48.682706 [debug] [MainThread]: On master: Close
[0m20:24:48.684760 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:24:48.685231 [info ] [MainThread]: 
[0m20:24:48.688224 [debug] [Thread-1 (]: Began running node model.ecom.OBT_ECON
[0m20:24:48.688745 [info ] [Thread-1 (]: 1 of 3 START sql table model main.OBT_ECON ..................................... [RUN]
[0m20:24:48.689434 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.OBT_ECON'
[0m20:24:48.689783 [debug] [Thread-1 (]: Began compiling node model.ecom.OBT_ECON
[0m20:24:48.695138 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.OBT_ECON"
[0m20:24:48.696435 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECON (compile): 20:24:48.690001 => 20:24:48.696219
[0m20:24:48.696800 [debug] [Thread-1 (]: Began executing node model.ecom.OBT_ECON
[0m20:24:48.720789 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.OBT_ECON"
[0m20:24:48.722428 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:24:48.722800 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: BEGIN
[0m20:24:48.723140 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:24:48.727896 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:24:48.728355 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:24:48.728716 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */

  
    
    

    create  table
      "ecom"."main"."OBT_ECON__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



select *
from econ0
union all
select *
from econ1
union all
select *
from econ2
union all
select *
from econ3
union all
select *
from econ4
union all
select *
from econ5
union all
select *
from econ6
union all
select *
from econ7
union all
select *
from econ8
union all
select *
from econ9
union all
select *
from econ10;

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m20:24:48.737048 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECON (execute): 20:24:48.697044 => 20:24:48.736809
[0m20:24:48.737493 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: ROLLBACK
[0m20:24:48.742778 [debug] [Thread-1 (]: Failed to rollback 'model.ecom.OBT_ECON'
[0m20:24:48.743161 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: Close
[0m20:24:48.745592 [debug] [Thread-1 (]: Runtime Error in model OBT_ECON (models/example/OBT_ECON.sql)
  Parser Error: syntax error at or near ";"
  LINE 52: from econ10;
                      ^
[0m20:24:48.746108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8b2f620-1851-4d94-b7c9-82e275ef6e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5486a9b0>]}
[0m20:24:48.746672 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model main.OBT_ECON ............................ [[31mERROR[0m in 0.06s]
[0m20:24:48.747217 [debug] [Thread-1 (]: Finished running node model.ecom.OBT_ECON
[0m20:24:48.748158 [debug] [Thread-1 (]: Began running node model.ecom.revenue
[0m20:24:48.748538 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.revenue .............................................. [[33mSKIP[0m]
[0m20:24:48.748941 [debug] [Thread-1 (]: Finished running node model.ecom.revenue
[0m20:24:48.749568 [debug] [Thread-1 (]: Began running node model.ecom.aggregates
[0m20:24:48.749922 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.aggregates ........................................... [[33mSKIP[0m]
[0m20:24:48.750307 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates
[0m20:24:48.751780 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:48.752278 [debug] [MainThread]: On master: BEGIN
[0m20:24:48.752586 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:24:48.756472 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:24:48.756837 [debug] [MainThread]: On master: COMMIT
[0m20:24:48.757133 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:48.757480 [debug] [MainThread]: On master: COMMIT
[0m20:24:48.757824 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:24:48.758135 [debug] [MainThread]: On master: Close
[0m20:24:48.760034 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:24:48.760518 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m20:24:48.760830 [debug] [MainThread]: Connection 'model.ecom.OBT_ECON' was properly closed.
[0m20:24:48.761177 [info ] [MainThread]: 
[0m20:24:48.761528 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m20:24:48.762123 [debug] [MainThread]: Command end result
[0m20:24:48.768978 [info ] [MainThread]: 
[0m20:24:48.769480 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:24:48.769820 [info ] [MainThread]: 
[0m20:24:48.770149 [error] [MainThread]:   Runtime Error in model OBT_ECON (models/example/OBT_ECON.sql)
  Parser Error: syntax error at or near ";"
  LINE 52: from econ10;
                      ^
[0m20:24:48.770508 [info ] [MainThread]: 
[0m20:24:48.770879 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m20:24:48.771596 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.47146013, "process_user_time": 1.711916, "process_kernel_time": 0.0901, "process_mem_max_rss": "139628", "process_in_blocks": "8456", "process_out_blocks": "1696", "command_success": false}
[0m20:24:48.772086 [debug] [MainThread]: Command `dbt run` failed at 20:24:48.771971 after 0.47 seconds
[0m20:24:48.772452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c619a60e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c54b31630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c54bed720>]}
[0m20:24:48.772890 [debug] [MainThread]: Flushing usage events
[0m20:34:33.324399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f488be9e1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4889df3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4889df33d0>]}


============================== 20:34:33.326993 | 699e9b6e-bf40-4829-999e-410fdba1125f ==============================
[0m20:34:33.326993 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:34:33.327538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peek/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/peek/code/ecom/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:34:33.498407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '699e9b6e-bf40-4829-999e-410fdba1125f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4889df3460>]}
[0m20:34:33.569907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '699e9b6e-bf40-4829-999e-410fdba1125f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f487f0eb6a0>]}
[0m20:34:33.570821 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m20:34:33.576976 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m20:34:33.596040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:34:33.596524 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:34:33.602527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '699e9b6e-bf40-4829-999e-410fdba1125f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f487ed0c130>]}
[0m20:34:33.612211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '699e9b6e-bf40-4829-999e-410fdba1125f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f487ee13130>]}
[0m20:34:33.612777 [info ] [MainThread]: Found 3 models, 11 seeds, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m20:34:33.613243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '699e9b6e-bf40-4829-999e-410fdba1125f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f487ee132e0>]}
[0m20:34:33.614658 [info ] [MainThread]: 
[0m20:34:33.615487 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:34:33.616637 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m20:34:33.626332 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m20:34:33.626826 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m20:34:33.627166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:33.635054 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:34:33.636577 [debug] [ThreadPool]: On list_ecom: Close
[0m20:34:33.639889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m20:34:33.640669 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m20:34:33.645676 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:34:33.646347 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m20:34:33.646825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:34:33.653881 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:34:33.654587 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:34:33.655171 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m20:34:33.655766 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:34:33.656918 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m20:34:33.657362 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:34:33.657806 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m20:34:33.658452 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:34:33.658899 [debug] [ThreadPool]: On create_ecom_main: Close
[0m20:34:33.662797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m20:34:33.668166 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m20:34:33.668657 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m20:34:33.669028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:34:33.674241 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:34:33.674620 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m20:34:33.674959 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m20:34:33.687410 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:34:33.690802 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m20:34:33.691641 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m20:34:33.692000 [debug] [ThreadPool]: On list_ecom_main: Close
[0m20:34:33.694735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '699e9b6e-bf40-4829-999e-410fdba1125f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f487ed4d8d0>]}
[0m20:34:33.695485 [debug] [MainThread]: Using duckdb connection "master"
[0m20:34:33.696184 [debug] [MainThread]: On master: BEGIN
[0m20:34:33.696629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:34:33.701365 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:34:33.701867 [debug] [MainThread]: On master: COMMIT
[0m20:34:33.702212 [debug] [MainThread]: Using duckdb connection "master"
[0m20:34:33.702537 [debug] [MainThread]: On master: COMMIT
[0m20:34:33.702917 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:34:33.703279 [debug] [MainThread]: On master: Close
[0m20:34:33.705347 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:34:33.705812 [info ] [MainThread]: 
[0m20:34:33.709346 [debug] [Thread-1 (]: Began running node model.ecom.OBT_ECON
[0m20:34:33.709880 [info ] [Thread-1 (]: 1 of 3 START sql table model main.OBT_ECON ..................................... [RUN]
[0m20:34:33.710651 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.OBT_ECON'
[0m20:34:33.711036 [debug] [Thread-1 (]: Began compiling node model.ecom.OBT_ECON
[0m20:34:33.716929 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.OBT_ECON"
[0m20:34:33.717619 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECON (compile): 20:34:33.711264 => 20:34:33.717377
[0m20:34:33.718000 [debug] [Thread-1 (]: Began executing node model.ecom.OBT_ECON
[0m20:34:33.743586 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.OBT_ECON"
[0m20:34:33.744419 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:34:33.744821 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: BEGIN
[0m20:34:33.745187 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:34:33.751301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:34:33.751859 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:34:33.752271 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */

  
    
    

    create  table
      "ecom"."main"."OBT_ECON__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



select *
from econ0
union all
select *
from econ1
union all
select *
from econ2
union all
select *
from econ3
union all
select *
from econ4
union all
select *
from econ5
union all
select *
from econ6
union all
select *
from econ7
union all
select *
from econ8
union all
select *
from econ9
union all
select *
from econ10;

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m20:34:33.753129 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECON (execute): 20:34:33.718378 => 20:34:33.752915
[0m20:34:33.753514 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: ROLLBACK
[0m20:34:33.754914 [debug] [Thread-1 (]: Failed to rollback 'model.ecom.OBT_ECON'
[0m20:34:33.755301 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: Close
[0m20:34:33.758220 [debug] [Thread-1 (]: Runtime Error in model OBT_ECON (models/example/OBT_ECON.sql)
  Parser Error: syntax error at or near ";"
  LINE 52: from econ10;
                      ^
[0m20:34:33.758751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '699e9b6e-bf40-4829-999e-410fdba1125f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f487ed6aa70>]}
[0m20:34:33.759350 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model main.OBT_ECON ............................ [[31mERROR[0m in 0.05s]
[0m20:34:33.759935 [debug] [Thread-1 (]: Finished running node model.ecom.OBT_ECON
[0m20:34:33.761202 [debug] [Thread-1 (]: Began running node model.ecom.revenue
[0m20:34:33.761637 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.revenue .............................................. [[33mSKIP[0m]
[0m20:34:33.762144 [debug] [Thread-1 (]: Finished running node model.ecom.revenue
[0m20:34:33.763587 [debug] [Thread-1 (]: Began running node model.ecom.aggregates
[0m20:34:33.763999 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.aggregates ........................................... [[33mSKIP[0m]
[0m20:34:33.764456 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates
[0m20:34:33.766472 [debug] [MainThread]: Using duckdb connection "master"
[0m20:34:33.766991 [debug] [MainThread]: On master: BEGIN
[0m20:34:33.767316 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:34:33.771772 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:34:33.772177 [debug] [MainThread]: On master: COMMIT
[0m20:34:33.772505 [debug] [MainThread]: Using duckdb connection "master"
[0m20:34:33.772839 [debug] [MainThread]: On master: COMMIT
[0m20:34:33.773320 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:34:33.773692 [debug] [MainThread]: On master: Close
[0m20:34:33.775850 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:34:33.776224 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m20:34:33.776543 [debug] [MainThread]: Connection 'model.ecom.OBT_ECON' was properly closed.
[0m20:34:33.776951 [info ] [MainThread]: 
[0m20:34:33.777353 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m20:34:33.778195 [debug] [MainThread]: Command end result
[0m20:34:33.785053 [info ] [MainThread]: 
[0m20:34:33.785595 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:34:33.785967 [info ] [MainThread]: 
[0m20:34:33.786318 [error] [MainThread]:   Runtime Error in model OBT_ECON (models/example/OBT_ECON.sql)
  Parser Error: syntax error at or near ";"
  LINE 52: from econ10;
                      ^
[0m20:34:33.786662 [info ] [MainThread]: 
[0m20:34:33.787022 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m20:34:33.787764 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.49875134, "process_user_time": 1.845067, "process_kernel_time": 0.13838, "process_mem_max_rss": "145324", "process_out_blocks": "1672", "command_success": false, "process_in_blocks": "0"}
[0m20:34:33.788329 [debug] [MainThread]: Command `dbt run` failed at 20:34:33.788198 after 0.50 seconds
[0m20:34:33.788736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f488be9e1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f487ed4d840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f487ed6b670>]}
[0m20:34:33.789129 [debug] [MainThread]: Flushing usage events
[0m20:34:41.889175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7249a2e140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7247997430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72479973d0>]}


============================== 20:34:41.891899 | de5b2019-2ab4-44ea-b9c0-a295e798ee57 ==============================
[0m20:34:41.891899 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:34:41.892507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peek/code/ecom/logs', 'debug': 'False', 'profiles_dir': '/home/peek/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:34:42.069221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de5b2019-2ab4-44ea-b9c0-a295e798ee57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7247997460>]}
[0m20:34:42.141182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de5b2019-2ab4-44ea-b9c0-a295e798ee57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723cce8e20>]}
[0m20:34:42.142021 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m20:34:42.148681 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m20:34:42.166796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:34:42.167331 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:34:42.173045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de5b2019-2ab4-44ea-b9c0-a295e798ee57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723c9080d0>]}
[0m20:34:42.182334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de5b2019-2ab4-44ea-b9c0-a295e798ee57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723ca030d0>]}
[0m20:34:42.182919 [info ] [MainThread]: Found 3 models, 11 seeds, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m20:34:42.183330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de5b2019-2ab4-44ea-b9c0-a295e798ee57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723ca03280>]}
[0m20:34:42.184876 [info ] [MainThread]: 
[0m20:34:42.185681 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:34:42.186728 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m20:34:42.196954 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m20:34:42.197459 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m20:34:42.197797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:42.204645 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:34:42.206020 [debug] [ThreadPool]: On list_ecom: Close
[0m20:34:42.209907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m20:34:42.210670 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m20:34:42.215040 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:34:42.215546 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m20:34:42.215929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:34:42.220345 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:34:42.220878 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:34:42.221241 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m20:34:42.221825 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:34:42.222745 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m20:34:42.223099 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:34:42.223433 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m20:34:42.223878 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:34:42.224228 [debug] [ThreadPool]: On create_ecom_main: Close
[0m20:34:42.227773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m20:34:42.233889 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m20:34:42.234348 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m20:34:42.234686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:34:42.239329 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:34:42.239811 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m20:34:42.240162 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m20:34:42.253648 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:34:42.256821 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m20:34:42.257375 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m20:34:42.257734 [debug] [ThreadPool]: On list_ecom_main: Close
[0m20:34:42.260593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de5b2019-2ab4-44ea-b9c0-a295e798ee57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723c949870>]}
[0m20:34:42.261175 [debug] [MainThread]: Using duckdb connection "master"
[0m20:34:42.261882 [debug] [MainThread]: On master: BEGIN
[0m20:34:42.262362 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:34:42.266899 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:34:42.267413 [debug] [MainThread]: On master: COMMIT
[0m20:34:42.267756 [debug] [MainThread]: Using duckdb connection "master"
[0m20:34:42.268098 [debug] [MainThread]: On master: COMMIT
[0m20:34:42.268543 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:34:42.268881 [debug] [MainThread]: On master: Close
[0m20:34:42.270751 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:34:42.271185 [info ] [MainThread]: 
[0m20:34:42.274266 [debug] [Thread-1 (]: Began running node model.ecom.OBT_ECON
[0m20:34:42.274853 [info ] [Thread-1 (]: 1 of 3 START sql table model main.OBT_ECON ..................................... [RUN]
[0m20:34:42.275669 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.OBT_ECON'
[0m20:34:42.276057 [debug] [Thread-1 (]: Began compiling node model.ecom.OBT_ECON
[0m20:34:42.281972 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.OBT_ECON"
[0m20:34:42.282800 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECON (compile): 20:34:42.276307 => 20:34:42.282542
[0m20:34:42.283212 [debug] [Thread-1 (]: Began executing node model.ecom.OBT_ECON
[0m20:34:42.308929 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.OBT_ECON"
[0m20:34:42.309677 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:34:42.310062 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: BEGIN
[0m20:34:42.310413 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:34:42.316711 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:34:42.317234 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:34:42.317624 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */

  
    
    

    create  table
      "ecom"."main"."OBT_ECON__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



select *
from econ0
union all
select *
from econ1
union all
select *
from econ2
union all
select *
from econ3
union all
select *
from econ4
union all
select *
from econ5
union all
select *
from econ6
union all
select *
from econ7
union all
select *
from econ8
union all
select *
from econ9
union all
select *
from econ10;

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m20:34:42.318447 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECON (execute): 20:34:42.283465 => 20:34:42.318236
[0m20:34:42.318830 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: ROLLBACK
[0m20:34:42.320421 [debug] [Thread-1 (]: Failed to rollback 'model.ecom.OBT_ECON'
[0m20:34:42.320826 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: Close
[0m20:34:42.322993 [debug] [Thread-1 (]: Runtime Error in model OBT_ECON (models/example/OBT_ECON.sql)
  Parser Error: syntax error at or near ";"
  LINE 52: from econ10;
                      ^
[0m20:34:42.323482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de5b2019-2ab4-44ea-b9c0-a295e798ee57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723c966a10>]}
[0m20:34:42.324072 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model main.OBT_ECON ............................ [[31mERROR[0m in 0.05s]
[0m20:34:42.324681 [debug] [Thread-1 (]: Finished running node model.ecom.OBT_ECON
[0m20:34:42.325844 [debug] [Thread-1 (]: Began running node model.ecom.revenue
[0m20:34:42.326697 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.revenue .............................................. [[33mSKIP[0m]
[0m20:34:42.327230 [debug] [Thread-1 (]: Finished running node model.ecom.revenue
[0m20:34:42.328332 [debug] [Thread-1 (]: Began running node model.ecom.aggregates
[0m20:34:42.328744 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.aggregates ........................................... [[33mSKIP[0m]
[0m20:34:42.329187 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates
[0m20:34:42.330508 [debug] [MainThread]: Using duckdb connection "master"
[0m20:34:42.330863 [debug] [MainThread]: On master: BEGIN
[0m20:34:42.331199 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:34:42.335618 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:34:42.336111 [debug] [MainThread]: On master: COMMIT
[0m20:34:42.336449 [debug] [MainThread]: Using duckdb connection "master"
[0m20:34:42.336768 [debug] [MainThread]: On master: COMMIT
[0m20:34:42.337143 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:34:42.337493 [debug] [MainThread]: On master: Close
[0m20:34:42.339331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:34:42.339672 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m20:34:42.339998 [debug] [MainThread]: Connection 'model.ecom.OBT_ECON' was properly closed.
[0m20:34:42.340386 [info ] [MainThread]: 
[0m20:34:42.340792 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m20:34:42.341553 [debug] [MainThread]: Command end result
[0m20:34:42.348040 [info ] [MainThread]: 
[0m20:34:42.348584 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:34:42.348932 [info ] [MainThread]: 
[0m20:34:42.349333 [error] [MainThread]:   Runtime Error in model OBT_ECON (models/example/OBT_ECON.sql)
  Parser Error: syntax error at or near ";"
  LINE 52: from econ10;
                      ^
[0m20:34:42.349799 [info ] [MainThread]: 
[0m20:34:42.350213 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m20:34:42.351074 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.49814904, "process_user_time": 1.773164, "process_kernel_time": 0.183747, "process_mem_max_rss": "143060", "process_out_blocks": "1664", "command_success": false, "process_in_blocks": "0"}
[0m20:34:42.351615 [debug] [MainThread]: Command `dbt run` failed at 20:34:42.351487 after 0.50 seconds
[0m20:34:42.352010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7249a2e140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7247997460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f724453c6d0>]}
[0m20:34:42.352403 [debug] [MainThread]: Flushing usage events
[0m20:34:52.966274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc004ede140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc002e43430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc002e433d0>]}


============================== 20:34:52.968667 | 8782e151-e37b-4b05-bc5b-609832377303 ==============================
[0m20:34:52.968667 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:34:52.969224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/peek/.dbt', 'log_path': '/home/peek/code/ecom/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:34:53.142752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8782e151-e37b-4b05-bc5b-609832377303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc002e43460>]}
[0m20:34:53.217740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8782e151-e37b-4b05-bc5b-609832377303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff8000e20>]}
[0m20:34:53.218740 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m20:34:53.225328 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m20:34:53.244952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:34:53.245746 [debug] [MainThread]: Partial parsing: updated file: ecom://models/example/OBT_ECON.sql
[0m20:34:53.425558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8782e151-e37b-4b05-bc5b-609832377303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff5c31f00>]}
[0m20:34:53.434322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8782e151-e37b-4b05-bc5b-609832377303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff7f1b0d0>]}
[0m20:34:53.434871 [info ] [MainThread]: Found 3 models, 11 seeds, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m20:34:53.435270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8782e151-e37b-4b05-bc5b-609832377303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff7f1b280>]}
[0m20:34:53.436643 [info ] [MainThread]: 
[0m20:34:53.437380 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:34:53.439037 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m20:34:53.449444 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m20:34:53.449908 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m20:34:53.450277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:53.460724 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:34:53.462212 [debug] [ThreadPool]: On list_ecom: Close
[0m20:34:53.465000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m20:34:53.465634 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m20:34:53.469865 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:34:53.470263 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m20:34:53.470583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:34:53.475099 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:34:53.475588 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:34:53.475987 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m20:34:53.476463 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:34:53.477370 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m20:34:53.477708 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:34:53.478056 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m20:34:53.478479 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:34:53.478838 [debug] [ThreadPool]: On create_ecom_main: Close
[0m20:34:53.482634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m20:34:53.487757 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m20:34:53.488252 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m20:34:53.488578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:34:53.493873 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:34:53.494379 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m20:34:53.494722 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m20:34:53.506871 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:34:53.510676 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m20:34:53.511311 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m20:34:53.511639 [debug] [ThreadPool]: On list_ecom_main: Close
[0m20:34:53.515036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8782e151-e37b-4b05-bc5b-609832377303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff5c73d60>]}
[0m20:34:53.515562 [debug] [MainThread]: Using duckdb connection "master"
[0m20:34:53.515905 [debug] [MainThread]: On master: BEGIN
[0m20:34:53.516220 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:34:53.521702 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:34:53.522254 [debug] [MainThread]: On master: COMMIT
[0m20:34:53.522601 [debug] [MainThread]: Using duckdb connection "master"
[0m20:34:53.523027 [debug] [MainThread]: On master: COMMIT
[0m20:34:53.523434 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:34:53.523775 [debug] [MainThread]: On master: Close
[0m20:34:53.525831 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:34:53.526232 [info ] [MainThread]: 
[0m20:34:53.528891 [debug] [Thread-1 (]: Began running node model.ecom.OBT_ECON
[0m20:34:53.529434 [info ] [Thread-1 (]: 1 of 3 START sql table model main.OBT_ECON ..................................... [RUN]
[0m20:34:53.530190 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.OBT_ECON'
[0m20:34:53.530572 [debug] [Thread-1 (]: Began compiling node model.ecom.OBT_ECON
[0m20:34:53.536675 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.OBT_ECON"
[0m20:34:53.537384 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECON (compile): 20:34:53.530819 => 20:34:53.537128
[0m20:34:53.537818 [debug] [Thread-1 (]: Began executing node model.ecom.OBT_ECON
[0m20:34:53.564855 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.OBT_ECON"
[0m20:34:53.565629 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:34:53.566109 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: BEGIN
[0m20:34:53.566497 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:34:53.572105 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:34:53.572567 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:34:53.572981 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */

  
    
    

    create  table
      "ecom"."main"."OBT_ECON__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



select *
from econ0
union all
select *
from econ1
union all
select *
from econ2
union all
select *
from econ3
union all
select *
from econ4
union all
select *
from econ5
union all
select *
from econ6
union all
select *
from econ7
union all
select *
from econ8
union all
select *
from econ9
union all
select *
from econ10

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m20:34:53.589119 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECON (execute): 20:34:53.538101 => 20:34:53.588757
[0m20:34:53.589614 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: ROLLBACK
[0m20:34:53.591659 [debug] [Thread-1 (]: Failed to rollback 'model.ecom.OBT_ECON'
[0m20:34:53.592037 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: Close
[0m20:34:53.595161 [debug] [Thread-1 (]: Runtime Error in model OBT_ECON (models/example/OBT_ECON.sql)
  Catalog Error: Table with name econ0 does not exist!
  Did you mean "temp.information_schema.columns"?
[0m20:34:53.595659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8782e151-e37b-4b05-bc5b-609832377303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff5ca21d0>]}
[0m20:34:53.596328 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model main.OBT_ECON ............................ [[31mERROR[0m in 0.07s]
[0m20:34:53.596971 [debug] [Thread-1 (]: Finished running node model.ecom.OBT_ECON
[0m20:34:53.598258 [debug] [Thread-1 (]: Began running node model.ecom.revenue
[0m20:34:53.598692 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.revenue .............................................. [[33mSKIP[0m]
[0m20:34:53.599163 [debug] [Thread-1 (]: Finished running node model.ecom.revenue
[0m20:34:53.599948 [debug] [Thread-1 (]: Began running node model.ecom.aggregates
[0m20:34:53.601010 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.aggregates ........................................... [[33mSKIP[0m]
[0m20:34:53.601589 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates
[0m20:34:53.602911 [debug] [MainThread]: Using duckdb connection "master"
[0m20:34:53.603269 [debug] [MainThread]: On master: BEGIN
[0m20:34:53.603600 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:34:53.609014 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:34:53.609454 [debug] [MainThread]: On master: COMMIT
[0m20:34:53.609785 [debug] [MainThread]: Using duckdb connection "master"
[0m20:34:53.610108 [debug] [MainThread]: On master: COMMIT
[0m20:34:53.610479 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:34:53.610858 [debug] [MainThread]: On master: Close
[0m20:34:53.613404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:34:53.613759 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m20:34:53.614069 [debug] [MainThread]: Connection 'model.ecom.OBT_ECON' was properly closed.
[0m20:34:53.614447 [info ] [MainThread]: 
[0m20:34:53.614857 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m20:34:53.615609 [debug] [MainThread]: Command end result
[0m20:34:53.700493 [info ] [MainThread]: 
[0m20:34:53.701158 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:34:53.701766 [info ] [MainThread]: 
[0m20:34:53.702213 [error] [MainThread]:   Runtime Error in model OBT_ECON (models/example/OBT_ECON.sql)
  Catalog Error: Table with name econ0 does not exist!
  Did you mean "temp.information_schema.columns"?
[0m20:34:53.702610 [info ] [MainThread]: 
[0m20:34:53.703018 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m20:34:53.703888 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.77425313, "process_user_time": 2.058007, "process_kernel_time": 0.091875, "process_mem_max_rss": "155232", "process_in_blocks": "1616", "process_out_blocks": "2448", "command_success": false}
[0m20:34:53.704423 [debug] [MainThread]: Command `dbt run` failed at 20:34:53.704287 after 0.77 seconds
[0m20:34:53.704813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc004ede140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff5c57b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff5c56e90>]}
[0m20:34:53.705192 [debug] [MainThread]: Flushing usage events
[0m20:37:01.515476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b0dbbe140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b0bb13460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b0bb13400>]}


============================== 20:37:01.517851 | 2cb05d2a-777f-4f97-b5c8-ecbe33607f24 ==============================
[0m20:37:01.517851 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:37:01.518504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/peek/code/ecom/logs', 'profiles_dir': '/home/peek/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:37:01.692245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cb05d2a-777f-4f97-b5c8-ecbe33607f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b0bb13490>]}
[0m20:37:01.768454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cb05d2a-777f-4f97-b5c8-ecbe33607f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b00dde230>]}
[0m20:37:01.769334 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m20:37:01.776193 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m20:37:01.784726 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:37:01.785279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2cb05d2a-777f-4f97-b5c8-ecbe33607f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b00c2bcd0>]}
[0m20:37:02.659271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cb05d2a-777f-4f97-b5c8-ecbe33607f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b00ae0c40>]}
[0m20:37:02.668660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cb05d2a-777f-4f97-b5c8-ecbe33607f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b00167520>]}
[0m20:37:02.669311 [info ] [MainThread]: Found 3 models, 11 seeds, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m20:37:02.669778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cb05d2a-777f-4f97-b5c8-ecbe33607f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b00166590>]}
[0m20:37:02.671252 [info ] [MainThread]: 
[0m20:37:02.672110 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:37:02.674490 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m20:37:02.684804 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m20:37:02.685291 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m20:37:02.685656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:02.698059 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:37:02.699617 [debug] [ThreadPool]: On list_ecom: Close
[0m20:37:02.703113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m20:37:02.703799 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m20:37:02.708154 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:37:02.708596 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m20:37:02.708932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:37:02.714611 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:37:02.715111 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:37:02.715482 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m20:37:02.715946 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:37:02.716909 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m20:37:02.717301 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:37:02.717698 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m20:37:02.718197 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:37:02.718562 [debug] [ThreadPool]: On create_ecom_main: Close
[0m20:37:02.722509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m20:37:02.727725 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m20:37:02.728220 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m20:37:02.728569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:37:02.735918 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:37:02.736457 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m20:37:02.736808 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m20:37:02.748101 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:37:02.752123 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m20:37:02.752768 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m20:37:02.753110 [debug] [ThreadPool]: On list_ecom_main: Close
[0m20:37:02.759161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cb05d2a-777f-4f97-b5c8-ecbe33607f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8afa82e7a0>]}
[0m20:37:02.759827 [debug] [MainThread]: Using duckdb connection "master"
[0m20:37:02.760163 [debug] [MainThread]: On master: BEGIN
[0m20:37:02.760486 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:37:02.767037 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:37:02.767565 [debug] [MainThread]: On master: COMMIT
[0m20:37:02.767902 [debug] [MainThread]: Using duckdb connection "master"
[0m20:37:02.768290 [debug] [MainThread]: On master: COMMIT
[0m20:37:02.768709 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:37:02.769062 [debug] [MainThread]: On master: Close
[0m20:37:02.771413 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:37:02.771839 [info ] [MainThread]: 
[0m20:37:02.774127 [debug] [Thread-1 (]: Began running node model.ecom.OBT_ECON
[0m20:37:02.774680 [info ] [Thread-1 (]: 1 of 3 START sql table model main.OBT_ECON ..................................... [RUN]
[0m20:37:02.775609 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.OBT_ECON'
[0m20:37:02.776009 [debug] [Thread-1 (]: Began compiling node model.ecom.OBT_ECON
[0m20:37:02.782308 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.OBT_ECON"
[0m20:37:02.782981 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECON (compile): 20:37:02.776256 => 20:37:02.782763
[0m20:37:02.783482 [debug] [Thread-1 (]: Began executing node model.ecom.OBT_ECON
[0m20:37:02.811824 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.OBT_ECON"
[0m20:37:02.812582 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:37:02.813014 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: BEGIN
[0m20:37:02.813374 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:37:02.821693 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:37:02.822230 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:37:02.822635 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */

  
    
    

    create  table
      "ecom"."main"."OBT_ECON__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



select *
from econ0
union all
select *
from econ1
union all
select *
from econ2
union all
select *
from econ3
union all
select *
from econ4
union all
select *
from econ5
union all
select *
from econ6
union all
select *
from econ7
union all
select *
from econ8
union all
select *
from econ9
union all
select *
from econ10

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m20:37:06.706367 [debug] [Thread-1 (]: SQL status: OK in 4.0 seconds
[0m20:37:06.712795 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:37:06.713264 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */
alter table "ecom"."main"."OBT_ECON__dbt_tmp" rename to "OBT_ECON"
[0m20:37:06.714797 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:37:06.729783 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: COMMIT
[0m20:37:06.730286 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:37:06.730700 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: COMMIT
[0m20:37:10.597501 [debug] [Thread-1 (]: SQL status: OK in 4.0 seconds
[0m20:37:10.602417 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:37:10.602858 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */
drop table if exists "ecom"."main"."OBT_ECON__dbt_backup" cascade
[0m20:37:10.603748 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:37:10.605301 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECON (execute): 20:37:02.783776 => 20:37:10.605098
[0m20:37:10.605706 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: Close
[0m20:37:10.675400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cb05d2a-777f-4f97-b5c8-ecbe33607f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8afa81f430>]}
[0m20:37:10.676231 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.OBT_ECON ................................ [[32mOK[0m in 7.90s]
[0m20:37:10.676910 [debug] [Thread-1 (]: Finished running node model.ecom.OBT_ECON
[0m20:37:10.678296 [debug] [Thread-1 (]: Began running node model.ecom.revenue
[0m20:37:10.678807 [info ] [Thread-1 (]: 2 of 3 START sql view model main.revenue ....................................... [RUN]
[0m20:37:10.679716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.OBT_ECON, now model.ecom.revenue)
[0m20:37:10.680235 [debug] [Thread-1 (]: Began compiling node model.ecom.revenue
[0m20:37:10.683182 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.revenue"
[0m20:37:10.683871 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (compile): 20:37:10.680497 => 20:37:10.683620
[0m20:37:10.684265 [debug] [Thread-1 (]: Began executing node model.ecom.revenue
[0m20:37:10.699989 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.revenue"
[0m20:37:10.700860 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:37:10.701290 [debug] [Thread-1 (]: On model.ecom.revenue: BEGIN
[0m20:37:10.701741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:37:10.708045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:37:10.708663 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:37:10.709114 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */

  
  create view "ecom"."main"."revenue__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *, quantity * price as revenue
from "ecom"."main"."OBT_ECON"
  );

[0m20:37:10.710013 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:37:10.713501 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:37:10.713933 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue__dbt_tmp" rename to "revenue"
[0m20:37:10.714742 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:37:10.716241 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m20:37:10.716782 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:37:10.717438 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m20:37:10.722943 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:37:10.727326 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:37:10.727758 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
drop view if exists "ecom"."main"."revenue__dbt_backup" cascade
[0m20:37:10.728522 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:37:10.729947 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (execute): 20:37:10.684501 => 20:37:10.729749
[0m20:37:10.730336 [debug] [Thread-1 (]: On model.ecom.revenue: Close
[0m20:37:10.759627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cb05d2a-777f-4f97-b5c8-ecbe33607f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8afa72f700>]}
[0m20:37:10.760409 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.revenue .................................. [[32mOK[0m in 0.08s]
[0m20:37:10.761043 [debug] [Thread-1 (]: Finished running node model.ecom.revenue
[0m20:37:10.762585 [debug] [Thread-1 (]: Began running node model.ecom.aggregates
[0m20:37:10.763122 [info ] [Thread-1 (]: 3 of 3 START sql view model main.aggregates .................................... [RUN]
[0m20:37:10.763837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.revenue, now model.ecom.aggregates)
[0m20:37:10.764214 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates
[0m20:37:10.766942 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates"
[0m20:37:10.767539 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (compile): 20:37:10.764445 => 20:37:10.767305
[0m20:37:10.767913 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates
[0m20:37:10.771644 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates"
[0m20:37:10.772317 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:37:10.772735 [debug] [Thread-1 (]: On model.ecom.aggregates: BEGIN
[0m20:37:10.773100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:37:10.780180 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:37:10.780754 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:37:10.781154 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */

  
  create view "ecom"."main"."aggregates__dbt_tmp" as (
    

select product_name, revenue
from "ecom"."main"."revenue"
group by product_name
  );

[0m20:37:10.783483 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (execute): 20:37:10.768205 => 20:37:10.782987
[0m20:37:10.784340 [debug] [Thread-1 (]: On model.ecom.aggregates: ROLLBACK
[0m20:37:10.785836 [debug] [Thread-1 (]: Failed to rollback 'model.ecom.aggregates'
[0m20:37:10.786217 [debug] [Thread-1 (]: On model.ecom.aggregates: Close
[0m20:37:10.788909 [debug] [Thread-1 (]: Runtime Error in model aggregates (models/example/aggregates.sql)
  Binder Error: column "revenue" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(revenue)" if the exact value of "revenue" is not important.
[0m20:37:10.789414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cb05d2a-777f-4f97-b5c8-ecbe33607f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8afa8259c0>]}
[0m20:37:10.790012 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.aggregates ........................... [[31mERROR[0m in 0.03s]
[0m20:37:10.790690 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates
[0m20:37:10.792828 [debug] [MainThread]: Using duckdb connection "master"
[0m20:37:10.793275 [debug] [MainThread]: On master: BEGIN
[0m20:37:10.793719 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:37:10.807242 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:37:10.807850 [debug] [MainThread]: On master: COMMIT
[0m20:37:10.808312 [debug] [MainThread]: Using duckdb connection "master"
[0m20:37:10.808645 [debug] [MainThread]: On master: COMMIT
[0m20:37:10.809047 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:37:10.809414 [debug] [MainThread]: On master: Close
[0m20:37:10.811383 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:37:10.811728 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m20:37:10.812039 [debug] [MainThread]: Connection 'model.ecom.aggregates' was properly closed.
[0m20:37:10.812462 [info ] [MainThread]: 
[0m20:37:10.812866 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 8.14 seconds (8.14s).
[0m20:37:10.813765 [debug] [MainThread]: Command end result
[0m20:37:10.820980 [info ] [MainThread]: 
[0m20:37:10.821594 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:37:10.821962 [info ] [MainThread]: 
[0m20:37:10.822401 [error] [MainThread]:   Runtime Error in model aggregates (models/example/aggregates.sql)
  Binder Error: column "revenue" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(revenue)" if the exact value of "revenue" is not important.
[0m20:37:10.822782 [info ] [MainThread]: 
[0m20:37:10.823178 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:37:10.823984 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.344728, "process_user_time": 24.46356, "process_kernel_time": 3.574931, "process_mem_max_rss": "2187232", "process_in_blocks": "1160432", "process_out_blocks": "1293312", "command_success": false}
[0m20:37:10.824505 [debug] [MainThread]: Command `dbt run` failed at 20:37:10.824380 after 9.35 seconds
[0m20:37:10.824903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b0dbbe140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8afa842da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b00191180>]}
[0m20:37:10.825289 [debug] [MainThread]: Flushing usage events
[0m20:38:30.021053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4876e9e140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4874e03460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4874e03400>]}


============================== 20:38:30.024797 | e4247902-5cd8-4b1f-a1d2-5350a68ad55a ==============================
[0m20:38:30.024797 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:38:30.025439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/peek/code/ecom/logs', 'fail_fast': 'False', 'profiles_dir': '/home/peek/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:38:30.219673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4247902-5cd8-4b1f-a1d2-5350a68ad55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4874e03490>]}
[0m20:38:30.295947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4247902-5cd8-4b1f-a1d2-5350a68ad55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4871fca230>]}
[0m20:38:30.296801 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m20:38:30.302642 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m20:38:30.323237 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:38:30.324003 [debug] [MainThread]: Partial parsing: updated file: ecom://models/example/aggregates.sql
[0m20:38:30.494971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4247902-5cd8-4b1f-a1d2-5350a68ad55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4868131f30>]}
[0m20:38:30.505627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4247902-5cd8-4b1f-a1d2-5350a68ad55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4869e17100>]}
[0m20:38:30.506318 [info ] [MainThread]: Found 3 models, 11 seeds, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m20:38:30.506754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4247902-5cd8-4b1f-a1d2-5350a68ad55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4869e172b0>]}
[0m20:38:30.508280 [info ] [MainThread]: 
[0m20:38:30.509108 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:38:30.510229 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m20:38:30.520068 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m20:38:30.520554 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m20:38:30.520938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:30.532129 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:38:30.533802 [debug] [ThreadPool]: On list_ecom: Close
[0m20:38:30.537170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m20:38:30.537923 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m20:38:30.541931 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:38:30.542279 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m20:38:30.542595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:30.548288 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:38:30.548851 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:38:30.549227 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m20:38:30.549763 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:38:30.550717 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m20:38:30.551075 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:38:30.551392 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m20:38:30.551811 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:38:30.552152 [debug] [ThreadPool]: On create_ecom_main: Close
[0m20:38:30.556413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m20:38:30.562314 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m20:38:30.562722 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m20:38:30.563068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:30.569921 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:38:30.570421 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m20:38:30.570778 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m20:38:30.583365 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:38:30.587714 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m20:38:30.588487 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m20:38:30.588905 [debug] [ThreadPool]: On list_ecom_main: Close
[0m20:38:30.594113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4247902-5cd8-4b1f-a1d2-5350a68ad55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f486816bd90>]}
[0m20:38:30.594622 [debug] [MainThread]: Using duckdb connection "master"
[0m20:38:30.594947 [debug] [MainThread]: On master: BEGIN
[0m20:38:30.595319 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:38:30.602115 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:38:30.602652 [debug] [MainThread]: On master: COMMIT
[0m20:38:30.603024 [debug] [MainThread]: Using duckdb connection "master"
[0m20:38:30.603386 [debug] [MainThread]: On master: COMMIT
[0m20:38:30.603788 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:38:30.604168 [debug] [MainThread]: On master: Close
[0m20:38:30.606371 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:38:30.606793 [info ] [MainThread]: 
[0m20:38:30.608973 [debug] [Thread-1 (]: Began running node model.ecom.OBT_ECON
[0m20:38:30.609713 [info ] [Thread-1 (]: 1 of 3 START sql table model main.OBT_ECON ..................................... [RUN]
[0m20:38:30.610623 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.OBT_ECON'
[0m20:38:30.611017 [debug] [Thread-1 (]: Began compiling node model.ecom.OBT_ECON
[0m20:38:30.617101 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.OBT_ECON"
[0m20:38:30.617807 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECON (compile): 20:38:30.611287 => 20:38:30.617587
[0m20:38:30.618305 [debug] [Thread-1 (]: Began executing node model.ecom.OBT_ECON
[0m20:38:30.644500 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.OBT_ECON"
[0m20:38:30.645259 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:38:30.645634 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: BEGIN
[0m20:38:30.646012 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:38:30.656260 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:30.656926 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:38:30.657347 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */

  
    
    

    create  table
      "ecom"."main"."OBT_ECON__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



select *
from econ0
union all
select *
from econ1
union all
select *
from econ2
union all
select *
from econ3
union all
select *
from econ4
union all
select *
from econ5
union all
select *
from econ6
union all
select *
from econ7
union all
select *
from econ8
union all
select *
from econ9
union all
select *
from econ10

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m20:38:33.914868 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m20:38:33.924638 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:38:33.925205 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */
alter table "ecom"."main"."OBT_ECON" rename to "OBT_ECON__dbt_backup"
[0m20:38:33.926212 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:34.009555 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:38:34.010199 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */
alter table "ecom"."main"."OBT_ECON__dbt_tmp" rename to "OBT_ECON"
[0m20:38:34.011042 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:34.027005 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: COMMIT
[0m20:38:34.027524 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:38:34.027952 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: COMMIT
[0m20:38:38.128640 [debug] [Thread-1 (]: SQL status: OK in 4.0 seconds
[0m20:38:38.133576 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:38:38.134114 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */
drop table if exists "ecom"."main"."OBT_ECON__dbt_backup" cascade
[0m20:38:38.142600 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:38.144315 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECON (execute): 20:38:30.618580 => 20:38:38.144051
[0m20:38:38.144715 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: Close
[0m20:38:38.239627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4247902-5cd8-4b1f-a1d2-5350a68ad55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4863b317e0>]}
[0m20:38:38.240511 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.OBT_ECON ................................ [[32mOK[0m in 7.63s]
[0m20:38:38.241194 [debug] [Thread-1 (]: Finished running node model.ecom.OBT_ECON
[0m20:38:38.242580 [debug] [Thread-1 (]: Began running node model.ecom.revenue
[0m20:38:38.243044 [info ] [Thread-1 (]: 2 of 3 START sql view model main.revenue ....................................... [RUN]
[0m20:38:38.243746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.OBT_ECON, now model.ecom.revenue)
[0m20:38:38.244148 [debug] [Thread-1 (]: Began compiling node model.ecom.revenue
[0m20:38:38.246991 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.revenue"
[0m20:38:38.247841 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (compile): 20:38:38.244399 => 20:38:38.247544
[0m20:38:38.248263 [debug] [Thread-1 (]: Began executing node model.ecom.revenue
[0m20:38:38.263998 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.revenue"
[0m20:38:38.264752 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:38:38.265149 [debug] [Thread-1 (]: On model.ecom.revenue: BEGIN
[0m20:38:38.265526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:38.272457 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:38.272979 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:38:38.273361 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */

  
  create view "ecom"."main"."revenue__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *, quantity * price as revenue
from "ecom"."main"."OBT_ECON"
  );

[0m20:38:38.274011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:38.277319 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:38:38.277728 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue" rename to "revenue__dbt_backup"
[0m20:38:38.278380 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:38.280980 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:38:38.281463 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue__dbt_tmp" rename to "revenue"
[0m20:38:38.282084 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:38.283935 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m20:38:38.284349 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:38:38.284740 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m20:38:38.288853 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:38.293890 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:38:38.294310 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
drop view if exists "ecom"."main"."revenue__dbt_backup" cascade
[0m20:38:38.299033 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:38.300612 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (execute): 20:38:38.248499 => 20:38:38.300416
[0m20:38:38.300997 [debug] [Thread-1 (]: On model.ecom.revenue: Close
[0m20:38:38.330403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4247902-5cd8-4b1f-a1d2-5350a68ad55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4869c80df0>]}
[0m20:38:38.331279 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.revenue .................................. [[32mOK[0m in 0.09s]
[0m20:38:38.331886 [debug] [Thread-1 (]: Finished running node model.ecom.revenue
[0m20:38:38.333034 [debug] [Thread-1 (]: Began running node model.ecom.aggregates
[0m20:38:38.333955 [info ] [Thread-1 (]: 3 of 3 START sql view model main.aggregates .................................... [RUN]
[0m20:38:38.334673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.revenue, now model.ecom.aggregates)
[0m20:38:38.335064 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates
[0m20:38:38.338003 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates"
[0m20:38:38.338768 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (compile): 20:38:38.335312 => 20:38:38.338542
[0m20:38:38.339137 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates
[0m20:38:38.342753 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates"
[0m20:38:38.343405 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:38:38.343819 [debug] [Thread-1 (]: On model.ecom.aggregates: BEGIN
[0m20:38:38.344267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:38.350454 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:38.350994 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:38:38.351380 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */

  
  create view "ecom"."main"."aggregates__dbt_tmp" as (
    

select product_name, sum(revenue)
from "ecom"."main"."revenue"
group by product_name
  );

[0m20:38:38.352387 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:38.355863 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:38:38.356282 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
alter view "ecom"."main"."aggregates__dbt_tmp" rename to "aggregates"
[0m20:38:38.356876 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:38.358471 [debug] [Thread-1 (]: On model.ecom.aggregates: COMMIT
[0m20:38:38.358851 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:38:38.359278 [debug] [Thread-1 (]: On model.ecom.aggregates: COMMIT
[0m20:38:38.362653 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:38.366275 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:38:38.366712 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
drop view if exists "ecom"."main"."aggregates__dbt_backup" cascade
[0m20:38:38.367328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:38:38.368888 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (execute): 20:38:38.339368 => 20:38:38.368693
[0m20:38:38.369281 [debug] [Thread-1 (]: On model.ecom.aggregates: Close
[0m20:38:38.399714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4247902-5cd8-4b1f-a1d2-5350a68ad55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4869c80df0>]}
[0m20:38:38.400572 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.aggregates ............................... [[32mOK[0m in 0.07s]
[0m20:38:38.401228 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates
[0m20:38:38.402895 [debug] [MainThread]: Using duckdb connection "master"
[0m20:38:38.403338 [debug] [MainThread]: On master: BEGIN
[0m20:38:38.403741 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:38:38.420723 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:38:38.421277 [debug] [MainThread]: On master: COMMIT
[0m20:38:38.421642 [debug] [MainThread]: Using duckdb connection "master"
[0m20:38:38.421981 [debug] [MainThread]: On master: COMMIT
[0m20:38:38.422378 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:38:38.422729 [debug] [MainThread]: On master: Close
[0m20:38:38.425111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:38:38.425479 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m20:38:38.425810 [debug] [MainThread]: Connection 'model.ecom.aggregates' was properly closed.
[0m20:38:38.426268 [info ] [MainThread]: 
[0m20:38:38.426676 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 7.92 seconds (7.92s).
[0m20:38:38.427606 [debug] [MainThread]: Command end result
[0m20:38:38.436049 [info ] [MainThread]: 
[0m20:38:38.436626 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:38:38.437051 [info ] [MainThread]: 
[0m20:38:38.437474 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:38:38.438398 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.457303, "process_user_time": 22.352772, "process_kernel_time": 2.454049, "process_mem_max_rss": "2205100", "process_out_blocks": "1268280", "process_in_blocks": "0"}
[0m20:38:38.438965 [debug] [MainThread]: Command `dbt run` succeeded at 20:38:38.438834 after 8.46 seconds
[0m20:38:38.439362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4876e9e140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4871f9eb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4874e03490>]}
[0m20:38:38.439757 [debug] [MainThread]: Flushing usage events
[0m20:40:36.278751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f91d21a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f7127460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f7127400>]}


============================== 20:40:36.281088 | 77763128-3b71-4a43-9853-c644172c5acf ==============================
[0m20:40:36.281088 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:40:36.281642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peek/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/peek/code/ecom/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:40:36.452428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77763128-3b71-4a43-9853-c644172c5acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f7127490>]}
[0m20:40:36.522979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77763128-3b71-4a43-9853-c644172c5acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ec4de230>]}
[0m20:40:36.523872 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m20:40:36.529970 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m20:40:36.547974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:40:36.548702 [debug] [MainThread]: Partial parsing: updated file: ecom://models/example/aggregates.sql
[0m20:40:36.708007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77763128-3b71-4a43-9853-c644172c5acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e9f1df30>]}
[0m20:40:36.717694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77763128-3b71-4a43-9853-c644172c5acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ec207100>]}
[0m20:40:36.718319 [info ] [MainThread]: Found 3 models, 11 seeds, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m20:40:36.718810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77763128-3b71-4a43-9853-c644172c5acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ec2072b0>]}
[0m20:40:36.720194 [info ] [MainThread]: 
[0m20:40:36.720947 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:40:36.722424 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m20:40:36.732760 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m20:40:36.733175 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m20:40:36.733556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:36.742039 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:40:36.743791 [debug] [ThreadPool]: On list_ecom: Close
[0m20:40:36.747225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m20:40:36.747933 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m20:40:36.752063 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:40:36.752435 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m20:40:36.752765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:36.758646 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:40:36.759226 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:40:36.759590 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m20:40:36.760039 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:40:36.760895 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m20:40:36.761229 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:40:36.761594 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m20:40:36.762029 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:40:36.762391 [debug] [ThreadPool]: On create_ecom_main: Close
[0m20:40:36.767054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m20:40:36.772470 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m20:40:36.772870 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m20:40:36.773193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:36.779519 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:40:36.780002 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m20:40:36.780347 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m20:40:36.791141 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:40:36.795219 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m20:40:36.795804 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m20:40:36.796160 [debug] [ThreadPool]: On list_ecom_main: Close
[0m20:40:36.801991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77763128-3b71-4a43-9853-c644172c5acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e9f5bd90>]}
[0m20:40:36.802554 [debug] [MainThread]: Using duckdb connection "master"
[0m20:40:36.802896 [debug] [MainThread]: On master: BEGIN
[0m20:40:36.803227 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:36.809980 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:40:36.810514 [debug] [MainThread]: On master: COMMIT
[0m20:40:36.810889 [debug] [MainThread]: Using duckdb connection "master"
[0m20:40:36.811222 [debug] [MainThread]: On master: COMMIT
[0m20:40:36.811622 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:40:36.811994 [debug] [MainThread]: On master: Close
[0m20:40:36.814370 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:40:36.814825 [info ] [MainThread]: 
[0m20:40:36.817326 [debug] [Thread-1 (]: Began running node model.ecom.OBT_ECON
[0m20:40:36.818371 [info ] [Thread-1 (]: 1 of 3 START sql table model main.OBT_ECON ..................................... [RUN]
[0m20:40:36.819320 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.OBT_ECON'
[0m20:40:36.819726 [debug] [Thread-1 (]: Began compiling node model.ecom.OBT_ECON
[0m20:40:36.825571 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.OBT_ECON"
[0m20:40:36.826304 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECON (compile): 20:40:36.819974 => 20:40:36.826054
[0m20:40:36.826820 [debug] [Thread-1 (]: Began executing node model.ecom.OBT_ECON
[0m20:40:36.852923 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.OBT_ECON"
[0m20:40:36.853804 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:40:36.854256 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: BEGIN
[0m20:40:36.854703 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:40:36.862275 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:40:36.862820 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:40:36.863238 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */

  
    
    

    create  table
      "ecom"."main"."OBT_ECON__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



select *
from econ0
union all
select *
from econ1
union all
select *
from econ2
union all
select *
from econ3
union all
select *
from econ4
union all
select *
from econ5
union all
select *
from econ6
union all
select *
from econ7
union all
select *
from econ8
union all
select *
from econ9
union all
select *
from econ10

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m20:40:40.187340 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m20:40:40.196110 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:40:40.196671 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */
alter table "ecom"."main"."OBT_ECON" rename to "OBT_ECON__dbt_backup"
[0m20:40:40.197787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:40:40.272878 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:40:40.273543 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */
alter table "ecom"."main"."OBT_ECON__dbt_tmp" rename to "OBT_ECON"
[0m20:40:40.274519 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:40:40.292721 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: COMMIT
[0m20:40:40.293323 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:40:40.293766 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: COMMIT
[0m20:40:44.093438 [debug] [Thread-1 (]: SQL status: OK in 4.0 seconds
[0m20:40:44.098380 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:40:44.098818 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */
drop table if exists "ecom"."main"."OBT_ECON__dbt_backup" cascade
[0m20:40:44.107074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:40:44.108625 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECON (execute): 20:40:36.827089 => 20:40:44.108415
[0m20:40:44.109010 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: Close
[0m20:40:44.208923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77763128-3b71-4a43-9853-c644172c5acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e9e0c0d0>]}
[0m20:40:44.209760 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.OBT_ECON ................................ [[32mOK[0m in 7.39s]
[0m20:40:44.210378 [debug] [Thread-1 (]: Finished running node model.ecom.OBT_ECON
[0m20:40:44.212022 [debug] [Thread-1 (]: Began running node model.ecom.revenue
[0m20:40:44.212742 [info ] [Thread-1 (]: 2 of 3 START sql view model main.revenue ....................................... [RUN]
[0m20:40:44.213453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.OBT_ECON, now model.ecom.revenue)
[0m20:40:44.213851 [debug] [Thread-1 (]: Began compiling node model.ecom.revenue
[0m20:40:44.216490 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.revenue"
[0m20:40:44.217223 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (compile): 20:40:44.214104 => 20:40:44.216961
[0m20:40:44.217667 [debug] [Thread-1 (]: Began executing node model.ecom.revenue
[0m20:40:44.232119 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.revenue"
[0m20:40:44.232894 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:40:44.233361 [debug] [Thread-1 (]: On model.ecom.revenue: BEGIN
[0m20:40:44.233734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:44.240263 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:40:44.240798 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:40:44.241231 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */

  
  create view "ecom"."main"."revenue__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *, quantity * price as revenue
from "ecom"."main"."OBT_ECON"
  );

[0m20:40:44.241957 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:40:44.245248 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:40:44.245659 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue" rename to "revenue__dbt_backup"
[0m20:40:44.246170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:40:44.248774 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:40:44.249183 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue__dbt_tmp" rename to "revenue"
[0m20:40:44.249748 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:40:44.251457 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m20:40:44.251828 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:40:44.252177 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m20:40:44.256739 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:40:44.260643 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:40:44.261035 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
drop view if exists "ecom"."main"."revenue__dbt_backup" cascade
[0m20:40:44.264750 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:40:44.266119 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (execute): 20:40:44.218036 => 20:40:44.265921
[0m20:40:44.266505 [debug] [Thread-1 (]: On model.ecom.revenue: Close
[0m20:40:44.296997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77763128-3b71-4a43-9853-c644172c5acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ea060fa0>]}
[0m20:40:44.297741 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.revenue .................................. [[32mOK[0m in 0.08s]
[0m20:40:44.298346 [debug] [Thread-1 (]: Finished running node model.ecom.revenue
[0m20:40:44.299698 [debug] [Thread-1 (]: Began running node model.ecom.aggregates
[0m20:40:44.300219 [info ] [Thread-1 (]: 3 of 3 START sql view model main.aggregates .................................... [RUN]
[0m20:40:44.301204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.revenue, now model.ecom.aggregates)
[0m20:40:44.301807 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates
[0m20:40:44.304504 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates"
[0m20:40:44.305172 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (compile): 20:40:44.302062 => 20:40:44.304954
[0m20:40:44.305622 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates
[0m20:40:44.309366 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates"
[0m20:40:44.309951 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:40:44.310325 [debug] [Thread-1 (]: On model.ecom.aggregates: BEGIN
[0m20:40:44.310685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:44.316462 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:40:44.316959 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:40:44.317333 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */

  
  create view "ecom"."main"."aggregates__dbt_tmp" as (
    

select product_name, sum(revenue) as total_revenue
from "ecom"."main"."revenue"
group by product_name
  );

[0m20:40:44.318048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:40:44.321225 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:40:44.321605 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
alter view "ecom"."main"."aggregates" rename to "aggregates__dbt_backup"
[0m20:40:44.322107 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:40:44.325024 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:40:44.325501 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
alter view "ecom"."main"."aggregates__dbt_tmp" rename to "aggregates"
[0m20:40:44.326124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:40:44.327796 [debug] [Thread-1 (]: On model.ecom.aggregates: COMMIT
[0m20:40:44.328221 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:40:44.328584 [debug] [Thread-1 (]: On model.ecom.aggregates: COMMIT
[0m20:40:44.332580 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:40:44.335376 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:40:44.335794 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
drop view if exists "ecom"."main"."aggregates__dbt_backup" cascade
[0m20:40:44.339582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:40:44.341141 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (execute): 20:40:44.305907 => 20:40:44.340937
[0m20:40:44.341559 [debug] [Thread-1 (]: On model.ecom.aggregates: Close
[0m20:40:44.371341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77763128-3b71-4a43-9853-c644172c5acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e9f44490>]}
[0m20:40:44.372132 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.aggregates ............................... [[32mOK[0m in 0.07s]
[0m20:40:44.372750 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates
[0m20:40:44.375258 [debug] [MainThread]: Using duckdb connection "master"
[0m20:40:44.375792 [debug] [MainThread]: On master: BEGIN
[0m20:40:44.376240 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:40:44.389479 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:40:44.390094 [debug] [MainThread]: On master: COMMIT
[0m20:40:44.390499 [debug] [MainThread]: Using duckdb connection "master"
[0m20:40:44.390885 [debug] [MainThread]: On master: COMMIT
[0m20:40:44.391427 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:40:44.391816 [debug] [MainThread]: On master: Close
[0m20:40:44.393974 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:44.394310 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m20:40:44.394667 [debug] [MainThread]: Connection 'model.ecom.aggregates' was properly closed.
[0m20:40:44.395084 [info ] [MainThread]: 
[0m20:40:44.395524 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 7.67 seconds (7.67s).
[0m20:40:44.396494 [debug] [MainThread]: Command end result
[0m20:40:44.404998 [info ] [MainThread]: 
[0m20:40:44.405554 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:40:44.406017 [info ] [MainThread]: 
[0m20:40:44.406485 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:40:44.407536 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.163734, "process_user_time": 23.408352, "process_kernel_time": 1.788269, "process_mem_max_rss": "2190816", "process_out_blocks": "1274952", "process_in_blocks": "0"}
[0m20:40:44.408116 [debug] [MainThread]: Command `dbt run` succeeded at 20:40:44.407972 after 8.16 seconds
[0m20:40:44.408513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f91d21a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ea060fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e9f62ec0>]}
[0m20:40:44.408906 [debug] [MainThread]: Flushing usage events
[0m20:44:12.946717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fc685e1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fc47b3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fc47b33d0>]}


============================== 20:44:12.949593 | 776a5b1e-4705-43a1-85a2-eac4b452401b ==============================
[0m20:44:12.949593 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:44:12.950170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peek/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peek/code/ecom/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:44:13.116788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '776a5b1e-4705-43a1-85a2-eac4b452401b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fc47b3460>]}
[0m20:44:13.187391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '776a5b1e-4705-43a1-85a2-eac4b452401b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fb9adf6a0>]}
[0m20:44:13.188246 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m20:44:13.193754 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m20:44:13.211109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:44:13.211708 [debug] [MainThread]: Partial parsing: added file: ecom://models/example/aggregates_ordered.sql
[0m20:44:13.325958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '776a5b1e-4705-43a1-85a2-eac4b452401b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fb965c0d0>]}
[0m20:44:13.335483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '776a5b1e-4705-43a1-85a2-eac4b452401b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fb9744220>]}
[0m20:44:13.336044 [info ] [MainThread]: Found 4 models, 11 seeds, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m20:44:13.336492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '776a5b1e-4705-43a1-85a2-eac4b452401b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fb98b3e50>]}
[0m20:44:13.337959 [info ] [MainThread]: 
[0m20:44:13.338700 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:44:13.340149 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m20:44:13.349943 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m20:44:13.350487 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m20:44:13.350844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:13.360436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:44:13.361027 [debug] [MainThread]: Connection 'list_ecom' was properly closed.
[0m20:44:13.361491 [info ] [MainThread]: 
[0m20:44:13.361894 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m20:44:13.362422 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/home/peek/ecom.db": Resource temporarily unavailable
[0m20:44:13.363249 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.45310986, "process_user_time": 1.799189, "process_kernel_time": 0.092266, "process_mem_max_rss": "134788", "process_in_blocks": "1008", "process_out_blocks": "1624", "command_success": false}
[0m20:44:13.363955 [debug] [MainThread]: Command `dbt run` failed at 20:44:13.363811 after 0.45 seconds
[0m20:44:13.364376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fc685e1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fb98b3f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fb967d270>]}
[0m20:44:13.364802 [debug] [MainThread]: Flushing usage events
[0m20:44:21.943423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e909a140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e71bf430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e71bf3d0>]}


============================== 20:44:21.945517 | f96f8b19-e5a6-4a3d-86fd-872fbdae47d1 ==============================
[0m20:44:21.945517 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:44:21.946041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/peek/code/ecom/logs', 'debug': 'False', 'profiles_dir': '/home/peek/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:44:22.109670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f96f8b19-e5a6-4a3d-86fd-872fbdae47d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e71bf460>]}
[0m20:44:22.179568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f96f8b19-e5a6-4a3d-86fd-872fbdae47d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02dc4d4e20>]}
[0m20:44:22.180390 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m20:44:22.186450 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m20:44:22.204673 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:44:22.205257 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:44:22.211093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f96f8b19-e5a6-4a3d-86fd-872fbdae47d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02dc0f8550>]}
[0m20:44:22.219666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f96f8b19-e5a6-4a3d-86fd-872fbdae47d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02dc2b75b0>]}
[0m20:44:22.220224 [info ] [MainThread]: Found 4 models, 11 seeds, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m20:44:22.220771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f96f8b19-e5a6-4a3d-86fd-872fbdae47d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02dc2b7790>]}
[0m20:44:22.222355 [info ] [MainThread]: 
[0m20:44:22.223132 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:44:22.224729 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m20:44:22.234699 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m20:44:22.235106 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m20:44:22.235447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:22.244252 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:44:22.245886 [debug] [ThreadPool]: On list_ecom: Close
[0m20:44:22.249705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m20:44:22.251038 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m20:44:22.255840 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:44:22.256420 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m20:44:22.256776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:44:22.262470 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:44:22.262994 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:44:22.263393 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m20:44:22.263850 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:44:22.264860 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m20:44:22.265198 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:44:22.265522 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m20:44:22.265936 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:44:22.266294 [debug] [ThreadPool]: On create_ecom_main: Close
[0m20:44:22.270944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m20:44:22.276627 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m20:44:22.276975 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m20:44:22.277290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:44:22.283166 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:44:22.283620 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m20:44:22.283962 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m20:44:22.295255 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:44:22.298693 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m20:44:22.299232 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m20:44:22.299564 [debug] [ThreadPool]: On list_ecom_main: Close
[0m20:44:22.304994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f96f8b19-e5a6-4a3d-86fd-872fbdae47d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02dc141c00>]}
[0m20:44:22.305592 [debug] [MainThread]: Using duckdb connection "master"
[0m20:44:22.305957 [debug] [MainThread]: On master: BEGIN
[0m20:44:22.306307 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:44:22.312056 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:44:22.312515 [debug] [MainThread]: On master: COMMIT
[0m20:44:22.312842 [debug] [MainThread]: Using duckdb connection "master"
[0m20:44:22.313156 [debug] [MainThread]: On master: COMMIT
[0m20:44:22.313576 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:44:22.313918 [debug] [MainThread]: On master: Close
[0m20:44:22.315916 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:44:22.316363 [info ] [MainThread]: 
[0m20:44:22.319650 [debug] [Thread-1 (]: Began running node model.ecom.OBT_ECON
[0m20:44:22.320381 [info ] [Thread-1 (]: 1 of 4 START sql table model main.OBT_ECON ..................................... [RUN]
[0m20:44:22.321570 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.OBT_ECON'
[0m20:44:22.321935 [debug] [Thread-1 (]: Began compiling node model.ecom.OBT_ECON
[0m20:44:22.327957 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.OBT_ECON"
[0m20:44:22.328797 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECON (compile): 20:44:22.322202 => 20:44:22.328564
[0m20:44:22.329217 [debug] [Thread-1 (]: Began executing node model.ecom.OBT_ECON
[0m20:44:22.354526 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.OBT_ECON"
[0m20:44:22.355299 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:44:22.355685 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: BEGIN
[0m20:44:22.356291 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:44:22.363431 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:44:22.364020 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:44:22.364412 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */

  
    
    

    create  table
      "ecom"."main"."OBT_ECON__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



select *
from econ0
union all
select *
from econ1
union all
select *
from econ2
union all
select *
from econ3
union all
select *
from econ4
union all
select *
from econ5
union all
select *
from econ6
union all
select *
from econ7
union all
select *
from econ8
union all
select *
from econ9
union all
select *
from econ10

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m20:44:25.508786 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m20:44:25.515253 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:44:25.515695 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */
alter table "ecom"."main"."OBT_ECON" rename to "OBT_ECON__dbt_backup"
[0m20:44:25.516544 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:44:25.519127 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:44:25.519505 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */
alter table "ecom"."main"."OBT_ECON__dbt_tmp" rename to "OBT_ECON"
[0m20:44:25.520024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:44:25.535002 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: COMMIT
[0m20:44:25.535464 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:44:25.535880 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: COMMIT
[0m20:44:29.595673 [debug] [Thread-1 (]: SQL status: OK in 4.0 seconds
[0m20:44:29.600772 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:44:29.601204 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */
drop table if exists "ecom"."main"."OBT_ECON__dbt_backup" cascade
[0m20:44:29.610223 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:44:29.611980 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECON (execute): 20:44:22.329466 => 20:44:29.611724
[0m20:44:29.612409 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: Close
[0m20:44:29.703946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f96f8b19-e5a6-4a3d-86fd-872fbdae47d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02dc1b1300>]}
[0m20:44:29.705107 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.OBT_ECON ................................ [[32mOK[0m in 7.38s]
[0m20:44:29.705779 [debug] [Thread-1 (]: Finished running node model.ecom.OBT_ECON
[0m20:44:29.706291 [debug] [Thread-1 (]: Began running node model.ecom.aggregates_ordered
[0m20:44:29.707024 [info ] [Thread-1 (]: 2 of 4 START sql view model main.aggregates_ordered ............................ [RUN]
[0m20:44:29.707815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.OBT_ECON, now model.ecom.aggregates_ordered)
[0m20:44:29.708264 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates_ordered
[0m20:44:29.712286 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates_ordered"
[0m20:44:29.712977 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates_ordered (compile): 20:44:29.708532 => 20:44:29.712737
[0m20:44:29.713348 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates_ordered
[0m20:44:29.728640 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates_ordered"
[0m20:44:29.729362 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m20:44:29.729757 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: BEGIN
[0m20:44:29.730124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:29.736961 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:44:29.737526 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m20:44:29.737916 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */

  
  create view "ecom"."main"."aggregates_ordered__dbt_tmp" as (
    


select product_name, round(total_revenue,1) 
from ref aggregates    
order by 2 desc
  );

[0m20:44:29.748819 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates_ordered (execute): 20:44:29.713598 => 20:44:29.748473
[0m20:44:29.749420 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: ROLLBACK
[0m20:44:29.751237 [debug] [Thread-1 (]: Failed to rollback 'model.ecom.aggregates_ordered'
[0m20:44:29.751619 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: Close
[0m20:44:29.755124 [debug] [Thread-1 (]: Runtime Error in model aggregates_ordered (models/example/aggregates_ordered.sql)
  Catalog Error: Table with name ref does not exist!
  Did you mean "econ9"?
[0m20:44:29.755655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f96f8b19-e5a6-4a3d-86fd-872fbdae47d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02dc2da530>]}
[0m20:44:29.756346 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model main.aggregates_ordered ................... [[31mERROR[0m in 0.05s]
[0m20:44:29.757097 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates_ordered
[0m20:44:29.757610 [debug] [Thread-1 (]: Began running node model.ecom.revenue
[0m20:44:29.758331 [info ] [Thread-1 (]: 3 of 4 START sql view model main.revenue ....................................... [RUN]
[0m20:44:29.759025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.aggregates_ordered, now model.ecom.revenue)
[0m20:44:29.759406 [debug] [Thread-1 (]: Began compiling node model.ecom.revenue
[0m20:44:29.762086 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.revenue"
[0m20:44:29.762698 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (compile): 20:44:29.759644 => 20:44:29.762476
[0m20:44:29.763075 [debug] [Thread-1 (]: Began executing node model.ecom.revenue
[0m20:44:29.766980 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.revenue"
[0m20:44:29.767580 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:44:29.767972 [debug] [Thread-1 (]: On model.ecom.revenue: BEGIN
[0m20:44:29.768386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:29.774713 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:44:29.775282 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:44:29.775696 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */

  
  create view "ecom"."main"."revenue__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *, quantity * price as revenue
from "ecom"."main"."OBT_ECON"
  );

[0m20:44:29.776385 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:44:29.779937 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:44:29.780365 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue" rename to "revenue__dbt_backup"
[0m20:44:29.780945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:44:29.783493 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:44:29.783863 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue__dbt_tmp" rename to "revenue"
[0m20:44:29.784310 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:44:29.785878 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m20:44:29.786346 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:44:29.786883 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m20:44:29.791148 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:44:29.794252 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:44:29.794824 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
drop view if exists "ecom"."main"."revenue__dbt_backup" cascade
[0m20:44:29.799100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:44:29.801139 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (execute): 20:44:29.763322 => 20:44:29.800937
[0m20:44:29.801578 [debug] [Thread-1 (]: On model.ecom.revenue: Close
[0m20:44:29.831488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f96f8b19-e5a6-4a3d-86fd-872fbdae47d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02dc2d9b70>]}
[0m20:44:29.832476 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main.revenue .................................. [[32mOK[0m in 0.07s]
[0m20:44:29.833195 [debug] [Thread-1 (]: Finished running node model.ecom.revenue
[0m20:44:29.834285 [debug] [Thread-1 (]: Began running node model.ecom.aggregates
[0m20:44:29.834751 [info ] [Thread-1 (]: 4 of 4 START sql view model main.aggregates .................................... [RUN]
[0m20:44:29.835464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.revenue, now model.ecom.aggregates)
[0m20:44:29.835838 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates
[0m20:44:29.840097 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates"
[0m20:44:29.840798 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (compile): 20:44:29.836092 => 20:44:29.840537
[0m20:44:29.841259 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates
[0m20:44:29.844779 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates"
[0m20:44:29.845280 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:44:29.845785 [debug] [Thread-1 (]: On model.ecom.aggregates: BEGIN
[0m20:44:29.846276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:29.852766 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:44:29.853302 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:44:29.853844 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */

  
  create view "ecom"."main"."aggregates__dbt_tmp" as (
    

select product_name, sum(revenue) as total_revenue
from "ecom"."main"."revenue"
group by product_name
  );

[0m20:44:29.854561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:44:29.858446 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:44:29.858874 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
alter view "ecom"."main"."aggregates" rename to "aggregates__dbt_backup"
[0m20:44:29.859509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:44:29.862203 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:44:29.862620 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
alter view "ecom"."main"."aggregates__dbt_tmp" rename to "aggregates"
[0m20:44:29.863140 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:44:29.864774 [debug] [Thread-1 (]: On model.ecom.aggregates: COMMIT
[0m20:44:29.865142 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:44:29.865487 [debug] [Thread-1 (]: On model.ecom.aggregates: COMMIT
[0m20:44:29.870176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:44:29.872875 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:44:29.873284 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
drop view if exists "ecom"."main"."aggregates__dbt_backup" cascade
[0m20:44:29.877336 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:44:29.878955 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (execute): 20:44:29.841506 => 20:44:29.878750
[0m20:44:29.879354 [debug] [Thread-1 (]: On model.ecom.aggregates: Close
[0m20:44:29.909430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f96f8b19-e5a6-4a3d-86fd-872fbdae47d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02dc1b1e10>]}
[0m20:44:29.910227 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.aggregates ............................... [[32mOK[0m in 0.07s]
[0m20:44:29.910847 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates
[0m20:44:29.913079 [debug] [MainThread]: Using duckdb connection "master"
[0m20:44:29.913502 [debug] [MainThread]: On master: BEGIN
[0m20:44:29.913914 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:44:29.927883 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:44:29.928547 [debug] [MainThread]: On master: COMMIT
[0m20:44:29.928892 [debug] [MainThread]: Using duckdb connection "master"
[0m20:44:29.929254 [debug] [MainThread]: On master: COMMIT
[0m20:44:29.929752 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:44:29.930187 [debug] [MainThread]: On master: Close
[0m20:44:29.932578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:44:29.932957 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m20:44:29.933281 [debug] [MainThread]: Connection 'model.ecom.aggregates' was properly closed.
[0m20:44:29.933705 [info ] [MainThread]: 
[0m20:44:29.934132 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 7.71 seconds (7.71s).
[0m20:44:29.935182 [debug] [MainThread]: Command end result
[0m20:44:29.942235 [info ] [MainThread]: 
[0m20:44:29.942817 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:44:29.943262 [info ] [MainThread]: 
[0m20:44:29.943703 [error] [MainThread]:   Runtime Error in model aggregates_ordered (models/example/aggregates_ordered.sql)
  Catalog Error: Table with name ref does not exist!
  Did you mean "econ9"?
[0m20:44:29.944125 [info ] [MainThread]: 
[0m20:44:29.944564 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m20:44:29.945510 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.0362835, "process_user_time": 21.886768, "process_kernel_time": 1.870905, "process_mem_max_rss": "2145332", "process_out_blocks": "1275720", "command_success": false, "process_in_blocks": "0"}
[0m20:44:29.946085 [debug] [MainThread]: Command `dbt run` failed at 20:44:29.945953 after 8.04 seconds
[0m20:44:29.946492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e909a140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02dc160070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02dc4d4e20>]}
[0m20:44:29.946890 [debug] [MainThread]: Flushing usage events
[0m20:45:35.566674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5b9721a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a598db460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a598db400>]}


============================== 20:45:35.569395 | cc41f039-2748-42d9-95a7-ad91eb15cc95 ==============================
[0m20:45:35.569395 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:45:35.569934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/peek/.dbt', 'log_path': '/home/peek/code/ecom/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:45:35.736203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc41f039-2748-42d9-95a7-ad91eb15cc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a598db490>]}
[0m20:45:35.806992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc41f039-2748-42d9-95a7-ad91eb15cc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4ebde230>]}
[0m20:45:35.807814 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m20:45:35.826055 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m20:45:35.844741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:45:35.845408 [debug] [MainThread]: Partial parsing: updated file: ecom://models/example/aggregates_ordered.sql
[0m20:45:35.967664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc41f039-2748-42d9-95a7-ad91eb15cc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4c709210>]}
[0m20:45:35.976446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc41f039-2748-42d9-95a7-ad91eb15cc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4e9cb6d0>]}
[0m20:45:35.977030 [info ] [MainThread]: Found 4 models, 11 seeds, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m20:45:35.977430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc41f039-2748-42d9-95a7-ad91eb15cc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4e9cb670>]}
[0m20:45:35.978980 [info ] [MainThread]: 
[0m20:45:35.979789 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:45:35.981420 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m20:45:35.992466 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m20:45:35.993015 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m20:45:35.993373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:36.001754 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:45:36.003305 [debug] [ThreadPool]: On list_ecom: Close
[0m20:45:36.007185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m20:45:36.007986 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m20:45:36.012019 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:45:36.012444 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m20:45:36.012779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:45:36.018564 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:45:36.019219 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:45:36.019592 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m20:45:36.020115 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:45:36.021042 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m20:45:36.021411 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m20:45:36.021763 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m20:45:36.022202 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:45:36.022547 [debug] [ThreadPool]: On create_ecom_main: Close
[0m20:45:36.027433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m20:45:36.032740 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m20:45:36.033167 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m20:45:36.033539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:45:36.039968 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:45:36.040542 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m20:45:36.040913 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m20:45:36.052230 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:45:36.056264 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m20:45:36.056890 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m20:45:36.057224 [debug] [ThreadPool]: On list_ecom_main: Close
[0m20:45:36.063133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc41f039-2748-42d9-95a7-ad91eb15cc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4c776e90>]}
[0m20:45:36.064099 [debug] [MainThread]: Using duckdb connection "master"
[0m20:45:36.064441 [debug] [MainThread]: On master: BEGIN
[0m20:45:36.064842 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:45:36.071417 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:45:36.071980 [debug] [MainThread]: On master: COMMIT
[0m20:45:36.072330 [debug] [MainThread]: Using duckdb connection "master"
[0m20:45:36.072662 [debug] [MainThread]: On master: COMMIT
[0m20:45:36.073120 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:45:36.073480 [debug] [MainThread]: On master: Close
[0m20:45:36.076018 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:45:36.076532 [info ] [MainThread]: 
[0m20:45:36.079111 [debug] [Thread-1 (]: Began running node model.ecom.OBT_ECON
[0m20:45:36.079700 [info ] [Thread-1 (]: 1 of 4 START sql table model main.OBT_ECON ..................................... [RUN]
[0m20:45:36.080496 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.OBT_ECON'
[0m20:45:36.080885 [debug] [Thread-1 (]: Began compiling node model.ecom.OBT_ECON
[0m20:45:36.087195 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.OBT_ECON"
[0m20:45:36.087937 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECON (compile): 20:45:36.081129 => 20:45:36.087715
[0m20:45:36.088415 [debug] [Thread-1 (]: Began executing node model.ecom.OBT_ECON
[0m20:45:36.114313 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.OBT_ECON"
[0m20:45:36.115098 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:45:36.115559 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: BEGIN
[0m20:45:36.115928 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:45:36.125669 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:45:36.126248 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:45:36.126660 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */

  
    
    

    create  table
      "ecom"."main"."OBT_ECON__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



select *
from econ0
union all
select *
from econ1
union all
select *
from econ2
union all
select *
from econ3
union all
select *
from econ4
union all
select *
from econ5
union all
select *
from econ6
union all
select *
from econ7
union all
select *
from econ8
union all
select *
from econ9
union all
select *
from econ10

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m20:45:39.394841 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m20:45:39.404935 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:45:39.405568 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */
alter table "ecom"."main"."OBT_ECON" rename to "OBT_ECON__dbt_backup"
[0m20:45:39.406680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:45:39.410103 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:45:39.410625 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */
alter table "ecom"."main"."OBT_ECON__dbt_tmp" rename to "OBT_ECON"
[0m20:45:39.411425 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:45:39.432809 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: COMMIT
[0m20:45:39.433602 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:45:39.434272 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: COMMIT
[0m20:45:43.373443 [debug] [Thread-1 (]: SQL status: OK in 4.0 seconds
[0m20:45:43.378530 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m20:45:43.378927 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */
drop table if exists "ecom"."main"."OBT_ECON__dbt_backup" cascade
[0m20:45:43.386455 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:45:43.387978 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECON (execute): 20:45:36.088669 => 20:45:43.387777
[0m20:45:43.388387 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: Close
[0m20:45:43.484697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc41f039-2748-42d9-95a7-ad91eb15cc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4c63fee0>]}
[0m20:45:43.485502 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.OBT_ECON ................................ [[32mOK[0m in 7.40s]
[0m20:45:43.486168 [debug] [Thread-1 (]: Finished running node model.ecom.OBT_ECON
[0m20:45:43.486719 [debug] [Thread-1 (]: Began running node model.ecom.aggregates_ordered
[0m20:45:43.487719 [info ] [Thread-1 (]: 2 of 4 START sql view model main.aggregates_ordered ............................ [RUN]
[0m20:45:43.488539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.OBT_ECON, now model.ecom.aggregates_ordered)
[0m20:45:43.488980 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates_ordered
[0m20:45:43.491637 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates_ordered"
[0m20:45:43.492340 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates_ordered (compile): 20:45:43.489236 => 20:45:43.492118
[0m20:45:43.492725 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates_ordered
[0m20:45:43.507105 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates_ordered"
[0m20:45:43.507939 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m20:45:43.508466 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: BEGIN
[0m20:45:43.508886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:43.515372 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:45:43.515844 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m20:45:43.516205 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */

  
  create view "ecom"."main"."aggregates_ordered__dbt_tmp" as (
    


select product_name, round(total_revenue,1) 
from aggregates    
order by 2 desc
  );

[0m20:45:43.516953 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:45:43.520227 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m20:45:43.520714 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
alter view "ecom"."main"."aggregates_ordered__dbt_tmp" rename to "aggregates_ordered"
[0m20:45:43.521351 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:45:43.523062 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: COMMIT
[0m20:45:43.523439 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m20:45:43.523815 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: COMMIT
[0m20:45:43.528627 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:45:43.531149 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m20:45:43.531587 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
drop view if exists "ecom"."main"."aggregates_ordered__dbt_backup" cascade
[0m20:45:43.532173 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:45:43.533476 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates_ordered (execute): 20:45:43.492989 => 20:45:43.533276
[0m20:45:43.533917 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: Close
[0m20:45:43.562894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc41f039-2748-42d9-95a7-ad91eb15cc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4c66fe50>]}
[0m20:45:43.563788 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main.aggregates_ordered ....................... [[32mOK[0m in 0.07s]
[0m20:45:43.564442 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates_ordered
[0m20:45:43.564904 [debug] [Thread-1 (]: Began running node model.ecom.revenue
[0m20:45:43.565529 [info ] [Thread-1 (]: 3 of 4 START sql view model main.revenue ....................................... [RUN]
[0m20:45:43.566204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.aggregates_ordered, now model.ecom.revenue)
[0m20:45:43.566677 [debug] [Thread-1 (]: Began compiling node model.ecom.revenue
[0m20:45:43.571558 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.revenue"
[0m20:45:43.573180 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (compile): 20:45:43.566922 => 20:45:43.572444
[0m20:45:43.573702 [debug] [Thread-1 (]: Began executing node model.ecom.revenue
[0m20:45:43.646915 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.revenue"
[0m20:45:43.647728 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:45:43.648226 [debug] [Thread-1 (]: On model.ecom.revenue: BEGIN
[0m20:45:43.648614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:43.655365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:45:43.655890 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:45:43.656296 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */

  
  create view "ecom"."main"."revenue__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *, quantity * price as revenue
from "ecom"."main"."OBT_ECON"
  );

[0m20:45:43.657043 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:45:43.660598 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:45:43.660987 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue" rename to "revenue__dbt_backup"
[0m20:45:43.661549 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:45:43.663952 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:45:43.664336 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue__dbt_tmp" rename to "revenue"
[0m20:45:43.664896 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:45:43.666493 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m20:45:43.666888 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:45:43.667261 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m20:45:43.672320 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:45:43.675209 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m20:45:43.675581 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
drop view if exists "ecom"."main"."revenue__dbt_backup" cascade
[0m20:45:43.679643 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:45:43.681576 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (execute): 20:45:43.574039 => 20:45:43.681378
[0m20:45:43.681972 [debug] [Thread-1 (]: On model.ecom.revenue: Close
[0m20:45:43.711435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc41f039-2748-42d9-95a7-ad91eb15cc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4c6ab160>]}
[0m20:45:43.712337 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main.revenue .................................. [[32mOK[0m in 0.15s]
[0m20:45:43.712973 [debug] [Thread-1 (]: Finished running node model.ecom.revenue
[0m20:45:43.714143 [debug] [Thread-1 (]: Began running node model.ecom.aggregates
[0m20:45:43.714642 [info ] [Thread-1 (]: 4 of 4 START sql view model main.aggregates .................................... [RUN]
[0m20:45:43.715331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.revenue, now model.ecom.aggregates)
[0m20:45:43.715716 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates
[0m20:45:43.718632 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates"
[0m20:45:43.719334 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (compile): 20:45:43.715964 => 20:45:43.719107
[0m20:45:43.719729 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates
[0m20:45:43.723774 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates"
[0m20:45:43.724452 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:45:43.724850 [debug] [Thread-1 (]: On model.ecom.aggregates: BEGIN
[0m20:45:43.725242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:43.731319 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:45:43.731860 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:45:43.732252 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */

  
  create view "ecom"."main"."aggregates__dbt_tmp" as (
    

select product_name, sum(revenue) as total_revenue
from "ecom"."main"."revenue"
group by product_name
  );

[0m20:45:43.732904 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:45:43.736053 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:45:43.736450 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
alter view "ecom"."main"."aggregates" rename to "aggregates__dbt_backup"
[0m20:45:43.737038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:45:43.740602 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:45:43.740979 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
alter view "ecom"."main"."aggregates__dbt_tmp" rename to "aggregates"
[0m20:45:43.741423 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:45:43.744043 [debug] [Thread-1 (]: On model.ecom.aggregates: COMMIT
[0m20:45:43.744486 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:45:43.744845 [debug] [Thread-1 (]: On model.ecom.aggregates: COMMIT
[0m20:45:43.749690 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:45:43.752395 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m20:45:43.752771 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
drop view if exists "ecom"."main"."aggregates__dbt_backup" cascade
[0m20:45:43.756741 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:45:43.758120 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (execute): 20:45:43.719967 => 20:45:43.757899
[0m20:45:43.758632 [debug] [Thread-1 (]: On model.ecom.aggregates: Close
[0m20:45:43.789350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc41f039-2748-42d9-95a7-ad91eb15cc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4e9c8760>]}
[0m20:45:43.790215 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.aggregates ............................... [[32mOK[0m in 0.07s]
[0m20:45:43.790825 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates
[0m20:45:43.793131 [debug] [MainThread]: Using duckdb connection "master"
[0m20:45:43.793592 [debug] [MainThread]: On master: BEGIN
[0m20:45:43.793995 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:45:43.801938 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:45:43.802392 [debug] [MainThread]: On master: COMMIT
[0m20:45:43.802726 [debug] [MainThread]: Using duckdb connection "master"
[0m20:45:43.803112 [debug] [MainThread]: On master: COMMIT
[0m20:45:43.803507 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:45:43.803863 [debug] [MainThread]: On master: Close
[0m20:45:43.805956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:45:43.806301 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m20:45:43.806628 [debug] [MainThread]: Connection 'model.ecom.aggregates' was properly closed.
[0m20:45:43.807064 [info ] [MainThread]: 
[0m20:45:43.807487 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 7.83 seconds (7.83s).
[0m20:45:43.808835 [debug] [MainThread]: Command end result
[0m20:45:43.816779 [info ] [MainThread]: 
[0m20:45:43.817364 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:45:43.817803 [info ] [MainThread]: 
[0m20:45:43.818299 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m20:45:43.819233 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.286959, "process_user_time": 22.749838, "process_kernel_time": 2.170749, "process_mem_max_rss": "2225312", "process_out_blocks": "1277048", "process_in_blocks": "0"}
[0m20:45:43.819857 [debug] [MainThread]: Command `dbt run` succeeded at 20:45:43.819714 after 8.29 seconds
[0m20:45:43.820265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5b9721a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4c610d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4c610730>]}
[0m20:45:43.820676 [debug] [MainThread]: Flushing usage events
[0m22:57:41.860939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a45f660e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a43ebb3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a43ebb370>]}


============================== 22:57:41.863913 | bcab702d-54ab-4664-8094-7b3cbc0ca9de ==============================
[0m22:57:41.863913 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:57:41.864378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/peek/code/ecom/logs', 'version_check': 'True', 'profiles_dir': '/home/peek/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m22:57:42.025281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcab702d-54ab-4664-8094-7b3cbc0ca9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a43ebb400>]}
[0m22:57:42.088751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcab702d-54ab-4664-8094-7b3cbc0ca9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a391ed720>]}
[0m22:57:42.089451 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m22:57:42.094643 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:57:42.111017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:57:42.111365 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:57:42.115871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcab702d-54ab-4664-8094-7b3cbc0ca9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a38e23f40>]}
[0m22:57:42.124592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcab702d-54ab-4664-8094-7b3cbc0ca9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a38fe0520>]}
[0m22:57:42.125083 [info ] [MainThread]: Found 11 seeds, 4 models, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m22:57:42.125466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcab702d-54ab-4664-8094-7b3cbc0ca9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a38fe3a90>]}
[0m22:57:42.126633 [info ] [MainThread]: 
[0m22:57:42.126984 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:57:42.127508 [debug] [MainThread]: Command end result
[0m22:57:42.133887 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.30665487, "process_user_time": 1.570765, "process_kernel_time": 0.159064, "process_mem_max_rss": "129988", "process_in_blocks": "6008", "process_out_blocks": "1648"}
[0m22:57:42.134551 [debug] [MainThread]: Command `dbt test` succeeded at 22:57:42.134420 after 0.31 seconds
[0m22:57:42.134928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a45f660e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a410de980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a38fe1d80>]}
[0m22:57:42.135306 [debug] [MainThread]: Flushing usage events
[0m22:57:49.931231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfcf02e140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfccf83430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfccf833d0>]}


============================== 22:57:49.933252 | 16184cd6-7580-4fda-9e7e-6743ffa21aa5 ==============================
[0m22:57:49.933252 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:57:49.933707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/peek/.dbt', 'log_path': '/home/peek/code/ecom/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:57:50.079641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16184cd6-7580-4fda-9e7e-6743ffa21aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfccf83460>]}
[0m22:57:50.143298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16184cd6-7580-4fda-9e7e-6743ffa21aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc22e8e20>]}
[0m22:57:50.143997 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m22:57:50.149418 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:57:50.165715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:57:50.166074 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:57:50.170609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16184cd6-7580-4fda-9e7e-6743ffa21aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc1f1ffa0>]}
[0m22:57:50.178182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16184cd6-7580-4fda-9e7e-6743ffa21aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc20db910>]}
[0m22:57:50.178662 [info ] [MainThread]: Found 11 seeds, 4 models, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m22:57:50.179044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16184cd6-7580-4fda-9e7e-6743ffa21aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc20dbaf0>]}
[0m22:57:50.180365 [info ] [MainThread]: 
[0m22:57:50.181094 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:57:50.182232 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m22:57:50.190508 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m22:57:50.190869 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m22:57:50.191182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:50.202407 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:57:50.203977 [debug] [ThreadPool]: On list_ecom: Close
[0m22:57:50.207139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m22:57:50.208082 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m22:57:50.212208 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m22:57:50.212616 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m22:57:50.212914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:57:50.218618 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:57:50.218986 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m22:57:50.219279 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m22:57:50.219793 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:57:50.220793 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m22:57:50.221176 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m22:57:50.221473 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m22:57:50.221829 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:57:50.222136 [debug] [ThreadPool]: On create_ecom_main: Close
[0m22:57:50.225799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m22:57:50.230912 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m22:57:50.231268 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m22:57:50.231569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:57:50.237615 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:57:50.237997 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m22:57:50.238301 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m22:57:50.250482 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:57:50.255249 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m22:57:50.256259 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m22:57:50.256594 [debug] [ThreadPool]: On list_ecom_main: Close
[0m22:57:50.261256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16184cd6-7580-4fda-9e7e-6743ffa21aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc1f5df00>]}
[0m22:57:50.261713 [debug] [MainThread]: Using duckdb connection "master"
[0m22:57:50.262013 [debug] [MainThread]: On master: BEGIN
[0m22:57:50.262303 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:57:50.268430 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:57:50.268845 [debug] [MainThread]: On master: COMMIT
[0m22:57:50.269163 [debug] [MainThread]: Using duckdb connection "master"
[0m22:57:50.269468 [debug] [MainThread]: On master: COMMIT
[0m22:57:50.269826 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:57:50.270137 [debug] [MainThread]: On master: Close
[0m22:57:50.272030 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:57:50.272397 [info ] [MainThread]: 
[0m22:57:50.274410 [debug] [Thread-1 (]: Began running node model.ecom.OBT_ECON
[0m22:57:50.274868 [info ] [Thread-1 (]: 1 of 4 START sql table model main.OBT_ECON ..................................... [RUN]
[0m22:57:50.275599 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.OBT_ECON'
[0m22:57:50.275946 [debug] [Thread-1 (]: Began compiling node model.ecom.OBT_ECON
[0m22:57:50.281422 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.OBT_ECON"
[0m22:57:50.282017 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECON (compile): 22:57:50.276164 => 22:57:50.281811
[0m22:57:50.282359 [debug] [Thread-1 (]: Began executing node model.ecom.OBT_ECON
[0m22:57:50.305745 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.OBT_ECON"
[0m22:57:50.306514 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m22:57:50.306936 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: BEGIN
[0m22:57:50.307326 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:57:50.315335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:57:50.315804 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m22:57:50.316173 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */

  
    
    

    create  table
      "ecom"."main"."OBT_ECON__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



select *
from econ0
union all
select *
from econ1
union all
select *
from econ2
union all
select *
from econ3
union all
select *
from econ4
union all
select *
from econ5
union all
select *
from econ6
union all
select *
from econ7
union all
select *
from econ8
union all
select *
from econ9
union all
select *
from econ10

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m22:57:56.693236 [debug] [Thread-1 (]: SQL status: OK in 6.0 seconds
[0m22:57:56.699251 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m22:57:56.699715 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */
alter table "ecom"."main"."OBT_ECON" rename to "OBT_ECON__dbt_backup"
[0m22:57:56.700580 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:57:56.703168 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m22:57:56.703558 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */
alter table "ecom"."main"."OBT_ECON__dbt_tmp" rename to "OBT_ECON"
[0m22:57:56.704077 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:57:56.717878 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: COMMIT
[0m22:57:56.718326 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m22:57:56.718707 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: COMMIT
[0m22:58:00.078748 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m22:58:00.084115 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m22:58:00.084491 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */
drop table if exists "ecom"."main"."OBT_ECON__dbt_backup" cascade
[0m22:58:00.091582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:58:00.092905 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECON (execute): 22:57:50.282599 => 22:58:00.092697
[0m22:58:00.093258 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: Close
[0m22:58:00.212228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16184cd6-7580-4fda-9e7e-6743ffa21aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc1fa6020>]}
[0m22:58:00.212968 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.OBT_ECON ................................ [[32mOK[0m in 9.94s]
[0m22:58:00.213549 [debug] [Thread-1 (]: Finished running node model.ecom.OBT_ECON
[0m22:58:00.213984 [debug] [Thread-1 (]: Began running node model.ecom.aggregates_ordered
[0m22:58:00.214389 [info ] [Thread-1 (]: 2 of 4 START sql view model main.aggregates_ordered ............................ [RUN]
[0m22:58:00.215014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.OBT_ECON, now model.ecom.aggregates_ordered)
[0m22:58:00.215413 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates_ordered
[0m22:58:00.217772 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates_ordered"
[0m22:58:00.218917 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates_ordered (compile): 22:58:00.215641 => 22:58:00.218673
[0m22:58:00.219328 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates_ordered
[0m22:58:00.231655 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates_ordered"
[0m22:58:00.232153 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m22:58:00.232509 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: BEGIN
[0m22:58:00.232835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:58:00.238614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:58:00.239047 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m22:58:00.239391 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */

  
  create view "ecom"."main"."aggregates_ordered__dbt_tmp" as (
    


select product_name, round(total_revenue,1) 
from aggregates    
order by 2 desc
  );

[0m22:58:00.249153 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates_ordered (execute): 22:58:00.219538 => 22:58:00.248947
[0m22:58:00.249518 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: ROLLBACK
[0m22:58:00.255810 [debug] [Thread-1 (]: Failed to rollback 'model.ecom.aggregates_ordered'
[0m22:58:00.256225 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: Close
[0m22:58:00.259000 [debug] [Thread-1 (]: Runtime Error in model aggregates_ordered (models/example/aggregates_ordered.sql)
  Binder Error: Contents of view were altered: types don't match!
[0m22:58:00.259459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16184cd6-7580-4fda-9e7e-6743ffa21aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc9b377f0>]}
[0m22:58:00.260011 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model main.aggregates_ordered ................... [[31mERROR[0m in 0.04s]
[0m22:58:00.260597 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates_ordered
[0m22:58:00.261032 [debug] [Thread-1 (]: Began running node model.ecom.revenue
[0m22:58:00.261478 [info ] [Thread-1 (]: 3 of 4 START sql view model main.revenue ....................................... [RUN]
[0m22:58:00.262115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.aggregates_ordered, now model.ecom.revenue)
[0m22:58:00.262579 [debug] [Thread-1 (]: Began compiling node model.ecom.revenue
[0m22:58:00.265070 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.revenue"
[0m22:58:00.265648 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (compile): 22:58:00.262815 => 22:58:00.265456
[0m22:58:00.265999 [debug] [Thread-1 (]: Began executing node model.ecom.revenue
[0m22:58:00.269622 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.revenue"
[0m22:58:00.270132 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m22:58:00.270580 [debug] [Thread-1 (]: On model.ecom.revenue: BEGIN
[0m22:58:00.270918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:58:00.277039 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:58:00.277463 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m22:58:00.277843 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */

  
  create view "ecom"."main"."revenue__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *, quantity * price as revenue
from "ecom"."main"."OBT_ECON"
  );

[0m22:58:00.278462 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:58:00.281489 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m22:58:00.282049 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue" rename to "revenue__dbt_backup"
[0m22:58:00.282583 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:58:00.285142 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m22:58:00.285499 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue__dbt_tmp" rename to "revenue"
[0m22:58:00.285958 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:58:00.287595 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m22:58:00.287964 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m22:58:00.288349 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m22:58:00.291527 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:58:00.294962 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m22:58:00.295309 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
drop view if exists "ecom"."main"."revenue__dbt_backup" cascade
[0m22:58:00.298279 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:58:00.299611 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (execute): 22:58:00.266299 => 22:58:00.299432
[0m22:58:00.299962 [debug] [Thread-1 (]: On model.ecom.revenue: Close
[0m22:58:00.340383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16184cd6-7580-4fda-9e7e-6743ffa21aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc22e99f0>]}
[0m22:58:00.341079 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main.revenue .................................. [[32mOK[0m in 0.08s]
[0m22:58:00.341617 [debug] [Thread-1 (]: Finished running node model.ecom.revenue
[0m22:58:00.342399 [debug] [Thread-1 (]: Began running node model.ecom.aggregates
[0m22:58:00.343079 [info ] [Thread-1 (]: 4 of 4 START sql view model main.aggregates .................................... [RUN]
[0m22:58:00.343834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.revenue, now model.ecom.aggregates)
[0m22:58:00.344330 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates
[0m22:58:00.347074 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates"
[0m22:58:00.347769 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (compile): 22:58:00.344567 => 22:58:00.347565
[0m22:58:00.348136 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates
[0m22:58:00.351806 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates"
[0m22:58:00.352431 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m22:58:00.352784 [debug] [Thread-1 (]: On model.ecom.aggregates: BEGIN
[0m22:58:00.353109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:58:00.359006 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:58:00.359419 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m22:58:00.359787 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */

  
  create view "ecom"."main"."aggregates__dbt_tmp" as (
    

select product_name, sum(revenue) as total_revenue
from "ecom"."main"."revenue"
group by product_name
  );

[0m22:58:00.360962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:58:00.363855 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m22:58:00.364209 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
alter view "ecom"."main"."aggregates" rename to "aggregates__dbt_backup"
[0m22:58:00.364663 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:58:00.367033 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m22:58:00.367404 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
alter view "ecom"."main"."aggregates__dbt_tmp" rename to "aggregates"
[0m22:58:00.367846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:58:00.369243 [debug] [Thread-1 (]: On model.ecom.aggregates: COMMIT
[0m22:58:00.369584 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m22:58:00.369905 [debug] [Thread-1 (]: On model.ecom.aggregates: COMMIT
[0m22:58:00.373356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:58:00.375350 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m22:58:00.375756 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
drop view if exists "ecom"."main"."aggregates__dbt_backup" cascade
[0m22:58:00.378397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:58:00.379642 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (execute): 22:58:00.348353 => 22:58:00.379460
[0m22:58:00.380012 [debug] [Thread-1 (]: On model.ecom.aggregates: Close
[0m22:58:00.419382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16184cd6-7580-4fda-9e7e-6743ffa21aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc1ec5180>]}
[0m22:58:00.420073 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.aggregates ............................... [[32mOK[0m in 0.08s]
[0m22:58:00.420611 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates
[0m22:58:00.422131 [debug] [MainThread]: Using duckdb connection "master"
[0m22:58:00.422530 [debug] [MainThread]: On master: BEGIN
[0m22:58:00.422897 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:58:00.440975 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:58:00.441490 [debug] [MainThread]: On master: COMMIT
[0m22:58:00.441804 [debug] [MainThread]: Using duckdb connection "master"
[0m22:58:00.442103 [debug] [MainThread]: On master: COMMIT
[0m22:58:00.442464 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:58:00.442780 [debug] [MainThread]: On master: Close
[0m22:58:00.444924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:58:00.445237 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m22:58:00.445528 [debug] [MainThread]: Connection 'model.ecom.aggregates' was properly closed.
[0m22:58:00.445904 [info ] [MainThread]: 
[0m22:58:00.446265 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 10.27 seconds (10.27s).
[0m22:58:00.447130 [debug] [MainThread]: Command end result
[0m22:58:00.454340 [info ] [MainThread]: 
[0m22:58:00.455090 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:58:00.455457 [info ] [MainThread]: 
[0m22:58:00.455798 [error] [MainThread]:   Runtime Error in model aggregates_ordered (models/example/aggregates_ordered.sql)
  Binder Error: Contents of view were altered: types don't match!
[0m22:58:00.456131 [info ] [MainThread]: 
[0m22:58:00.456477 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m22:58:00.458023 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.5577, "process_user_time": 41.228817, "process_kernel_time": 8.156459, "process_mem_max_rss": "3146032", "process_in_blocks": "3952", "process_out_blocks": "2068824", "command_success": false}
[0m22:58:00.458622 [debug] [MainThread]: Command `dbt run` failed at 22:58:00.458503 after 10.56 seconds
[0m22:58:00.458996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfcf02e140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc1982890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc1983f70>]}
[0m22:58:00.459364 [debug] [MainThread]: Flushing usage events
[0m22:59:31.406495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0a176140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b080db460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b080db400>]}


============================== 22:59:31.408816 | e49da5de-6aed-4527-9199-bb2cbfee720a ==============================
[0m22:59:31.408816 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:59:31.409279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peek/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/peek/code/ecom/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:59:31.558056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e49da5de-6aed-4527-9199-bb2cbfee720a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b080db490>]}
[0m22:59:31.622967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e49da5de-6aed-4527-9199-bb2cbfee720a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afd1f6230>]}
[0m22:59:31.623636 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m22:59:31.629045 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:59:31.649710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:59:31.650131 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:59:31.655158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e49da5de-6aed-4527-9199-bb2cbfee720a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afd033fd0>]}
[0m22:59:31.663913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e49da5de-6aed-4527-9199-bb2cbfee720a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afd1ef940>]}
[0m22:59:31.664468 [info ] [MainThread]: Found 11 seeds, 4 models, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m22:59:31.664836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e49da5de-6aed-4527-9199-bb2cbfee720a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afd1efb20>]}
[0m22:59:31.666265 [info ] [MainThread]: 
[0m22:59:31.666969 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:59:31.668217 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m22:59:31.676904 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m22:59:31.677326 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m22:59:31.677643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:31.688673 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:59:31.689967 [debug] [ThreadPool]: On list_ecom: Close
[0m22:59:31.693062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m22:59:31.693684 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m22:59:31.697191 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m22:59:31.697532 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m22:59:31.697825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:59:31.703523 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:59:31.703943 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m22:59:31.704239 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m22:59:31.704622 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:59:31.705412 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m22:59:31.705717 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m22:59:31.706026 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m22:59:31.706408 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:59:31.706756 [debug] [ThreadPool]: On create_ecom_main: Close
[0m22:59:31.709722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m22:59:31.714450 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m22:59:31.714947 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m22:59:31.715257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:59:31.721741 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:59:31.722136 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m22:59:31.722453 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m22:59:31.733150 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:59:31.736649 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m22:59:31.737574 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m22:59:31.737899 [debug] [ThreadPool]: On list_ecom_main: Close
[0m22:59:31.742606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e49da5de-6aed-4527-9199-bb2cbfee720a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afd071f30>]}
[0m22:59:31.743078 [debug] [MainThread]: Using duckdb connection "master"
[0m22:59:31.743386 [debug] [MainThread]: On master: BEGIN
[0m22:59:31.743691 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:59:31.750656 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:59:31.751063 [debug] [MainThread]: On master: COMMIT
[0m22:59:31.751383 [debug] [MainThread]: Using duckdb connection "master"
[0m22:59:31.751694 [debug] [MainThread]: On master: COMMIT
[0m22:59:31.752050 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:59:31.752362 [debug] [MainThread]: On master: Close
[0m22:59:31.754965 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:59:31.755485 [info ] [MainThread]: 
[0m22:59:31.757605 [debug] [Thread-1 (]: Began running node model.ecom.OBT_ECON
[0m22:59:31.758085 [info ] [Thread-1 (]: 1 of 4 START sql table model main.OBT_ECON ..................................... [RUN]
[0m22:59:31.758741 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.OBT_ECON'
[0m22:59:31.759088 [debug] [Thread-1 (]: Began compiling node model.ecom.OBT_ECON
[0m22:59:31.764413 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.OBT_ECON"
[0m22:59:31.764980 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECON (compile): 22:59:31.759309 => 22:59:31.764785
[0m22:59:31.765329 [debug] [Thread-1 (]: Began executing node model.ecom.OBT_ECON
[0m22:59:31.787524 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.OBT_ECON"
[0m22:59:31.788118 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m22:59:31.788496 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: BEGIN
[0m22:59:31.788851 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:59:31.795935 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:31.796389 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m22:59:31.796760 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */

  
    
    

    create  table
      "ecom"."main"."OBT_ECON__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



select *
from econ0
union all
select *
from econ1
union all
select *
from econ2
union all
select *
from econ3
union all
select *
from econ4
union all
select *
from econ5
union all
select *
from econ6
union all
select *
from econ7
union all
select *
from econ8
union all
select *
from econ9
union all
select *
from econ10

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m22:59:38.077312 [debug] [Thread-1 (]: SQL status: OK in 6.0 seconds
[0m22:59:38.088257 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m22:59:38.088698 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */
alter table "ecom"."main"."OBT_ECON" rename to "OBT_ECON__dbt_backup"
[0m22:59:38.089650 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:38.091831 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m22:59:38.092179 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */
alter table "ecom"."main"."OBT_ECON__dbt_tmp" rename to "OBT_ECON"
[0m22:59:38.092646 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:38.106938 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: COMMIT
[0m22:59:38.107363 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m22:59:38.107718 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: COMMIT
[0m22:59:49.037295 [debug] [Thread-1 (]: SQL status: OK in 11.0 seconds
[0m22:59:49.043320 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECON"
[0m22:59:49.043833 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECON"} */
drop table if exists "ecom"."main"."OBT_ECON__dbt_backup" cascade
[0m22:59:49.054877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:49.056870 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECON (execute): 22:59:31.765542 => 22:59:49.056565
[0m22:59:49.057363 [debug] [Thread-1 (]: On model.ecom.OBT_ECON: Close
[0m22:59:49.226673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e49da5de-6aed-4527-9199-bb2cbfee720a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afd0ba050>]}
[0m22:59:49.228233 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.OBT_ECON ................................ [[32mOK[0m in 17.47s]
[0m22:59:49.229287 [debug] [Thread-1 (]: Finished running node model.ecom.OBT_ECON
[0m22:59:49.229996 [debug] [Thread-1 (]: Began running node model.ecom.aggregates_ordered
[0m22:59:49.231252 [info ] [Thread-1 (]: 2 of 4 START sql view model main.aggregates_ordered ............................ [RUN]
[0m22:59:49.232366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.OBT_ECON, now model.ecom.aggregates_ordered)
[0m22:59:49.232931 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates_ordered
[0m22:59:49.236897 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates_ordered"
[0m22:59:49.238196 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates_ordered (compile): 22:59:49.233357 => 22:59:49.237881
[0m22:59:49.238747 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates_ordered
[0m22:59:49.260423 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates_ordered"
[0m22:59:49.261615 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m22:59:49.262343 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: BEGIN
[0m22:59:49.262937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:49.274336 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:49.275421 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m22:59:49.276222 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */

  
  create view "ecom"."main"."aggregates_ordered__dbt_tmp" as (
    


select product_name, round(total_revenue,1) 
from aggregates    
order by 2 desc
  );

[0m22:59:49.278244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:49.285050 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m22:59:49.286045 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
alter view "ecom"."main"."aggregates_ordered" rename to "aggregates_ordered__dbt_backup"
[0m22:59:49.287825 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:49.292543 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m22:59:49.293162 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
alter view "ecom"."main"."aggregates_ordered__dbt_tmp" rename to "aggregates_ordered"
[0m22:59:49.294067 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:49.296953 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: COMMIT
[0m22:59:49.297919 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m22:59:49.298412 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: COMMIT
[0m22:59:49.302238 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:49.306534 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m22:59:49.307134 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
drop view if exists "ecom"."main"."aggregates_ordered__dbt_backup" cascade
[0m22:59:49.310124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:49.312310 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates_ordered (execute): 22:59:49.239077 => 22:59:49.311981
[0m22:59:49.312919 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: Close
[0m22:59:49.366587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e49da5de-6aed-4527-9199-bb2cbfee720a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afd067ca0>]}
[0m22:59:49.367868 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main.aggregates_ordered ....................... [[32mOK[0m in 0.13s]
[0m22:59:49.368750 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates_ordered
[0m22:59:49.369275 [debug] [Thread-1 (]: Began running node model.ecom.revenue
[0m22:59:49.369995 [info ] [Thread-1 (]: 3 of 4 START sql view model main.revenue ....................................... [RUN]
[0m22:59:49.370926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.aggregates_ordered, now model.ecom.revenue)
[0m22:59:49.371458 [debug] [Thread-1 (]: Began compiling node model.ecom.revenue
[0m22:59:49.375226 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.revenue"
[0m22:59:49.376234 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (compile): 22:59:49.371768 => 22:59:49.376021
[0m22:59:49.376698 [debug] [Thread-1 (]: Began executing node model.ecom.revenue
[0m22:59:49.382962 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.revenue"
[0m22:59:49.383600 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m22:59:49.383949 [debug] [Thread-1 (]: On model.ecom.revenue: BEGIN
[0m22:59:49.384275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:49.390969 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:49.391488 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m22:59:49.391844 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */

  
  create view "ecom"."main"."revenue__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *, quantity * price as revenue
from "ecom"."main"."OBT_ECON"
  );

[0m22:59:49.392408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:49.395562 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m22:59:49.396001 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue" rename to "revenue__dbt_backup"
[0m22:59:49.396539 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:49.399088 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m22:59:49.399456 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue__dbt_tmp" rename to "revenue"
[0m22:59:49.399920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:49.401387 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m22:59:49.401737 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m22:59:49.402068 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m22:59:49.404799 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:49.407680 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m22:59:49.408168 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
drop view if exists "ecom"."main"."revenue__dbt_backup" cascade
[0m22:59:49.410989 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:49.412386 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (execute): 22:59:49.377040 => 22:59:49.412200
[0m22:59:49.412747 [debug] [Thread-1 (]: On model.ecom.revenue: Close
[0m22:59:49.454712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e49da5de-6aed-4527-9199-bb2cbfee720a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afcf78160>]}
[0m22:59:49.455655 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main.revenue .................................. [[32mOK[0m in 0.08s]
[0m22:59:49.456439 [debug] [Thread-1 (]: Finished running node model.ecom.revenue
[0m22:59:49.457733 [debug] [Thread-1 (]: Began running node model.ecom.aggregates
[0m22:59:49.458291 [info ] [Thread-1 (]: 4 of 4 START sql view model main.aggregates .................................... [RUN]
[0m22:59:49.459099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.revenue, now model.ecom.aggregates)
[0m22:59:49.459460 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates
[0m22:59:49.461988 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates"
[0m22:59:49.462676 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (compile): 22:59:49.459679 => 22:59:49.462479
[0m22:59:49.463022 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates
[0m22:59:49.467811 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates"
[0m22:59:49.468554 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m22:59:49.468913 [debug] [Thread-1 (]: On model.ecom.aggregates: BEGIN
[0m22:59:49.469244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:49.475996 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:49.476637 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m22:59:49.477054 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */

  
  create view "ecom"."main"."aggregates__dbt_tmp" as (
    

select product_name, sum(revenue) as total_revenue
from "ecom"."main"."revenue"
group by product_name
  );

[0m22:59:49.477916 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:49.480919 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m22:59:49.481302 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
alter view "ecom"."main"."aggregates" rename to "aggregates__dbt_backup"
[0m22:59:49.481833 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:49.484561 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m22:59:49.485037 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
alter view "ecom"."main"."aggregates__dbt_tmp" rename to "aggregates"
[0m22:59:49.485657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:49.487241 [debug] [Thread-1 (]: On model.ecom.aggregates: COMMIT
[0m22:59:49.487645 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m22:59:49.487970 [debug] [Thread-1 (]: On model.ecom.aggregates: COMMIT
[0m22:59:49.490877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:49.494803 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m22:59:49.495166 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
drop view if exists "ecom"."main"."aggregates__dbt_backup" cascade
[0m22:59:49.497957 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:59:49.499282 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (execute): 22:59:49.463241 => 22:59:49.499081
[0m22:59:49.499653 [debug] [Thread-1 (]: On model.ecom.aggregates: Close
[0m22:59:49.542476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e49da5de-6aed-4527-9199-bb2cbfee720a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afcfacc70>]}
[0m22:59:49.543183 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.aggregates ............................... [[32mOK[0m in 0.08s]
[0m22:59:49.543759 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates
[0m22:59:49.547235 [debug] [MainThread]: Using duckdb connection "master"
[0m22:59:49.547772 [debug] [MainThread]: On master: BEGIN
[0m22:59:49.548106 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:59:49.567019 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:59:49.567601 [debug] [MainThread]: On master: COMMIT
[0m22:59:49.567969 [debug] [MainThread]: Using duckdb connection "master"
[0m22:59:49.568284 [debug] [MainThread]: On master: COMMIT
[0m22:59:49.568663 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:59:49.568984 [debug] [MainThread]: On master: Close
[0m22:59:49.571102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:59:49.571423 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m22:59:49.571706 [debug] [MainThread]: Connection 'model.ecom.aggregates' was properly closed.
[0m22:59:49.572079 [info ] [MainThread]: 
[0m22:59:49.572467 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 17.91 seconds (17.91s).
[0m22:59:49.573331 [debug] [MainThread]: Command end result
[0m22:59:49.653949 [info ] [MainThread]: 
[0m22:59:49.654557 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:59:49.654948 [info ] [MainThread]: 
[0m22:59:49.655338 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m22:59:49.656291 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.280098, "process_user_time": 45.89236, "process_kernel_time": 5.51992, "process_mem_max_rss": "3210088", "process_in_blocks": "939680", "process_out_blocks": "2069888"}
[0m22:59:49.656816 [debug] [MainThread]: Command `dbt run` succeeded at 22:59:49.656694 after 18.28 seconds
[0m22:59:49.657314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0a176140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afcef9c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afcefb790>]}
[0m22:59:49.657767 [debug] [MainThread]: Flushing usage events
[0m08:41:00.753926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0baaea560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b87d5960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b87d7490>]}


============================== 08:41:00.756318 | 097b5638-7686-4d9f-bfa1-1f7870fdca9a ==============================
[0m08:41:00.756318 [info ] [MainThread]: Running with dbt=1.7.2
[0m08:41:00.756815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peek/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/peek/code/ecom/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models aggregates_ordered', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:41:00.924498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '097b5638-7686-4d9f-bfa1-1f7870fdca9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b9329510>]}
[0m08:41:00.994903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '097b5638-7686-4d9f-bfa1-1f7870fdca9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0ad934790>]}
[0m08:41:00.995714 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m08:41:01.001448 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m08:41:01.019556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:41:01.019925 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:41:01.093761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '097b5638-7686-4d9f-bfa1-1f7870fdca9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0ad7349a0>]}
[0m08:41:01.102929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '097b5638-7686-4d9f-bfa1-1f7870fdca9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0ad70c580>]}
[0m08:41:01.103460 [info ] [MainThread]: Found 11 seeds, 4 models, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m08:41:01.103857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '097b5638-7686-4d9f-bfa1-1f7870fdca9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0ad70c700>]}
[0m08:41:01.104938 [info ] [MainThread]: 
[0m08:41:01.105623 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:41:01.106715 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m08:41:01.116410 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m08:41:01.116788 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m08:41:01.117109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:41:01.132242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:41:01.132852 [debug] [MainThread]: Connection 'list_ecom' was properly closed.
[0m08:41:01.133458 [info ] [MainThread]: 
[0m08:41:01.133944 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m08:41:01.134502 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/home/peek/ecom.db": Resource temporarily unavailable
[0m08:41:01.135883 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.41659555, "process_user_time": 1.763013, "process_kernel_time": 0.073458, "process_mem_max_rss": "141004", "process_in_blocks": "4576", "process_out_blocks": "848", "command_success": false}
[0m08:41:01.136440 [debug] [MainThread]: Command `dbt run` failed at 08:41:01.136310 after 0.42 seconds
[0m08:41:01.136828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0baaea560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0ad70c640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0ad77e140>]}
[0m08:41:01.137228 [debug] [MainThread]: Flushing usage events
[0m08:41:09.433080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7f054bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7ee22de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7ee22f430>]}


============================== 08:41:09.435361 | 00b66988-5236-457c-8b34-ee9861b6eb12 ==============================
[0m08:41:09.435361 [info ] [MainThread]: Running with dbt=1.7.2
[0m08:41:09.435885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peek/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/peek/code/ecom/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models aggregates_ordered', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:41:09.621307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00b66988-5236-457c-8b34-ee9861b6eb12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7eed6d540>]}
[0m08:41:09.701017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00b66988-5236-457c-8b34-ee9861b6eb12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e344b460>]}
[0m08:41:09.701896 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m08:41:09.707904 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m08:41:09.730811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:41:09.731303 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:41:09.801714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00b66988-5236-457c-8b34-ee9861b6eb12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e3248a00>]}
[0m08:41:09.810802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00b66988-5236-457c-8b34-ee9861b6eb12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e32206a0>]}
[0m08:41:09.811344 [info ] [MainThread]: Found 11 seeds, 4 models, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m08:41:09.811784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00b66988-5236-457c-8b34-ee9861b6eb12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e3220700>]}
[0m08:41:09.812958 [info ] [MainThread]: 
[0m08:41:09.813706 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:41:09.814924 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m08:41:09.824156 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m08:41:09.824565 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m08:41:09.824900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:41:09.859088 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:41:09.861514 [debug] [ThreadPool]: On list_ecom: Close
[0m08:41:09.865677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m08:41:09.866567 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m08:41:09.871011 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m08:41:09.871435 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m08:41:09.871769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:41:09.878575 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:41:09.879308 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m08:41:09.879654 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m08:41:09.880345 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:41:09.881263 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m08:41:09.881645 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m08:41:09.881975 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m08:41:09.882448 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:41:09.882806 [debug] [ThreadPool]: On create_ecom_main: Close
[0m08:41:09.886875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m08:41:09.891740 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m08:41:09.892103 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m08:41:09.892429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:41:09.901109 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:41:09.901592 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m08:41:09.901933 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m08:41:09.915587 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:41:09.921794 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m08:41:09.922916 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m08:41:09.923414 [debug] [ThreadPool]: On list_ecom_main: Close
[0m08:41:09.929138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00b66988-5236-457c-8b34-ee9861b6eb12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e3220220>]}
[0m08:41:09.929651 [debug] [MainThread]: Using duckdb connection "master"
[0m08:41:09.929981 [debug] [MainThread]: On master: BEGIN
[0m08:41:09.930302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:41:09.938875 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:41:09.939399 [debug] [MainThread]: On master: COMMIT
[0m08:41:09.939732 [debug] [MainThread]: Using duckdb connection "master"
[0m08:41:09.940051 [debug] [MainThread]: On master: COMMIT
[0m08:41:09.940430 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:41:09.940778 [debug] [MainThread]: On master: Close
[0m08:41:09.943075 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:41:09.943526 [info ] [MainThread]: 
[0m08:41:09.945601 [debug] [Thread-1 (]: Began running node model.ecom.aggregates_ordered
[0m08:41:09.946124 [info ] [Thread-1 (]: 1 of 1 START sql view model main.aggregates_ordered ............................ [RUN]
[0m08:41:09.947207 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.aggregates_ordered'
[0m08:41:09.947611 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates_ordered
[0m08:41:09.954304 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates_ordered"
[0m08:41:09.955003 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates_ordered (compile): 08:41:09.947869 => 08:41:09.954787
[0m08:41:09.955386 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates_ordered
[0m08:41:09.979094 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates_ordered"
[0m08:41:09.979719 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m08:41:09.980103 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: BEGIN
[0m08:41:09.980452 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:41:09.991400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:41:09.991993 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m08:41:09.992388 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */

  
  create view "ecom"."main"."aggregates_ordered__dbt_tmp" as (
    


select product_name, round(total_revenue,1) 
from aggregates    
order by 2 desc
  );

[0m08:41:09.993390 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:41:09.999225 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m08:41:09.999729 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
alter view "ecom"."main"."aggregates_ordered" rename to "aggregates_ordered__dbt_backup"
[0m08:41:10.000389 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:41:10.002941 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m08:41:10.003317 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
alter view "ecom"."main"."aggregates_ordered__dbt_tmp" rename to "aggregates_ordered"
[0m08:41:10.003791 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:41:10.016105 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: COMMIT
[0m08:41:10.016655 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m08:41:10.017049 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: COMMIT
[0m08:41:10.020970 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:41:10.025250 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m08:41:10.025655 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
drop view if exists "ecom"."main"."aggregates_ordered__dbt_backup" cascade
[0m08:41:10.028893 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:41:10.030218 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates_ordered (execute): 08:41:09.955615 => 08:41:10.029999
[0m08:41:10.030610 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: Close
[0m08:41:10.085494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00b66988-5236-457c-8b34-ee9861b6eb12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e324bee0>]}
[0m08:41:10.086332 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.aggregates_ordered ....................... [[32mOK[0m in 0.14s]
[0m08:41:10.086955 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates_ordered
[0m08:41:10.088820 [debug] [MainThread]: Using duckdb connection "master"
[0m08:41:10.089174 [debug] [MainThread]: On master: BEGIN
[0m08:41:10.089507 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:41:10.096313 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:41:10.096733 [debug] [MainThread]: On master: COMMIT
[0m08:41:10.097057 [debug] [MainThread]: Using duckdb connection "master"
[0m08:41:10.097379 [debug] [MainThread]: On master: COMMIT
[0m08:41:10.097750 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:41:10.098128 [debug] [MainThread]: On master: Close
[0m08:41:10.100350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:41:10.100752 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m08:41:10.101100 [debug] [MainThread]: Connection 'model.ecom.aggregates_ordered' was properly closed.
[0m08:41:10.101475 [info ] [MainThread]: 
[0m08:41:10.101888 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m08:41:10.102589 [debug] [MainThread]: Command end result
[0m08:41:10.111156 [info ] [MainThread]: 
[0m08:41:10.111681 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:41:10.112148 [info ] [MainThread]: 
[0m08:41:10.112553 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:41:10.113376 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7146865, "process_user_time": 1.964802, "process_kernel_time": 0.177767, "process_mem_max_rss": "161048", "process_in_blocks": "4376", "process_out_blocks": "7864"}
[0m08:41:10.113913 [debug] [MainThread]: Command `dbt run` succeeded at 08:41:10.113784 after 0.72 seconds
[0m08:41:10.114319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7f054bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7ee1247f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e31156f0>]}
[0m08:41:10.114703 [debug] [MainThread]: Flushing usage events
[0m08:42:05.088134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbcb76e8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbc9414430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbc9415900>]}


============================== 08:42:05.090318 | 9e711a75-b5bb-436e-b5c1-821aaaf45582 ==============================
[0m08:42:05.090318 [info ] [MainThread]: Running with dbt=1.7.2
[0m08:42:05.090827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/peek/code/ecom/logs', 'profiles_dir': '/home/peek/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models aggregates_ordered', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:42:05.254722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e711a75-b5bb-436e-b5c1-821aaaf45582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbc9f71480>]}
[0m08:42:05.323866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e711a75-b5bb-436e-b5c1-821aaaf45582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbbe618130>]}
[0m08:42:05.324730 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m08:42:05.330679 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m08:42:05.348613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:42:05.349105 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:42:05.426479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e711a75-b5bb-436e-b5c1-821aaaf45582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbbe41fee0>]}
[0m08:42:05.434573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e711a75-b5bb-436e-b5c1-821aaaf45582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbbe5ec4f0>]}
[0m08:42:05.435094 [info ] [MainThread]: Found 11 seeds, 4 models, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m08:42:05.435510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e711a75-b5bb-436e-b5c1-821aaaf45582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbbe5ec670>]}
[0m08:42:05.436675 [info ] [MainThread]: 
[0m08:42:05.437406 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:42:05.438527 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m08:42:05.447572 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m08:42:05.447934 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m08:42:05.448358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:05.459737 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:42:05.461312 [debug] [ThreadPool]: On list_ecom: Close
[0m08:42:05.464918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m08:42:05.465500 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m08:42:05.469377 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m08:42:05.469746 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m08:42:05.470057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:42:05.476300 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:42:05.476770 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m08:42:05.477093 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m08:42:05.477553 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:42:05.478451 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m08:42:05.478787 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m08:42:05.479098 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m08:42:05.479487 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:42:05.479829 [debug] [ThreadPool]: On create_ecom_main: Close
[0m08:42:05.483743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m08:42:05.488523 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m08:42:05.488918 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m08:42:05.489228 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:42:05.496046 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:42:05.496515 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m08:42:05.496847 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m08:42:05.507615 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:42:05.511327 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m08:42:05.511918 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m08:42:05.512254 [debug] [ThreadPool]: On list_ecom_main: Close
[0m08:42:05.517985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e711a75-b5bb-436e-b5c1-821aaaf45582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbbe5ec130>]}
[0m08:42:05.518562 [debug] [MainThread]: Using duckdb connection "master"
[0m08:42:05.518896 [debug] [MainThread]: On master: BEGIN
[0m08:42:05.519210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:42:05.526825 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:42:05.527312 [debug] [MainThread]: On master: COMMIT
[0m08:42:05.527643 [debug] [MainThread]: Using duckdb connection "master"
[0m08:42:05.527976 [debug] [MainThread]: On master: COMMIT
[0m08:42:05.528382 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:42:05.528729 [debug] [MainThread]: On master: Close
[0m08:42:05.531349 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:42:05.531766 [info ] [MainThread]: 
[0m08:42:05.533731 [debug] [Thread-1 (]: Began running node model.ecom.aggregates_ordered
[0m08:42:05.534230 [info ] [Thread-1 (]: 1 of 1 START sql view model main.aggregates_ordered ............................ [RUN]
[0m08:42:05.534927 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.aggregates_ordered'
[0m08:42:05.535301 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates_ordered
[0m08:42:05.541779 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates_ordered"
[0m08:42:05.542449 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates_ordered (compile): 08:42:05.535538 => 08:42:05.542236
[0m08:42:05.542831 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates_ordered
[0m08:42:05.566841 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates_ordered"
[0m08:42:05.567748 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m08:42:05.568217 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: BEGIN
[0m08:42:05.568588 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:42:05.576535 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:42:05.577119 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m08:42:05.577542 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */

  
  create view "ecom"."main"."aggregates_ordered__dbt_tmp" as (
    


select product_name, round(total_revenue,1) 
from aggregates    
order by 2 desc
  );

[0m08:42:05.578364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:42:05.584064 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m08:42:05.584499 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
alter view "ecom"."main"."aggregates_ordered" rename to "aggregates_ordered__dbt_backup"
[0m08:42:05.585055 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:42:05.587900 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m08:42:05.588320 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
alter view "ecom"."main"."aggregates_ordered__dbt_tmp" rename to "aggregates_ordered"
[0m08:42:05.588807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:42:05.601477 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: COMMIT
[0m08:42:05.601997 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m08:42:05.602374 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: COMMIT
[0m08:42:05.606154 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:42:05.611445 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m08:42:05.611913 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
drop view if exists "ecom"."main"."aggregates_ordered__dbt_backup" cascade
[0m08:42:05.615140 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:42:05.616880 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates_ordered (execute): 08:42:05.543063 => 08:42:05.616678
[0m08:42:05.617267 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: Close
[0m08:42:05.659811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e711a75-b5bb-436e-b5c1-821aaaf45582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbbe41cf70>]}
[0m08:42:05.660681 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.aggregates_ordered ....................... [[32mOK[0m in 0.13s]
[0m08:42:05.661322 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates_ordered
[0m08:42:05.663307 [debug] [MainThread]: Using duckdb connection "master"
[0m08:42:05.663676 [debug] [MainThread]: On master: BEGIN
[0m08:42:05.664003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:42:05.670391 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:42:05.670821 [debug] [MainThread]: On master: COMMIT
[0m08:42:05.671150 [debug] [MainThread]: Using duckdb connection "master"
[0m08:42:05.671467 [debug] [MainThread]: On master: COMMIT
[0m08:42:05.671838 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:42:05.672177 [debug] [MainThread]: On master: Close
[0m08:42:05.674205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:42:05.674535 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m08:42:05.674839 [debug] [MainThread]: Connection 'model.ecom.aggregates_ordered' was properly closed.
[0m08:42:05.675203 [info ] [MainThread]: 
[0m08:42:05.675593 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m08:42:05.676313 [debug] [MainThread]: Command end result
[0m08:42:05.684300 [info ] [MainThread]: 
[0m08:42:05.684801 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:42:05.685156 [info ] [MainThread]: 
[0m08:42:05.685519 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:42:05.686284 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.63183796, "process_user_time": 1.905708, "process_kernel_time": 0.110475, "process_mem_max_rss": "160160", "process_out_blocks": "7864", "process_in_blocks": "0"}
[0m08:42:05.686840 [debug] [MainThread]: Command `dbt run` succeeded at 08:42:05.686704 after 0.63 seconds
[0m08:42:05.687254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbcb76e8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbbe4e7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbbe4e70d0>]}
[0m08:42:05.687639 [debug] [MainThread]: Flushing usage events
[0m08:42:48.599040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f2aae8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f0756f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f07573d0>]}


============================== 08:42:48.601493 | 38af394f-4a5a-4e02-a4e0-6cd0aa5dfc1c ==============================
[0m08:42:48.601493 [info ] [MainThread]: Running with dbt=1.7.2
[0m08:42:48.602100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/peek/.dbt', 'log_path': '/home/peek/code/ecom/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models aggregates_ordered', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:42:48.771053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38af394f-4a5a-4e02-a4e0-6cd0aa5dfc1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f0756da0>]}
[0m08:42:48.839932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38af394f-4a5a-4e02-a4e0-6cd0aa5dfc1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0e5914820>]}
[0m08:42:48.840703 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m08:42:48.847385 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m08:42:48.866387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:42:48.866891 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:42:48.943521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38af394f-4a5a-4e02-a4e0-6cd0aa5dfc1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0e5714940>]}
[0m08:42:48.951107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38af394f-4a5a-4e02-a4e0-6cd0aa5dfc1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0e58e8550>]}
[0m08:42:48.951624 [info ] [MainThread]: Found 11 seeds, 4 models, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m08:42:48.952024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38af394f-4a5a-4e02-a4e0-6cd0aa5dfc1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0e58e86d0>]}
[0m08:42:48.953217 [info ] [MainThread]: 
[0m08:42:48.953940 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:42:48.954884 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m08:42:48.964180 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m08:42:48.964583 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m08:42:48.964923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:48.973902 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:42:48.975298 [debug] [ThreadPool]: On list_ecom: Close
[0m08:42:48.979137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m08:42:48.979793 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m08:42:48.984039 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m08:42:48.984387 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m08:42:48.984698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:42:48.991260 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:42:48.991722 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m08:42:48.992197 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m08:42:48.992661 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:42:48.993537 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m08:42:48.993876 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m08:42:48.994208 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m08:42:48.994716 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:42:48.995255 [debug] [ThreadPool]: On create_ecom_main: Close
[0m08:42:48.999533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m08:42:49.004267 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m08:42:49.004690 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m08:42:49.005051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:42:49.012073 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:42:49.012536 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m08:42:49.012881 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m08:42:49.023517 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:42:49.026872 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m08:42:49.027410 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m08:42:49.027745 [debug] [ThreadPool]: On list_ecom_main: Close
[0m08:42:49.033199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38af394f-4a5a-4e02-a4e0-6cd0aa5dfc1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0e58e8190>]}
[0m08:42:49.033728 [debug] [MainThread]: Using duckdb connection "master"
[0m08:42:49.034059 [debug] [MainThread]: On master: BEGIN
[0m08:42:49.034382 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:42:49.041649 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:42:49.042084 [debug] [MainThread]: On master: COMMIT
[0m08:42:49.042423 [debug] [MainThread]: Using duckdb connection "master"
[0m08:42:49.042761 [debug] [MainThread]: On master: COMMIT
[0m08:42:49.043145 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:42:49.043488 [debug] [MainThread]: On master: Close
[0m08:42:49.045622 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:42:49.046036 [info ] [MainThread]: 
[0m08:42:49.047972 [debug] [Thread-1 (]: Began running node model.ecom.aggregates_ordered
[0m08:42:49.048540 [info ] [Thread-1 (]: 1 of 1 START sql view model main.aggregates_ordered ............................ [RUN]
[0m08:42:49.049281 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.aggregates_ordered'
[0m08:42:49.049661 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates_ordered
[0m08:42:49.056122 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates_ordered"
[0m08:42:49.056721 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates_ordered (compile): 08:42:49.049903 => 08:42:49.056508
[0m08:42:49.057100 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates_ordered
[0m08:42:49.081923 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates_ordered"
[0m08:42:49.082708 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m08:42:49.083119 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: BEGIN
[0m08:42:49.083489 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:42:49.091252 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:42:49.091824 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m08:42:49.092210 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */

  
  create view "ecom"."main"."aggregates_ordered__dbt_tmp" as (
    


select product_name, round(total_revenue,1) as total_revenue
from aggregates    
order by 2 desc
  );

[0m08:42:49.092914 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:42:49.098845 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m08:42:49.099281 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
alter view "ecom"."main"."aggregates_ordered" rename to "aggregates_ordered__dbt_backup"
[0m08:42:49.099850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:42:49.102874 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m08:42:49.103398 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
alter view "ecom"."main"."aggregates_ordered__dbt_tmp" rename to "aggregates_ordered"
[0m08:42:49.104046 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:42:49.116913 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: COMMIT
[0m08:42:49.117452 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m08:42:49.117862 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: COMMIT
[0m08:42:49.122211 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:42:49.127055 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m08:42:49.127435 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
drop view if exists "ecom"."main"."aggregates_ordered__dbt_backup" cascade
[0m08:42:49.129976 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:42:49.131778 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates_ordered (execute): 08:42:49.057351 => 08:42:49.131569
[0m08:42:49.132169 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: Close
[0m08:42:49.174833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38af394f-4a5a-4e02-a4e0-6cd0aa5dfc1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0e5717340>]}
[0m08:42:49.175642 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.aggregates_ordered ....................... [[32mOK[0m in 0.13s]
[0m08:42:49.176290 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates_ordered
[0m08:42:49.178360 [debug] [MainThread]: Using duckdb connection "master"
[0m08:42:49.178742 [debug] [MainThread]: On master: BEGIN
[0m08:42:49.179085 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:42:49.185719 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:42:49.186131 [debug] [MainThread]: On master: COMMIT
[0m08:42:49.186493 [debug] [MainThread]: Using duckdb connection "master"
[0m08:42:49.186816 [debug] [MainThread]: On master: COMMIT
[0m08:42:49.187195 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:42:49.187543 [debug] [MainThread]: On master: Close
[0m08:42:49.189461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:42:49.189787 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m08:42:49.190170 [debug] [MainThread]: Connection 'model.ecom.aggregates_ordered' was properly closed.
[0m08:42:49.190552 [info ] [MainThread]: 
[0m08:42:49.190942 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m08:42:49.191631 [debug] [MainThread]: Command end result
[0m08:42:49.200059 [info ] [MainThread]: 
[0m08:42:49.200670 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:42:49.201029 [info ] [MainThread]: 
[0m08:42:49.201400 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:42:49.202188 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.63760775, "process_user_time": 1.840427, "process_kernel_time": 0.17484, "process_mem_max_rss": "156024", "process_out_blocks": "7872", "process_in_blocks": "0"}
[0m08:42:49.202726 [debug] [MainThread]: Command `dbt run` succeeded at 08:42:49.202601 after 0.64 seconds
[0m08:42:49.203116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f2aae8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0e57df190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0e57de9b0>]}
[0m08:42:49.203500 [debug] [MainThread]: Flushing usage events
[0m17:04:01.169450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88341ebf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8831e95930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8831e97490>]}


============================== 17:04:01.172624 | b8301b93-7774-4903-a2db-5f7093968e53 ==============================
[0m17:04:01.172624 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:04:01.173061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peek/code/ecom/logs', 'profiles_dir': '/home/peek/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:04:01.441407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8301b93-7774-4903-a2db-5f7093968e53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88329e1540>]}
[0m17:04:01.505234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8301b93-7774-4903-a2db-5f7093968e53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8827018790>]}
[0m17:04:01.506358 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m17:04:01.512348 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m17:04:01.567439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:04:01.568191 [debug] [MainThread]: Partial parsing: updated file: ecom://models/example/schema.yml
[0m17:04:01.758603 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/example/schema.yml:
  	test definition dictionary must have exactly one key, got [('name', 'Uniqueness Test'), ('description', 'Check if each ID is unique'), ('script', 'SELECT COUNT(*) = COUNT(DISTINCT id) FROM OBT_ECON;')] instead (3 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m17:04:01.760453 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.623536, "process_user_time": 1.87687, "process_kernel_time": 0.139766, "process_mem_max_rss": "136936", "process_in_blocks": "123136", "process_out_blocks": "8", "command_success": false}
[0m17:04:01.761071 [debug] [MainThread]: Command `dbt run` failed at 17:04:01.760938 after 0.62 seconds
[0m17:04:01.761449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88341ebf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8824f67ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8824f67a60>]}
[0m17:04:01.761781 [debug] [MainThread]: Flushing usage events
[0m17:09:12.988678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef47972560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4564efb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4564f3d0>]}


============================== 17:09:12.991315 | 9de8173e-3617-4a7f-ac3c-5d15b2e6bd82 ==============================
[0m17:09:12.991315 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:09:12.991809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/peek/code/ecom/logs', 'fail_fast': 'False', 'profiles_dir': '/home/peek/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:09:13.146349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9de8173e-3617-4a7f-ac3c-5d15b2e6bd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4564edd0>]}
[0m17:09:13.212533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9de8173e-3617-4a7f-ac3c-5d15b2e6bd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3a834820>]}
[0m17:09:13.213813 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m17:09:13.219786 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m17:09:13.237516 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m17:09:13.238085 [debug] [MainThread]: Partial parsing: added file: ecom://models/example/OBT_ECOM.sql
[0m17:09:13.238600 [debug] [MainThread]: Partial parsing: updated file: ecom://models/example/schema.yml
[0m17:09:13.239045 [debug] [MainThread]: Partial parsing: deleted file: ecom://models/example/OBT_ECON.sql
[0m17:09:13.447301 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'OBT_ECON' in the 'models' section of file 'models/example/schema.yml'
[0m17:09:13.449582 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/example/schema.yml:
  	test definition dictionary must have exactly one key, got [('name', 'Uniqueness Test'), ('description', 'Check if each ID is unique'), ('script', 'SELECT COUNT(*) = COUNT(DISTINCT id) FROM OBT_ECON;')] instead (3 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m17:09:13.450431 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4932411, "process_user_time": 1.815284, "process_kernel_time": 0.060175, "process_mem_max_rss": "137556", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m17:09:13.450952 [debug] [MainThread]: Command `dbt run` failed at 17:09:13.450830 after 0.49 seconds
[0m17:09:13.451332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef47972560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3a58f880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3a58f640>]}
[0m17:09:13.451710 [debug] [MainThread]: Flushing usage events
[0m17:10:22.879778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8152428f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd812ee9c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd812ee9450>]}


============================== 17:10:22.881726 | 94bdca51-19df-40e3-8d98-6ad47e9bfc96 ==============================
[0m17:10:22.881726 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:10:22.882175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/peek/code/ecom/logs', 'profiles_dir': '/home/peek/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:10:23.027547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94bdca51-19df-40e3-8d98-6ad47e9bfc96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd812f230a0>]}
[0m17:10:23.090918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94bdca51-19df-40e3-8d98-6ad47e9bfc96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8081156f0>]}
[0m17:10:23.091705 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m17:10:23.097280 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m17:10:23.113233 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m17:10:23.113676 [debug] [MainThread]: Partial parsing: added file: ecom://models/example/OBT_ECOM.sql
[0m17:10:23.114151 [debug] [MainThread]: Partial parsing: updated file: ecom://models/example/schema.yml
[0m17:10:23.114560 [debug] [MainThread]: Partial parsing: deleted file: ecom://models/example/OBT_ECON.sql
[0m17:10:23.378032 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ecom.revenue' (models/example/revenue.sql) depends on a node named 'OBT_ECON' which was not found
[0m17:10:23.379035 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5304712, "process_user_time": 1.867205, "process_kernel_time": 0.060232, "process_mem_max_rss": "137196", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m17:10:23.379590 [debug] [MainThread]: Command `dbt run` failed at 17:10:23.379459 after 0.53 seconds
[0m17:10:23.379966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8152428f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd806010370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd80602fbe0>]}
[0m17:10:23.380346 [debug] [MainThread]: Flushing usage events
[0m17:10:44.318638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed1707cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ecf3eddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ecf3ef430>]}


============================== 17:10:44.320570 | c2ff3b42-894f-4840-a264-9c7a8016bb5b ==============================
[0m17:10:44.320570 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:10:44.321067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peek/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peek/code/ecom/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:10:44.469375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2ff3b42-894f-4840-a264-9c7a8016bb5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ecff2d570>]}
[0m17:10:44.531434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2ff3b42-894f-4840-a264-9c7a8016bb5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec4547460>]}
[0m17:10:44.532086 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m17:10:44.537308 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m17:10:44.553091 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m17:10:44.553608 [debug] [MainThread]: Partial parsing: added file: ecom://models/example/OBT_ECOM.sql
[0m17:10:44.554075 [debug] [MainThread]: Partial parsing: updated file: ecom://models/example/schema.yml
[0m17:10:44.554481 [debug] [MainThread]: Partial parsing: deleted file: ecom://models/example/OBT_ECON.sql
[0m17:10:44.554796 [debug] [MainThread]: Partial parsing: updated file: ecom://models/example/revenue.sql
[0m17:10:44.824113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2ff3b42-894f-4840-a264-9c7a8016bb5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec2225ea0>]}
[0m17:10:44.830734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2ff3b42-894f-4840-a264-9c7a8016bb5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec43146a0>]}
[0m17:10:44.831212 [info ] [MainThread]: Found 11 seeds, 4 models, 3 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m17:10:44.831572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2ff3b42-894f-4840-a264-9c7a8016bb5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec4314700>]}
[0m17:10:44.832933 [info ] [MainThread]: 
[0m17:10:44.833597 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:10:44.834719 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m17:10:44.843221 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m17:10:44.843559 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m17:10:44.843885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:44.867701 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:44.869632 [debug] [ThreadPool]: On list_ecom: Close
[0m17:10:44.872644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m17:10:44.873411 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m17:10:44.877310 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m17:10:44.877628 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m17:10:44.877926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:44.883342 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:44.883772 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m17:10:44.884084 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m17:10:44.884660 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:44.885451 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m17:10:44.885757 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m17:10:44.886048 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m17:10:44.886412 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:44.886718 [debug] [ThreadPool]: On create_ecom_main: Close
[0m17:10:44.890451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m17:10:44.895100 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m17:10:44.895416 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m17:10:44.895709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:44.901352 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:44.901746 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m17:10:44.902061 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m17:10:44.912461 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:44.917215 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m17:10:44.918312 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m17:10:44.918640 [debug] [ThreadPool]: On list_ecom_main: Close
[0m17:10:44.924151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2ff3b42-894f-4840-a264-9c7a8016bb5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec224b160>]}
[0m17:10:44.924851 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:44.925172 [debug] [MainThread]: On master: BEGIN
[0m17:10:44.925485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:44.931899 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:10:44.932387 [debug] [MainThread]: On master: COMMIT
[0m17:10:44.932697 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:44.932997 [debug] [MainThread]: On master: COMMIT
[0m17:10:44.933347 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:10:44.933659 [debug] [MainThread]: On master: Close
[0m17:10:44.935651 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:44.936027 [info ] [MainThread]: 
[0m17:10:44.937930 [debug] [Thread-1 (]: Began running node model.ecom.OBT_ECOM
[0m17:10:44.938400 [info ] [Thread-1 (]: 1 of 4 START sql table model main.OBT_ECOM ..................................... [RUN]
[0m17:10:44.939126 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.OBT_ECOM'
[0m17:10:44.939466 [debug] [Thread-1 (]: Began compiling node model.ecom.OBT_ECOM
[0m17:10:44.944838 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.OBT_ECOM"
[0m17:10:44.945397 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECOM (compile): 17:10:44.939690 => 17:10:44.945206
[0m17:10:44.945733 [debug] [Thread-1 (]: Began executing node model.ecom.OBT_ECOM
[0m17:10:44.968271 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.OBT_ECOM"
[0m17:10:44.968968 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m17:10:44.969363 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: BEGIN
[0m17:10:44.969744 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:10:44.976760 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:44.977197 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m17:10:44.977567 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECOM"} */

  
    
    

    create  table
      "ecom"."main"."OBT_ECOM__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



select *
from econ0
union all
select *
from econ1
union all
select *
from econ2
union all
select *
from econ3
union all
select *
from econ4
union all
select *
from econ5
union all
select *
from econ6
union all
select *
from econ7
union all
select *
from econ8
union all
select *
from econ9
union all
select *
from econ10

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m17:10:51.170928 [debug] [Thread-1 (]: SQL status: OK in 6.0 seconds
[0m17:10:51.176289 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m17:10:51.176671 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECOM"} */
alter table "ecom"."main"."OBT_ECOM__dbt_tmp" rename to "OBT_ECOM"
[0m17:10:51.177272 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:51.189264 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: COMMIT
[0m17:10:51.189629 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m17:10:51.189961 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: COMMIT
[0m17:10:54.640939 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m17:10:54.646312 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m17:10:54.646697 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECOM"} */
drop table if exists "ecom"."main"."OBT_ECOM__dbt_backup" cascade
[0m17:10:54.647283 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:54.648447 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECOM (execute): 17:10:44.945944 => 17:10:54.648269
[0m17:10:54.648786 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: Close
[0m17:10:54.750743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2ff3b42-894f-4840-a264-9c7a8016bb5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec21200d0>]}
[0m17:10:54.751506 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.OBT_ECOM ................................ [[32mOK[0m in 9.81s]
[0m17:10:54.752123 [debug] [Thread-1 (]: Finished running node model.ecom.OBT_ECOM
[0m17:10:54.752572 [debug] [Thread-1 (]: Began running node model.ecom.aggregates_ordered
[0m17:10:54.752998 [info ] [Thread-1 (]: 2 of 4 START sql view model main.aggregates_ordered ............................ [RUN]
[0m17:10:54.753882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.OBT_ECOM, now model.ecom.aggregates_ordered)
[0m17:10:54.754250 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates_ordered
[0m17:10:54.756624 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates_ordered"
[0m17:10:54.757166 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates_ordered (compile): 17:10:54.754478 => 17:10:54.756981
[0m17:10:54.757511 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates_ordered
[0m17:10:54.769695 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates_ordered"
[0m17:10:54.770239 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m17:10:54.770603 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: BEGIN
[0m17:10:54.770971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:54.776431 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:54.776830 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m17:10:54.777182 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */

  
  create view "ecom"."main"."aggregates_ordered__dbt_tmp" as (
    


select product_name, round(total_revenue,1) as total_revenue
from aggregates    
order by 2 desc
  );

[0m17:10:54.777809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:54.780564 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m17:10:54.780905 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
alter view "ecom"."main"."aggregates_ordered" rename to "aggregates_ordered__dbt_backup"
[0m17:10:54.781366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:54.784021 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m17:10:54.784524 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
alter view "ecom"."main"."aggregates_ordered__dbt_tmp" rename to "aggregates_ordered"
[0m17:10:54.785224 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:54.789480 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: COMMIT
[0m17:10:54.790136 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m17:10:54.790479 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: COMMIT
[0m17:10:54.793683 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:54.796937 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m17:10:54.797481 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
drop view if exists "ecom"."main"."aggregates_ordered__dbt_backup" cascade
[0m17:10:54.800466 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:54.802602 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates_ordered (execute): 17:10:54.757737 => 17:10:54.802314
[0m17:10:54.803185 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: Close
[0m17:10:54.881094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2ff3b42-894f-4840-a264-9c7a8016bb5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec42f60b0>]}
[0m17:10:54.882246 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main.aggregates_ordered ....................... [[32mOK[0m in 0.13s]
[0m17:10:54.883212 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates_ordered
[0m17:10:54.883852 [debug] [Thread-1 (]: Began running node model.ecom.revenue
[0m17:10:54.884886 [info ] [Thread-1 (]: 3 of 4 START sql view model main.revenue ....................................... [RUN]
[0m17:10:54.885937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.aggregates_ordered, now model.ecom.revenue)
[0m17:10:54.886467 [debug] [Thread-1 (]: Began compiling node model.ecom.revenue
[0m17:10:54.890219 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.revenue"
[0m17:10:54.891176 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (compile): 17:10:54.886782 => 17:10:54.890817
[0m17:10:54.891723 [debug] [Thread-1 (]: Began executing node model.ecom.revenue
[0m17:10:54.898599 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.revenue"
[0m17:10:54.899546 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m17:10:54.900119 [debug] [Thread-1 (]: On model.ecom.revenue: BEGIN
[0m17:10:54.900644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:54.909309 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:54.910080 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m17:10:54.910782 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */

  
  create view "ecom"."main"."revenue__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *, quantity * price as revenue
from "ecom"."main"."OBT_ECOM"
  );

[0m17:10:54.911674 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:54.914543 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m17:10:54.914899 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue" rename to "revenue__dbt_backup"
[0m17:10:54.915343 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:54.917492 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m17:10:54.917834 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue__dbt_tmp" rename to "revenue"
[0m17:10:54.918266 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:54.919734 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m17:10:54.920067 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m17:10:54.920400 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m17:10:54.923628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:54.926078 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m17:10:54.926414 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
drop view if exists "ecom"."main"."revenue__dbt_backup" cascade
[0m17:10:54.928470 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:54.929978 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (execute): 17:10:54.892059 => 17:10:54.929777
[0m17:10:54.930328 [debug] [Thread-1 (]: On model.ecom.revenue: Close
[0m17:10:54.983349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2ff3b42-894f-4840-a264-9c7a8016bb5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec21742b0>]}
[0m17:10:54.984041 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main.revenue .................................. [[32mOK[0m in 0.10s]
[0m17:10:54.984601 [debug] [Thread-1 (]: Finished running node model.ecom.revenue
[0m17:10:54.985819 [debug] [Thread-1 (]: Began running node model.ecom.aggregates
[0m17:10:54.986425 [info ] [Thread-1 (]: 4 of 4 START sql view model main.aggregates .................................... [RUN]
[0m17:10:54.987258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.revenue, now model.ecom.aggregates)
[0m17:10:54.987612 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates
[0m17:10:54.990203 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates"
[0m17:10:54.990755 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (compile): 17:10:54.987825 => 17:10:54.990568
[0m17:10:54.991118 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates
[0m17:10:54.994375 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates"
[0m17:10:54.994836 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m17:10:54.995172 [debug] [Thread-1 (]: On model.ecom.aggregates: BEGIN
[0m17:10:54.995504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:55.000603 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:55.001024 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m17:10:55.001373 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */

  
  create view "ecom"."main"."aggregates__dbt_tmp" as (
    

select product_name, sum(revenue) as total_revenue
from "ecom"."main"."revenue"
group by product_name
  );

[0m17:10:55.001941 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:55.004540 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m17:10:55.004880 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
alter view "ecom"."main"."aggregates" rename to "aggregates__dbt_backup"
[0m17:10:55.005364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:55.007441 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m17:10:55.007778 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
alter view "ecom"."main"."aggregates__dbt_tmp" rename to "aggregates"
[0m17:10:55.008210 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:55.009560 [debug] [Thread-1 (]: On model.ecom.aggregates: COMMIT
[0m17:10:55.009888 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m17:10:55.010202 [debug] [Thread-1 (]: On model.ecom.aggregates: COMMIT
[0m17:10:55.013210 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:55.016153 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m17:10:55.016538 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
drop view if exists "ecom"."main"."aggregates__dbt_backup" cascade
[0m17:10:55.018944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:55.019974 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (execute): 17:10:54.991339 => 17:10:55.019802
[0m17:10:55.020333 [debug] [Thread-1 (]: On model.ecom.aggregates: Close
[0m17:10:55.074632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2ff3b42-894f-4840-a264-9c7a8016bb5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec219e200>]}
[0m17:10:55.075384 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.aggregates ............................... [[32mOK[0m in 0.09s]
[0m17:10:55.075954 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates
[0m17:10:55.077738 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:55.078152 [debug] [MainThread]: On master: BEGIN
[0m17:10:55.078523 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:55.090131 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:10:55.090608 [debug] [MainThread]: On master: COMMIT
[0m17:10:55.090963 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:55.091365 [debug] [MainThread]: On master: COMMIT
[0m17:10:55.091745 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:10:55.092062 [debug] [MainThread]: On master: Close
[0m17:10:55.094050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:55.094361 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m17:10:55.094640 [debug] [MainThread]: Connection 'model.ecom.aggregates' was properly closed.
[0m17:10:55.095002 [info ] [MainThread]: 
[0m17:10:55.095369 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 10.26 seconds (10.26s).
[0m17:10:55.096214 [debug] [MainThread]: Command end result
[0m17:10:55.103141 [info ] [MainThread]: 
[0m17:10:55.103600 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:10:55.103980 [info ] [MainThread]: 
[0m17:10:55.104336 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:10:55.105059 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.8170595, "process_user_time": 41.466866, "process_kernel_time": 4.115643, "process_mem_max_rss": "3251880", "process_in_blocks": "2053240", "process_out_blocks": "2059944"}
[0m17:10:55.105603 [debug] [MainThread]: Command `dbt run` succeeded at 17:10:55.105489 after 10.82 seconds
[0m17:10:55.106002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed1707cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec2183fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ecff2d570>]}
[0m17:10:55.106362 [debug] [MainThread]: Flushing usage events
[0m17:33:06.936076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf7ac23f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf78905930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf78907490>]}


============================== 17:33:06.938104 | 8a89dfed-a264-47ec-be18-8e8508273fae ==============================
[0m17:33:06.938104 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:33:06.938600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/peek/code/ecom/logs', 'profiles_dir': '/home/peek/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:33:07.097204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a89dfed-a264-47ec-be18-8e8508273fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf79445540>]}
[0m17:33:07.165409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a89dfed-a264-47ec-be18-8e8508273fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6db44790>]}
[0m17:33:07.166131 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m17:33:07.171838 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m17:33:07.190116 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:33:07.190690 [debug] [MainThread]: Partial parsing: added file: ecom://models/example/agg_test.sql
[0m17:33:07.380512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a89dfed-a264-47ec-be18-8e8508273fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6d87c0d0>]}
[0m17:33:07.388733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a89dfed-a264-47ec-be18-8e8508273fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6d823f70>]}
[0m17:33:07.389250 [info ] [MainThread]: Found 11 seeds, 5 models, 3 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m17:33:07.389648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a89dfed-a264-47ec-be18-8e8508273fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6d820820>]}
[0m17:33:07.391016 [info ] [MainThread]: 
[0m17:33:07.391674 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:33:07.393307 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom_main'
[0m17:33:07.401223 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m17:33:07.401657 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m17:33:07.402009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:07.411158 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:33:07.411661 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m17:33:07.412053 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m17:33:07.423383 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:33:07.427468 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m17:33:07.428055 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m17:33:07.428390 [debug] [ThreadPool]: On list_ecom_main: Close
[0m17:33:07.435316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a89dfed-a264-47ec-be18-8e8508273fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6d903ca0>]}
[0m17:33:07.435816 [debug] [MainThread]: Using duckdb connection "master"
[0m17:33:07.436134 [debug] [MainThread]: On master: BEGIN
[0m17:33:07.436436 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:33:07.443342 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:33:07.443780 [debug] [MainThread]: On master: COMMIT
[0m17:33:07.444101 [debug] [MainThread]: Using duckdb connection "master"
[0m17:33:07.444415 [debug] [MainThread]: On master: COMMIT
[0m17:33:07.444776 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:33:07.445110 [debug] [MainThread]: On master: Close
[0m17:33:07.447111 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:33:07.447488 [info ] [MainThread]: 
[0m17:33:07.449447 [debug] [Thread-1 (]: Began running node test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6
[0m17:33:07.450044 [info ] [Thread-1 (]: 1 of 3 START test not_null_OBT_ECOM_id ......................................... [RUN]
[0m17:33:07.450992 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6'
[0m17:33:07.451354 [debug] [Thread-1 (]: Began compiling node test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6
[0m17:33:07.463907 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6"
[0m17:33:07.464734 [debug] [Thread-1 (]: Timing info for test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6 (compile): 17:33:07.451627 => 17:33:07.464513
[0m17:33:07.465103 [debug] [Thread-1 (]: Began executing node test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6
[0m17:33:07.475574 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6"
[0m17:33:07.476498 [debug] [Thread-1 (]: Using duckdb connection "test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6"
[0m17:33:07.476888 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6: BEGIN
[0m17:33:07.477240 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:33:07.486256 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:07.486868 [debug] [Thread-1 (]: Using duckdb connection "test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6"
[0m17:33:07.487248 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "ecom"."main"."OBT_ECOM"
where id is null



      
    ) dbt_internal_test
[0m17:33:07.488720 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:07.491546 [debug] [Thread-1 (]: Timing info for test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6 (execute): 17:33:07.465342 => 17:33:07.491292
[0m17:33:07.492040 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6: ROLLBACK
[0m17:33:07.492487 [debug] [Thread-1 (]: Failed to rollback 'test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6'
[0m17:33:07.492870 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6: Close
[0m17:33:07.495842 [info ] [Thread-1 (]: 1 of 3 PASS not_null_OBT_ECOM_id ............................................... [[32mPASS[0m in 0.05s]
[0m17:33:07.496477 [debug] [Thread-1 (]: Finished running node test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6
[0m17:33:07.496939 [debug] [Thread-1 (]: Began running node test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95
[0m17:33:07.497537 [info ] [Thread-1 (]: 2 of 3 START test not_null_OBT_ECOM_timestamp .................................. [RUN]
[0m17:33:07.498462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6, now test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95)
[0m17:33:07.499025 [debug] [Thread-1 (]: Began compiling node test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95
[0m17:33:07.503280 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95"
[0m17:33:07.503888 [debug] [Thread-1 (]: Timing info for test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95 (compile): 17:33:07.499300 => 17:33:07.503668
[0m17:33:07.504263 [debug] [Thread-1 (]: Began executing node test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95
[0m17:33:07.506319 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95"
[0m17:33:07.506869 [debug] [Thread-1 (]: Using duckdb connection "test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95"
[0m17:33:07.507258 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95: BEGIN
[0m17:33:07.507613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:07.514403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:07.514860 [debug] [Thread-1 (]: Using duckdb connection "test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95"
[0m17:33:07.515266 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "ecom"."main"."OBT_ECOM"
where timestamp is null



      
    ) dbt_internal_test
[0m17:33:07.516204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:07.517803 [debug] [Thread-1 (]: Timing info for test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95 (execute): 17:33:07.504505 => 17:33:07.517576
[0m17:33:07.518260 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95: ROLLBACK
[0m17:33:07.518702 [debug] [Thread-1 (]: Failed to rollback 'test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95'
[0m17:33:07.519070 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95: Close
[0m17:33:07.521590 [info ] [Thread-1 (]: 2 of 3 PASS not_null_OBT_ECOM_timestamp ........................................ [[32mPASS[0m in 0.02s]
[0m17:33:07.522225 [debug] [Thread-1 (]: Finished running node test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95
[0m17:33:07.522697 [debug] [Thread-1 (]: Began running node test.ecom.unique_OBT_ECOM_id.d0ccddc384
[0m17:33:07.523205 [info ] [Thread-1 (]: 3 of 3 START test unique_OBT_ECOM_id ........................................... [RUN]
[0m17:33:07.523859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95, now test.ecom.unique_OBT_ECOM_id.d0ccddc384)
[0m17:33:07.524280 [debug] [Thread-1 (]: Began compiling node test.ecom.unique_OBT_ECOM_id.d0ccddc384
[0m17:33:07.531278 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecom.unique_OBT_ECOM_id.d0ccddc384"
[0m17:33:07.531997 [debug] [Thread-1 (]: Timing info for test.ecom.unique_OBT_ECOM_id.d0ccddc384 (compile): 17:33:07.524517 => 17:33:07.531755
[0m17:33:07.532385 [debug] [Thread-1 (]: Began executing node test.ecom.unique_OBT_ECOM_id.d0ccddc384
[0m17:33:07.534508 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecom.unique_OBT_ECOM_id.d0ccddc384"
[0m17:33:07.535074 [debug] [Thread-1 (]: Using duckdb connection "test.ecom.unique_OBT_ECOM_id.d0ccddc384"
[0m17:33:07.535451 [debug] [Thread-1 (]: On test.ecom.unique_OBT_ECOM_id.d0ccddc384: BEGIN
[0m17:33:07.535804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:07.542744 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:07.543290 [debug] [Thread-1 (]: Using duckdb connection "test.ecom.unique_OBT_ECOM_id.d0ccddc384"
[0m17:33:07.543692 [debug] [Thread-1 (]: On test.ecom.unique_OBT_ECOM_id.d0ccddc384: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "test.ecom.unique_OBT_ECOM_id.d0ccddc384"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "ecom"."main"."OBT_ECOM"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:33:07.861706 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:33:07.863975 [debug] [Thread-1 (]: Timing info for test.ecom.unique_OBT_ECOM_id.d0ccddc384 (execute): 17:33:07.532626 => 17:33:07.863591
[0m17:33:07.864571 [debug] [Thread-1 (]: On test.ecom.unique_OBT_ECOM_id.d0ccddc384: ROLLBACK
[0m17:33:07.865174 [debug] [Thread-1 (]: Failed to rollback 'test.ecom.unique_OBT_ECOM_id.d0ccddc384'
[0m17:33:07.865698 [debug] [Thread-1 (]: On test.ecom.unique_OBT_ECOM_id.d0ccddc384: Close
[0m17:33:07.881545 [error] [Thread-1 (]: 3 of 3 FAIL 80000 unique_OBT_ECOM_id ........................................... [[31mFAIL 80000[0m in 0.36s]
[0m17:33:07.882362 [debug] [Thread-1 (]: Finished running node test.ecom.unique_OBT_ECOM_id.d0ccddc384
[0m17:33:07.884749 [debug] [MainThread]: Using duckdb connection "master"
[0m17:33:07.885198 [debug] [MainThread]: On master: BEGIN
[0m17:33:07.885574 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:33:07.893242 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:33:07.893710 [debug] [MainThread]: On master: COMMIT
[0m17:33:07.894094 [debug] [MainThread]: Using duckdb connection "master"
[0m17:33:07.894489 [debug] [MainThread]: On master: COMMIT
[0m17:33:07.894928 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:33:07.895330 [debug] [MainThread]: On master: Close
[0m17:33:07.898031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:07.898422 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m17:33:07.898791 [debug] [MainThread]: Connection 'test.ecom.unique_OBT_ECOM_id.d0ccddc384' was properly closed.
[0m17:33:07.899242 [info ] [MainThread]: 
[0m17:33:07.899693 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m17:33:07.900866 [debug] [MainThread]: Command end result
[0m17:33:07.909538 [info ] [MainThread]: 
[0m17:33:07.910115 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:33:07.910616 [info ] [MainThread]: 
[0m17:33:07.911074 [error] [MainThread]: [31mFailure in test unique_OBT_ECOM_id (models/example/schema.yml)[0m
[0m17:33:07.911446 [error] [MainThread]:   Got 80000 results, configured to fail if != 0
[0m17:33:07.911869 [info ] [MainThread]: 
[0m17:33:07.912351 [info ] [MainThread]:   compiled Code at target/compiled/ecom/models/example/schema.yml/unique_OBT_ECOM_id.sql
[0m17:33:07.912810 [info ] [MainThread]: 
[0m17:33:07.913289 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:33:07.914216 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.0103443, "process_user_time": 4.265474, "process_kernel_time": 0.626398, "process_mem_max_rss": "557796", "process_in_blocks": "1040", "process_out_blocks": "2560", "command_success": false}
[0m17:33:07.914927 [debug] [MainThread]: Command `dbt test` failed at 17:33:07.914775 after 1.01 seconds
[0m17:33:07.915468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf7ac23f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf79445540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6db44790>]}
[0m17:33:07.915973 [debug] [MainThread]: Flushing usage events
[0m17:35:27.700380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f887cdde8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f887aabdc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f887aabd450>]}


============================== 17:35:27.702639 | 0b0098c4-172f-4cab-8451-0e3f93f22c82 ==============================
[0m17:35:27.702639 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:35:27.703178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/peek/code/ecom/logs', 'profiles_dir': '/home/peek/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m17:35:27.868136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b0098c4-172f-4cab-8451-0e3f93f22c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f887aaf70a0>]}
[0m17:35:27.937369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b0098c4-172f-4cab-8451-0e3f93f22c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f886fc496f0>]}
[0m17:35:27.938177 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m17:35:27.943881 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m17:35:27.961765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:35:27.962183 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:35:28.034932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b0098c4-172f-4cab-8451-0e3f93f22c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f886fa49600>]}
[0m17:35:28.042687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b0098c4-172f-4cab-8451-0e3f93f22c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f886fa19570>]}
[0m17:35:28.043202 [info ] [MainThread]: Found 11 seeds, 5 models, 3 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m17:35:28.043605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b0098c4-172f-4cab-8451-0e3f93f22c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f886fa19480>]}
[0m17:35:28.045025 [info ] [MainThread]: 
[0m17:35:28.045809 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:35:28.047359 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom_main'
[0m17:35:28.055718 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m17:35:28.056157 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m17:35:28.056476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:28.064816 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:35:28.065282 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m17:35:28.065621 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m17:35:28.076324 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:35:28.079574 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m17:35:28.080110 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m17:35:28.080436 [debug] [ThreadPool]: On list_ecom_main: Close
[0m17:35:28.086050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b0098c4-172f-4cab-8451-0e3f93f22c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f886fa07e50>]}
[0m17:35:28.086548 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:28.086875 [debug] [MainThread]: On master: BEGIN
[0m17:35:28.087191 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:35:28.094842 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:35:28.095365 [debug] [MainThread]: On master: COMMIT
[0m17:35:28.095695 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:28.096009 [debug] [MainThread]: On master: COMMIT
[0m17:35:28.096387 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:35:28.096729 [debug] [MainThread]: On master: Close
[0m17:35:28.099515 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:35:28.099909 [info ] [MainThread]: 
[0m17:35:28.102044 [debug] [Thread-1 (]: Began running node test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6
[0m17:35:28.102474 [info ] [Thread-1 (]: 1 of 3 START test not_null_OBT_ECOM_id ......................................... [RUN]
[0m17:35:28.103157 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6'
[0m17:35:28.103526 [debug] [Thread-1 (]: Began compiling node test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6
[0m17:35:28.116407 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6"
[0m17:35:28.117019 [debug] [Thread-1 (]: Timing info for test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6 (compile): 17:35:28.103763 => 17:35:28.116805
[0m17:35:28.117428 [debug] [Thread-1 (]: Began executing node test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6
[0m17:35:28.128052 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6"
[0m17:35:28.128682 [debug] [Thread-1 (]: Using duckdb connection "test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6"
[0m17:35:28.129079 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6: BEGIN
[0m17:35:28.129454 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:35:28.137588 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:28.138101 [debug] [Thread-1 (]: Using duckdb connection "test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6"
[0m17:35:28.138473 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "ecom"."main"."OBT_ECOM"
where id is null



      
    ) dbt_internal_test
[0m17:35:28.157957 [debug] [Thread-1 (]: Timing info for test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6 (execute): 17:35:28.117690 => 17:35:28.157557
[0m17:35:28.158633 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6: ROLLBACK
[0m17:35:28.164682 [debug] [Thread-1 (]: Failed to rollback 'test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6'
[0m17:35:28.165087 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6: Close
[0m17:35:28.169540 [debug] [Thread-1 (]: Runtime Error in test not_null_OBT_ECOM_id (models/example/schema.yml)
  Catalog Error: Table with name OBT_ECOM does not exist!
  Did you mean "econ9"?
[0m17:35:28.170078 [error] [Thread-1 (]: 1 of 3 ERROR not_null_OBT_ECOM_id .............................................. [[31mERROR[0m in 0.07s]
[0m17:35:28.170710 [debug] [Thread-1 (]: Finished running node test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6
[0m17:35:28.171199 [debug] [Thread-1 (]: Began running node test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95
[0m17:35:28.171640 [info ] [Thread-1 (]: 2 of 3 START test not_null_OBT_ECOM_timestamp .................................. [RUN]
[0m17:35:28.172473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6, now test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95)
[0m17:35:28.172851 [debug] [Thread-1 (]: Began compiling node test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95
[0m17:35:28.176730 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95"
[0m17:35:28.177340 [debug] [Thread-1 (]: Timing info for test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95 (compile): 17:35:28.173087 => 17:35:28.177130
[0m17:35:28.177725 [debug] [Thread-1 (]: Began executing node test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95
[0m17:35:28.179575 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95"
[0m17:35:28.180094 [debug] [Thread-1 (]: Using duckdb connection "test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95"
[0m17:35:28.180475 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95: BEGIN
[0m17:35:28.180822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:28.187049 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:28.187588 [debug] [Thread-1 (]: Using duckdb connection "test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95"
[0m17:35:28.187969 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "ecom"."main"."OBT_ECOM"
where timestamp is null



      
    ) dbt_internal_test
[0m17:35:28.198259 [debug] [Thread-1 (]: Timing info for test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95 (execute): 17:35:28.177957 => 17:35:28.198008
[0m17:35:28.198979 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95: ROLLBACK
[0m17:35:28.200094 [debug] [Thread-1 (]: Failed to rollback 'test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95'
[0m17:35:28.200488 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95: Close
[0m17:35:28.203669 [debug] [Thread-1 (]: Runtime Error in test not_null_OBT_ECOM_timestamp (models/example/schema.yml)
  Catalog Error: Table with name OBT_ECOM does not exist!
  Did you mean "econ9"?
[0m17:35:28.204175 [error] [Thread-1 (]: 2 of 3 ERROR not_null_OBT_ECOM_timestamp ....................................... [[31mERROR[0m in 0.03s]
[0m17:35:28.204737 [debug] [Thread-1 (]: Finished running node test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95
[0m17:35:28.205166 [debug] [Thread-1 (]: Began running node test.ecom.unique_OBT_ECOM_id.d0ccddc384
[0m17:35:28.205760 [info ] [Thread-1 (]: 3 of 3 START test unique_OBT_ECOM_id ........................................... [RUN]
[0m17:35:28.206632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95, now test.ecom.unique_OBT_ECOM_id.d0ccddc384)
[0m17:35:28.207102 [debug] [Thread-1 (]: Began compiling node test.ecom.unique_OBT_ECOM_id.d0ccddc384
[0m17:35:28.212654 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecom.unique_OBT_ECOM_id.d0ccddc384"
[0m17:35:28.213311 [debug] [Thread-1 (]: Timing info for test.ecom.unique_OBT_ECOM_id.d0ccddc384 (compile): 17:35:28.207342 => 17:35:28.213091
[0m17:35:28.213689 [debug] [Thread-1 (]: Began executing node test.ecom.unique_OBT_ECOM_id.d0ccddc384
[0m17:35:28.215721 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecom.unique_OBT_ECOM_id.d0ccddc384"
[0m17:35:28.216301 [debug] [Thread-1 (]: Using duckdb connection "test.ecom.unique_OBT_ECOM_id.d0ccddc384"
[0m17:35:28.216679 [debug] [Thread-1 (]: On test.ecom.unique_OBT_ECOM_id.d0ccddc384: BEGIN
[0m17:35:28.217029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:28.223221 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:28.223681 [debug] [Thread-1 (]: Using duckdb connection "test.ecom.unique_OBT_ECOM_id.d0ccddc384"
[0m17:35:28.224063 [debug] [Thread-1 (]: On test.ecom.unique_OBT_ECOM_id.d0ccddc384: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "test.ecom.unique_OBT_ECOM_id.d0ccddc384"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "ecom"."main"."OBT_ECOM"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:35:28.234789 [debug] [Thread-1 (]: Timing info for test.ecom.unique_OBT_ECOM_id.d0ccddc384 (execute): 17:35:28.213948 => 17:35:28.234487
[0m17:35:28.235251 [debug] [Thread-1 (]: On test.ecom.unique_OBT_ECOM_id.d0ccddc384: ROLLBACK
[0m17:35:28.235990 [debug] [Thread-1 (]: Failed to rollback 'test.ecom.unique_OBT_ECOM_id.d0ccddc384'
[0m17:35:28.236367 [debug] [Thread-1 (]: On test.ecom.unique_OBT_ECOM_id.d0ccddc384: Close
[0m17:35:28.239529 [debug] [Thread-1 (]: Runtime Error in test unique_OBT_ECOM_id (models/example/schema.yml)
  Catalog Error: Table with name OBT_ECOM does not exist!
  Did you mean "econ9"?
[0m17:35:28.240036 [error] [Thread-1 (]: 3 of 3 ERROR unique_OBT_ECOM_id ................................................ [[31mERROR[0m in 0.03s]
[0m17:35:28.240634 [debug] [Thread-1 (]: Finished running node test.ecom.unique_OBT_ECOM_id.d0ccddc384
[0m17:35:28.242572 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:28.243136 [debug] [MainThread]: On master: BEGIN
[0m17:35:28.243464 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:35:28.249845 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:35:28.250270 [debug] [MainThread]: On master: COMMIT
[0m17:35:28.250663 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:28.251027 [debug] [MainThread]: On master: COMMIT
[0m17:35:28.251448 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:35:28.251795 [debug] [MainThread]: On master: Close
[0m17:35:28.254251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:28.254587 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m17:35:28.254892 [debug] [MainThread]: Connection 'test.ecom.unique_OBT_ECOM_id.d0ccddc384' was properly closed.
[0m17:35:28.255263 [info ] [MainThread]: 
[0m17:35:28.255650 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m17:35:28.256530 [debug] [MainThread]: Command end result
[0m17:35:28.264571 [info ] [MainThread]: 
[0m17:35:28.265100 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m17:35:28.265452 [info ] [MainThread]: 
[0m17:35:28.265792 [error] [MainThread]:   Runtime Error in test not_null_OBT_ECOM_id (models/example/schema.yml)
  Catalog Error: Table with name OBT_ECOM does not exist!
  Did you mean "econ9"?
[0m17:35:28.266126 [info ] [MainThread]: 
[0m17:35:28.266450 [error] [MainThread]:   Runtime Error in test not_null_OBT_ECOM_timestamp (models/example/schema.yml)
  Catalog Error: Table with name OBT_ECOM does not exist!
  Did you mean "econ9"?
[0m17:35:28.266777 [info ] [MainThread]: 
[0m17:35:28.267099 [error] [MainThread]:   Runtime Error in test unique_OBT_ECOM_id (models/example/schema.yml)
  Catalog Error: Table with name OBT_ECOM does not exist!
  Did you mean "econ9"?
[0m17:35:28.267424 [info ] [MainThread]: 
[0m17:35:28.267774 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m17:35:28.268528 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.60351866, "process_user_time": 1.865361, "process_kernel_time": 0.091439, "process_mem_max_rss": "157620", "process_in_blocks": "5064", "process_out_blocks": "1760", "command_success": false}
[0m17:35:28.269066 [debug] [MainThread]: Command `dbt test` failed at 17:35:28.268939 after 0.60 seconds
[0m17:35:28.269476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f887cdde8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f886fc496f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f886f970a60>]}
[0m17:35:28.269859 [debug] [MainThread]: Flushing usage events
[0m17:35:38.622061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccbc5ae8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccba288400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccba2898d0>]}


============================== 17:35:38.624137 | 699fecbf-d41b-49a1-8a19-f8bc1e5749be ==============================
[0m17:35:38.624137 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:35:38.624585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/peek/code/ecom/logs', 'debug': 'False', 'profiles_dir': '/home/peek/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:35:38.782351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '699fecbf-d41b-49a1-8a19-f8bc1e5749be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccbadcd4b0>]}
[0m17:35:38.848629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '699fecbf-d41b-49a1-8a19-f8bc1e5749be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaf434130>]}
[0m17:35:38.849377 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m17:35:38.854916 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m17:35:38.872071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:35:38.872482 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:35:38.944178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '699fecbf-d41b-49a1-8a19-f8bc1e5749be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaf2355d0>]}
[0m17:35:38.951747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '699fecbf-d41b-49a1-8a19-f8bc1e5749be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaf205540>]}
[0m17:35:38.952295 [info ] [MainThread]: Found 11 seeds, 5 models, 3 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m17:35:38.952743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '699fecbf-d41b-49a1-8a19-f8bc1e5749be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaf205450>]}
[0m17:35:38.954223 [info ] [MainThread]: 
[0m17:35:38.954916 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:35:38.956090 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m17:35:38.965286 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m17:35:38.965640 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m17:35:38.965974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:38.974929 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:35:38.976319 [debug] [ThreadPool]: On list_ecom: Close
[0m17:35:38.979896 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m17:35:38.980513 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m17:35:38.984449 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m17:35:38.984788 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m17:35:38.985103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:35:38.991180 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:35:38.991722 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m17:35:38.992112 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m17:35:38.992567 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:35:38.993436 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m17:35:38.993758 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m17:35:38.994058 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m17:35:38.994455 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:35:38.994801 [debug] [ThreadPool]: On create_ecom_main: Close
[0m17:35:38.998970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m17:35:39.004288 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m17:35:39.004680 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m17:35:39.005020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:35:39.011594 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:35:39.012142 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m17:35:39.012476 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m17:35:39.022672 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:35:39.025819 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m17:35:39.026344 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m17:35:39.026667 [debug] [ThreadPool]: On list_ecom_main: Close
[0m17:35:39.032382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '699fecbf-d41b-49a1-8a19-f8bc1e5749be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaf28fc40>]}
[0m17:35:39.032857 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:39.033184 [debug] [MainThread]: On master: BEGIN
[0m17:35:39.033494 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:35:39.039899 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:35:39.040319 [debug] [MainThread]: On master: COMMIT
[0m17:35:39.040691 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:39.041033 [debug] [MainThread]: On master: COMMIT
[0m17:35:39.041445 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:35:39.041825 [debug] [MainThread]: On master: Close
[0m17:35:39.044322 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:35:39.044733 [info ] [MainThread]: 
[0m17:35:39.046760 [debug] [Thread-1 (]: Began running node model.ecom.OBT_ECOM
[0m17:35:39.047276 [info ] [Thread-1 (]: 1 of 4 START sql table model main.OBT_ECOM ..................................... [RUN]
[0m17:35:39.047978 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.OBT_ECOM'
[0m17:35:39.048345 [debug] [Thread-1 (]: Began compiling node model.ecom.OBT_ECOM
[0m17:35:39.054139 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.OBT_ECOM"
[0m17:35:39.054755 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECOM (compile): 17:35:39.048580 => 17:35:39.054541
[0m17:35:39.055133 [debug] [Thread-1 (]: Began executing node model.ecom.OBT_ECOM
[0m17:35:39.079599 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.OBT_ECOM"
[0m17:35:39.080252 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m17:35:39.080640 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: BEGIN
[0m17:35:39.081017 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:35:39.089337 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:39.089833 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m17:35:39.090225 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECOM"} */

  
    
    

    create  table
      "ecom"."main"."OBT_ECOM__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



select *
from econ0
union all
select *
from econ1
union all
select *
from econ2
union all
select *
from econ3
union all
select *
from econ4
union all
select *
from econ5
union all
select *
from econ6
union all
select *
from econ7
union all
select *
from econ8
union all
select *
from econ9
union all
select *
from econ10

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m17:35:45.386605 [debug] [Thread-1 (]: SQL status: OK in 6.0 seconds
[0m17:35:45.394165 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m17:35:45.394686 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECOM"} */
alter table "ecom"."main"."OBT_ECOM__dbt_tmp" rename to "OBT_ECOM"
[0m17:35:45.395473 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:45.408932 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: COMMIT
[0m17:35:45.409351 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m17:35:45.409735 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: COMMIT
[0m17:35:48.989554 [debug] [Thread-1 (]: SQL status: OK in 4.0 seconds
[0m17:35:48.994757 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m17:35:48.995221 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECOM"} */
drop table if exists "ecom"."main"."OBT_ECOM__dbt_backup" cascade
[0m17:35:48.995912 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:48.997470 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECOM (execute): 17:35:39.055362 => 17:35:48.997233
[0m17:35:48.997880 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: Close
[0m17:35:49.109231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '699fecbf-d41b-49a1-8a19-f8bc1e5749be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaf28fc40>]}
[0m17:35:49.110094 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.OBT_ECOM ................................ [[32mOK[0m in 10.06s]
[0m17:35:49.110798 [debug] [Thread-1 (]: Finished running node model.ecom.OBT_ECOM
[0m17:35:49.111330 [debug] [Thread-1 (]: Began running node model.ecom.aggregates_ordered
[0m17:35:49.111835 [info ] [Thread-1 (]: 2 of 4 START sql view model main.aggregates_ordered ............................ [RUN]
[0m17:35:49.112594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.OBT_ECOM, now model.ecom.aggregates_ordered)
[0m17:35:49.113328 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates_ordered
[0m17:35:49.117000 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates_ordered"
[0m17:35:49.117634 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates_ordered (compile): 17:35:49.113652 => 17:35:49.117431
[0m17:35:49.118040 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates_ordered
[0m17:35:49.131995 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates_ordered"
[0m17:35:49.132654 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m17:35:49.133031 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: BEGIN
[0m17:35:49.133388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:49.140076 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:49.140524 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m17:35:49.140909 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */

  
  create view "ecom"."main"."aggregates_ordered__dbt_tmp" as (
    


select product_name, round(total_revenue,1) as total_revenue
from aggregates    
order by 2 desc
  );

[0m17:35:49.141684 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:49.144897 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m17:35:49.145284 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
alter view "ecom"."main"."aggregates_ordered" rename to "aggregates_ordered__dbt_backup"
[0m17:35:49.145800 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:49.148361 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m17:35:49.148774 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
alter view "ecom"."main"."aggregates_ordered__dbt_tmp" rename to "aggregates_ordered"
[0m17:35:49.149246 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:49.152409 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: COMMIT
[0m17:35:49.152808 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m17:35:49.153190 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: COMMIT
[0m17:35:49.157220 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:49.159865 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m17:35:49.160246 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
drop view if exists "ecom"."main"."aggregates_ordered__dbt_backup" cascade
[0m17:35:49.163066 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:49.164841 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates_ordered (execute): 17:35:49.118291 => 17:35:49.164588
[0m17:35:49.165226 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: Close
[0m17:35:49.207824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '699fecbf-d41b-49a1-8a19-f8bc1e5749be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccba185e10>]}
[0m17:35:49.208603 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main.aggregates_ordered ....................... [[32mOK[0m in 0.10s]
[0m17:35:49.209220 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates_ordered
[0m17:35:49.209726 [debug] [Thread-1 (]: Began running node model.ecom.revenue
[0m17:35:49.210177 [info ] [Thread-1 (]: 3 of 4 START sql view model main.revenue ....................................... [RUN]
[0m17:35:49.211083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.aggregates_ordered, now model.ecom.revenue)
[0m17:35:49.211596 [debug] [Thread-1 (]: Began compiling node model.ecom.revenue
[0m17:35:49.214753 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.revenue"
[0m17:35:49.215437 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (compile): 17:35:49.211926 => 17:35:49.215239
[0m17:35:49.215784 [debug] [Thread-1 (]: Began executing node model.ecom.revenue
[0m17:35:49.219237 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.revenue"
[0m17:35:49.219752 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m17:35:49.220112 [debug] [Thread-1 (]: On model.ecom.revenue: BEGIN
[0m17:35:49.220447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:49.226398 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:49.226826 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m17:35:49.227180 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */

  
  create view "ecom"."main"."revenue__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *, quantity * price as revenue
from "ecom"."main"."OBT_ECOM"
  );

[0m17:35:49.227748 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:49.231931 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m17:35:49.232369 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue" rename to "revenue__dbt_backup"
[0m17:35:49.232980 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:49.235630 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m17:35:49.236011 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue__dbt_tmp" rename to "revenue"
[0m17:35:49.236533 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:49.238258 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m17:35:49.238658 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m17:35:49.238999 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m17:35:49.242265 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:49.244850 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m17:35:49.245282 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
drop view if exists "ecom"."main"."revenue__dbt_backup" cascade
[0m17:35:49.248188 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:49.249818 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (execute): 17:35:49.216006 => 17:35:49.249619
[0m17:35:49.250207 [debug] [Thread-1 (]: On model.ecom.revenue: Close
[0m17:35:49.292878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '699fecbf-d41b-49a1-8a19-f8bc1e5749be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaf164910>]}
[0m17:35:49.293646 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main.revenue .................................. [[32mOK[0m in 0.08s]
[0m17:35:49.294245 [debug] [Thread-1 (]: Finished running node model.ecom.revenue
[0m17:35:49.295603 [debug] [Thread-1 (]: Began running node model.ecom.aggregates
[0m17:35:49.296177 [info ] [Thread-1 (]: 4 of 4 START sql view model main.aggregates .................................... [RUN]
[0m17:35:49.296815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.revenue, now model.ecom.aggregates)
[0m17:35:49.297190 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates
[0m17:35:49.300101 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates"
[0m17:35:49.300704 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (compile): 17:35:49.297422 => 17:35:49.300501
[0m17:35:49.301079 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates
[0m17:35:49.304873 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates"
[0m17:35:49.305430 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m17:35:49.305802 [debug] [Thread-1 (]: On model.ecom.aggregates: BEGIN
[0m17:35:49.306148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:49.312105 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:49.312551 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m17:35:49.312943 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */

  
  create view "ecom"."main"."aggregates__dbt_tmp" as (
    

select product_name, sum(revenue) as total_revenue
from "ecom"."main"."revenue"
group by product_name
  );

[0m17:35:49.313611 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:49.316728 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m17:35:49.317139 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
alter view "ecom"."main"."aggregates" rename to "aggregates__dbt_backup"
[0m17:35:49.317675 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:49.320144 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m17:35:49.320541 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
alter view "ecom"."main"."aggregates__dbt_tmp" rename to "aggregates"
[0m17:35:49.321014 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:49.322548 [debug] [Thread-1 (]: On model.ecom.aggregates: COMMIT
[0m17:35:49.322915 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m17:35:49.323254 [debug] [Thread-1 (]: On model.ecom.aggregates: COMMIT
[0m17:35:49.325992 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:49.328246 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m17:35:49.328625 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
drop view if exists "ecom"."main"."aggregates__dbt_backup" cascade
[0m17:35:49.331271 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:35:49.332779 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (execute): 17:35:49.301329 => 17:35:49.332586
[0m17:35:49.333152 [debug] [Thread-1 (]: On model.ecom.aggregates: Close
[0m17:35:49.379310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '699fecbf-d41b-49a1-8a19-f8bc1e5749be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaf182ce0>]}
[0m17:35:49.380425 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.aggregates ............................... [[32mOK[0m in 0.08s]
[0m17:35:49.381311 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates
[0m17:35:49.384410 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:49.384987 [debug] [MainThread]: On master: BEGIN
[0m17:35:49.385503 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:35:49.418921 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:35:49.419849 [debug] [MainThread]: On master: COMMIT
[0m17:35:49.420575 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:49.421224 [debug] [MainThread]: On master: COMMIT
[0m17:35:49.421953 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:35:49.422541 [debug] [MainThread]: On master: Close
[0m17:35:49.426571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:49.427123 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m17:35:49.427612 [debug] [MainThread]: Connection 'model.ecom.aggregates' was properly closed.
[0m17:35:49.428281 [info ] [MainThread]: 
[0m17:35:49.428937 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 10.47 seconds (10.47s).
[0m17:35:49.430419 [debug] [MainThread]: Command end result
[0m17:35:49.445728 [info ] [MainThread]: 
[0m17:35:49.446568 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:35:49.447178 [info ] [MainThread]: 
[0m17:35:49.447790 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:35:49.449226 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.859753, "process_user_time": 39.605965, "process_kernel_time": 3.939958, "process_mem_max_rss": "3243208", "process_in_blocks": "88488", "process_out_blocks": "2068352"}
[0m17:35:49.450054 [debug] [MainThread]: Command `dbt run` succeeded at 17:35:49.449868 after 10.86 seconds
[0m17:35:49.450634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccbc5ae8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccba185e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaf434130>]}
[0m17:35:49.451193 [debug] [MainThread]: Flushing usage events
[0m17:37:58.889961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadf099fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadee64ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadee64ce80>]}


============================== 17:37:58.892385 | 29fc5641-1543-41f6-a1fe-26175121a2fc ==============================
[0m17:37:58.892385 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:37:58.892900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/peek/code/ecom/logs', 'version_check': 'True', 'profiles_dir': '/home/peek/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models agg_test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:37:59.055342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29fc5641-1543-41f6-a1fe-26175121a2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadeb8b7610>]}
[0m17:37:59.125094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29fc5641-1543-41f6-a1fe-26175121a2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadee803970>]}
[0m17:37:59.125878 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m17:37:59.131478 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m17:37:59.149659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:37:59.150221 [debug] [MainThread]: Partial parsing: updated file: ecom://models/example/agg_test.sql
[0m17:37:59.329306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29fc5641-1543-41f6-a1fe-26175121a2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade17440d0>]}
[0m17:37:59.337295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29fc5641-1543-41f6-a1fe-26175121a2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade37e94e0>]}
[0m17:37:59.337830 [info ] [MainThread]: Found 11 seeds, 5 models, 3 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m17:37:59.338218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29fc5641-1543-41f6-a1fe-26175121a2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade37e9540>]}
[0m17:37:59.339365 [info ] [MainThread]: 
[0m17:37:59.340098 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:37:59.341214 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m17:37:59.350037 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m17:37:59.350436 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m17:37:59.350774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:59.360639 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:37:59.362296 [debug] [ThreadPool]: On list_ecom: Close
[0m17:37:59.364794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m17:37:59.365419 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m17:37:59.369277 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m17:37:59.369621 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m17:37:59.369960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:37:59.375904 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:37:59.376407 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m17:37:59.376746 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m17:37:59.377225 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:37:59.378106 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m17:37:59.378445 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m17:37:59.378760 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m17:37:59.379162 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:37:59.379503 [debug] [ThreadPool]: On create_ecom_main: Close
[0m17:37:59.383402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m17:37:59.388561 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m17:37:59.388952 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m17:37:59.389267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:37:59.396614 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:37:59.397103 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m17:37:59.397457 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m17:37:59.408534 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:37:59.411992 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m17:37:59.413026 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m17:37:59.413524 [debug] [ThreadPool]: On list_ecom_main: Close
[0m17:37:59.419138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29fc5641-1543-41f6-a1fe-26175121a2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade1740940>]}
[0m17:37:59.419806 [debug] [MainThread]: Using duckdb connection "master"
[0m17:37:59.420177 [debug] [MainThread]: On master: BEGIN
[0m17:37:59.420489 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:37:59.427147 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:37:59.427590 [debug] [MainThread]: On master: COMMIT
[0m17:37:59.427919 [debug] [MainThread]: Using duckdb connection "master"
[0m17:37:59.428238 [debug] [MainThread]: On master: COMMIT
[0m17:37:59.428636 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:37:59.428969 [debug] [MainThread]: On master: Close
[0m17:37:59.431166 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:37:59.431644 [info ] [MainThread]: 
[0m17:37:59.433828 [debug] [Thread-1 (]: Began running node model.ecom.agg_test
[0m17:37:59.434354 [info ] [Thread-1 (]: 1 of 1 START sql view model main.agg_test ...................................... [RUN]
[0m17:37:59.435034 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.agg_test'
[0m17:37:59.435402 [debug] [Thread-1 (]: Began compiling node model.ecom.agg_test
[0m17:37:59.441322 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.agg_test"
[0m17:37:59.441946 [debug] [Thread-1 (]: Timing info for model.ecom.agg_test (compile): 17:37:59.435644 => 17:37:59.441694
[0m17:37:59.442317 [debug] [Thread-1 (]: Began executing node model.ecom.agg_test
[0m17:37:59.466301 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.agg_test"
[0m17:37:59.466983 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.agg_test"
[0m17:37:59.467361 [debug] [Thread-1 (]: On model.ecom.agg_test: BEGIN
[0m17:37:59.467755 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:37:59.475615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:37:59.476135 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.agg_test"
[0m17:37:59.476512 [debug] [Thread-1 (]: On model.ecom.agg_test: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.agg_test"} */

  
  create view "ecom"."main"."agg_test__dbt_tmp" as (
    


SELECT 
    COUNT(id) AS total_orders,
    SUM(quantity) AS total_items_sold,
    SUM(revenue) AS total_revenue,
    AVG(price) AS avg_price,
    MAX(revenue) AS max_revenue,
    MIN(revenue) AS min_revenue,
    AVG(discount_applied) AS avg_discount_applied
FROM "ecom"."main"."revenue";
  );

[0m17:37:59.480351 [debug] [Thread-1 (]: Timing info for model.ecom.agg_test (execute): 17:37:59.442548 => 17:37:59.480081
[0m17:37:59.480753 [debug] [Thread-1 (]: On model.ecom.agg_test: ROLLBACK
[0m17:37:59.483250 [debug] [Thread-1 (]: Failed to rollback 'model.ecom.agg_test'
[0m17:37:59.483801 [debug] [Thread-1 (]: On model.ecom.agg_test: Close
[0m17:37:59.486624 [debug] [Thread-1 (]: Runtime Error in model agg_test (models/example/agg_test.sql)
  Parser Error: syntax error at or near ";"
  LINE 16: FROM "ecom"."main"."revenue";
                                       ^
[0m17:37:59.487128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29fc5641-1543-41f6-a1fe-26175121a2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade174f760>]}
[0m17:37:59.487736 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.agg_test ............................. [[31mERROR[0m in 0.05s]
[0m17:37:59.488327 [debug] [Thread-1 (]: Finished running node model.ecom.agg_test
[0m17:37:59.490197 [debug] [MainThread]: Using duckdb connection "master"
[0m17:37:59.490554 [debug] [MainThread]: On master: BEGIN
[0m17:37:59.490864 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:37:59.497001 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:37:59.497405 [debug] [MainThread]: On master: COMMIT
[0m17:37:59.497735 [debug] [MainThread]: Using duckdb connection "master"
[0m17:37:59.498050 [debug] [MainThread]: On master: COMMIT
[0m17:37:59.498432 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:37:59.498753 [debug] [MainThread]: On master: Close
[0m17:37:59.500557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:37:59.500901 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m17:37:59.501208 [debug] [MainThread]: Connection 'model.ecom.agg_test' was properly closed.
[0m17:37:59.501551 [info ] [MainThread]: 
[0m17:37:59.501954 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m17:37:59.502562 [debug] [MainThread]: Command end result
[0m17:37:59.509401 [info ] [MainThread]: 
[0m17:37:59.509908 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:37:59.510253 [info ] [MainThread]: 
[0m17:37:59.510592 [error] [MainThread]:   Runtime Error in model agg_test (models/example/agg_test.sql)
  Parser Error: syntax error at or near ";"
  LINE 16: FROM "ecom"."main"."revenue";
                                       ^
[0m17:37:59.510931 [info ] [MainThread]: 
[0m17:37:59.511286 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:37:59.512037 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.657647, "process_user_time": 1.906344, "process_kernel_time": 0.110512, "process_mem_max_rss": "160468", "process_in_blocks": "2328", "process_out_blocks": "2512", "command_success": false}
[0m17:37:59.512559 [debug] [MainThread]: Command `dbt run` failed at 17:37:59.512435 after 0.66 seconds
[0m17:37:59.513020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadf099fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadee803970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade174c3a0>]}
[0m17:37:59.513400 [debug] [MainThread]: Flushing usage events
[0m17:38:17.606115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6027f28f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6004def80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6004df3d0>]}


============================== 17:38:17.608616 | 4191ab63-bfb0-4f80-bf5c-60487348481a ==============================
[0m17:38:17.608616 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:38:17.609137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peek/code/ecom/logs', 'profiles_dir': '/home/peek/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models agg_test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:38:17.773020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4191ab63-bfb0-4f80-bf5c-60487348481a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6004deda0>]}
[0m17:38:17.844923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4191ab63-bfb0-4f80-bf5c-60487348481a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f5634820>]}
[0m17:38:17.845767 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m17:38:17.851802 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m17:38:17.869659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:38:17.870280 [debug] [MainThread]: Partial parsing: updated file: ecom://models/example/agg_test.sql
[0m17:38:18.047226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4191ab63-bfb0-4f80-bf5c-60487348481a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f5373ee0>]}
[0m17:38:18.054424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4191ab63-bfb0-4f80-bf5c-60487348481a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f54094b0>]}
[0m17:38:18.054918 [info ] [MainThread]: Found 11 seeds, 5 models, 3 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m17:38:18.055323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4191ab63-bfb0-4f80-bf5c-60487348481a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f5409510>]}
[0m17:38:18.056478 [info ] [MainThread]: 
[0m17:38:18.057234 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:38:18.058375 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m17:38:18.066767 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m17:38:18.067115 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m17:38:18.067413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:18.077106 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:38:18.078485 [debug] [ThreadPool]: On list_ecom: Close
[0m17:38:18.081672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m17:38:18.082277 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m17:38:18.086053 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m17:38:18.086391 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m17:38:18.086704 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:18.092936 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:38:18.093455 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m17:38:18.093795 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m17:38:18.094334 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:38:18.095195 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m17:38:18.095537 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m17:38:18.095851 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m17:38:18.096252 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:38:18.096589 [debug] [ThreadPool]: On create_ecom_main: Close
[0m17:38:18.100688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m17:38:18.105988 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m17:38:18.106370 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m17:38:18.106691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:18.113564 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:38:18.114051 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m17:38:18.114405 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m17:38:18.125080 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:38:18.128347 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m17:38:18.128892 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m17:38:18.129223 [debug] [ThreadPool]: On list_ecom_main: Close
[0m17:38:18.134546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4191ab63-bfb0-4f80-bf5c-60487348481a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f536c940>]}
[0m17:38:18.135057 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:18.135385 [debug] [MainThread]: On master: BEGIN
[0m17:38:18.135700 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:18.142391 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:38:18.142835 [debug] [MainThread]: On master: COMMIT
[0m17:38:18.143190 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:18.143551 [debug] [MainThread]: On master: COMMIT
[0m17:38:18.143936 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:38:18.144282 [debug] [MainThread]: On master: Close
[0m17:38:18.146358 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:38:18.146764 [info ] [MainThread]: 
[0m17:38:18.148850 [debug] [Thread-1 (]: Began running node model.ecom.agg_test
[0m17:38:18.149361 [info ] [Thread-1 (]: 1 of 1 START sql view model main.agg_test ...................................... [RUN]
[0m17:38:18.150048 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.agg_test'
[0m17:38:18.150417 [debug] [Thread-1 (]: Began compiling node model.ecom.agg_test
[0m17:38:18.156408 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.agg_test"
[0m17:38:18.157010 [debug] [Thread-1 (]: Timing info for model.ecom.agg_test (compile): 17:38:18.150653 => 17:38:18.156804
[0m17:38:18.157385 [debug] [Thread-1 (]: Began executing node model.ecom.agg_test
[0m17:38:18.182281 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.agg_test"
[0m17:38:18.183072 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.agg_test"
[0m17:38:18.183479 [debug] [Thread-1 (]: On model.ecom.agg_test: BEGIN
[0m17:38:18.183853 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:38:18.191942 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:18.192583 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.agg_test"
[0m17:38:18.192983 [debug] [Thread-1 (]: On model.ecom.agg_test: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.agg_test"} */

  
  create view "ecom"."main"."agg_test__dbt_tmp" as (
    


SELECT 
    COUNT(id) AS total_orders,
    SUM(quantity) AS total_items_sold,
    SUM(revenue) AS total_revenue,
    AVG(price) AS avg_price,
    MAX(revenue) AS max_revenue,
    MIN(revenue) AS min_revenue,
    AVG(discount_applied) AS avg_discount_applied
FROM "ecom"."main"."revenue"
  );

[0m17:38:18.193729 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:18.199447 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.agg_test"
[0m17:38:18.199842 [debug] [Thread-1 (]: On model.ecom.agg_test: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.agg_test"} */
alter view "ecom"."main"."agg_test__dbt_tmp" rename to "agg_test"
[0m17:38:18.200382 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:18.210964 [debug] [Thread-1 (]: On model.ecom.agg_test: COMMIT
[0m17:38:18.211366 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.agg_test"
[0m17:38:18.211868 [debug] [Thread-1 (]: On model.ecom.agg_test: COMMIT
[0m17:38:18.215278 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:18.219486 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.agg_test"
[0m17:38:18.219881 [debug] [Thread-1 (]: On model.ecom.agg_test: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.agg_test"} */
drop view if exists "ecom"."main"."agg_test__dbt_backup" cascade
[0m17:38:18.220395 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:18.221624 [debug] [Thread-1 (]: Timing info for model.ecom.agg_test (execute): 17:38:18.157618 => 17:38:18.221416
[0m17:38:18.222029 [debug] [Thread-1 (]: On model.ecom.agg_test: Close
[0m17:38:18.270780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4191ab63-bfb0-4f80-bf5c-60487348481a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f53aad10>]}
[0m17:38:18.271567 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.agg_test ................................. [[32mOK[0m in 0.12s]
[0m17:38:18.272341 [debug] [Thread-1 (]: Finished running node model.ecom.agg_test
[0m17:38:18.273897 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:18.274277 [debug] [MainThread]: On master: BEGIN
[0m17:38:18.274613 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:38:18.281097 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:38:18.281542 [debug] [MainThread]: On master: COMMIT
[0m17:38:18.281898 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:18.282248 [debug] [MainThread]: On master: COMMIT
[0m17:38:18.282622 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:38:18.282960 [debug] [MainThread]: On master: Close
[0m17:38:18.285331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:18.285667 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m17:38:18.285982 [debug] [MainThread]: Connection 'model.ecom.agg_test' was properly closed.
[0m17:38:18.286343 [info ] [MainThread]: 
[0m17:38:18.286734 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m17:38:18.287437 [debug] [MainThread]: Command end result
[0m17:38:18.294106 [info ] [MainThread]: 
[0m17:38:18.294562 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:18.294965 [info ] [MainThread]: 
[0m17:38:18.295379 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:38:18.296137 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7230455, "process_user_time": 2.011397, "process_kernel_time": 0.064883, "process_mem_max_rss": "168368", "process_out_blocks": "8688", "process_in_blocks": "0"}
[0m17:38:18.296672 [debug] [MainThread]: Command `dbt run` succeeded at 17:38:18.296546 after 0.72 seconds
[0m17:38:18.297046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6027f28f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6003da0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f53826b0>]}
[0m17:38:18.297427 [debug] [MainThread]: Flushing usage events
[0m17:40:54.110886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37bfd568f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37bd9fc430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37bd9fd900>]}


============================== 17:40:54.113227 | 2f4a00b2-90e3-4e0f-920c-25780375d934 ==============================
[0m17:40:54.113227 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:40:54.113719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/peek/code/ecom/logs', 'fail_fast': 'False', 'profiles_dir': '/home/peek/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models agg_test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:40:54.272653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f4a00b2-90e3-4e0f-920c-25780375d934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37be55d480>]}
[0m17:40:54.341088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f4a00b2-90e3-4e0f-920c-25780375d934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b2c18130>]}
[0m17:40:54.341908 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m17:40:54.347622 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m17:40:54.365543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:40:54.366223 [debug] [MainThread]: Partial parsing: updated file: ecom://models/example/schema.yml
[0m17:40:54.366654 [debug] [MainThread]: Partial parsing: updated file: ecom://models/example/agg_test.sql
[0m17:40:54.581062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f4a00b2-90e3-4e0f-920c-25780375d934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b09ec0d0>]}
[0m17:40:54.588569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f4a00b2-90e3-4e0f-920c-25780375d934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b2bed450>]}
[0m17:40:54.589066 [info ] [MainThread]: Found 11 seeds, 5 models, 3 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m17:40:54.589458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f4a00b2-90e3-4e0f-920c-25780375d934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b2bed4b0>]}
[0m17:40:54.590622 [info ] [MainThread]: 
[0m17:40:54.591334 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:40:54.592411 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m17:40:54.601740 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m17:40:54.602198 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m17:40:54.602534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:54.611731 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:40:54.613135 [debug] [ThreadPool]: On list_ecom: Close
[0m17:40:54.615875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m17:40:54.616460 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m17:40:54.620563 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m17:40:54.620951 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m17:40:54.621263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:54.627265 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:40:54.627670 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m17:40:54.628015 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m17:40:54.628454 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:40:54.629301 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m17:40:54.629634 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m17:40:54.629952 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m17:40:54.630339 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:40:54.630677 [debug] [ThreadPool]: On create_ecom_main: Close
[0m17:40:54.634498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m17:40:54.639498 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m17:40:54.639883 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m17:40:54.640202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:54.646825 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:40:54.647284 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m17:40:54.647662 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m17:40:54.658022 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:40:54.661236 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m17:40:54.661808 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m17:40:54.662178 [debug] [ThreadPool]: On list_ecom_main: Close
[0m17:40:54.667546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f4a00b2-90e3-4e0f-920c-25780375d934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b0a63640>]}
[0m17:40:54.668216 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:54.668775 [debug] [MainThread]: On master: BEGIN
[0m17:40:54.669230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:40:54.676236 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:40:54.676646 [debug] [MainThread]: On master: COMMIT
[0m17:40:54.676986 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:54.677336 [debug] [MainThread]: On master: COMMIT
[0m17:40:54.677731 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:40:54.678073 [debug] [MainThread]: On master: Close
[0m17:40:54.680081 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:54.680516 [info ] [MainThread]: 
[0m17:40:54.682826 [debug] [Thread-1 (]: Began running node model.ecom.agg_test
[0m17:40:54.683339 [info ] [Thread-1 (]: 1 of 1 START sql view model main.agg_test ...................................... [RUN]
[0m17:40:54.683994 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.agg_test'
[0m17:40:54.684364 [debug] [Thread-1 (]: Began compiling node model.ecom.agg_test
[0m17:40:54.690186 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.agg_test"
[0m17:40:54.690833 [debug] [Thread-1 (]: Timing info for model.ecom.agg_test (compile): 17:40:54.684595 => 17:40:54.690604
[0m17:40:54.691197 [debug] [Thread-1 (]: Began executing node model.ecom.agg_test
[0m17:40:54.715165 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.agg_test"
[0m17:40:54.715855 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.agg_test"
[0m17:40:54.716264 [debug] [Thread-1 (]: On model.ecom.agg_test: BEGIN
[0m17:40:54.716623 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:40:54.724104 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:40:54.724633 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.agg_test"
[0m17:40:54.725024 [debug] [Thread-1 (]: On model.ecom.agg_test: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.agg_test"} */

  
  create view "ecom"."main"."agg_test__dbt_tmp" as (
    


SELECT 
    YEAR(created_at) AS order_year,
    COUNT(id) AS total_orders,
    SUM(quantity) AS total_items_sold,
    SUM(revenue) AS total_revenue,
    AVG(price) AS avg_price,
    MAX(revenue) AS max_revenue,
    MIN(revenue) AS min_revenue,
    AVG(discount_applied) AS avg_discount_applied
FROM "ecom"."main"."revenue"
GROUP BY YEAR(created_at)
  );

[0m17:40:54.726697 [debug] [Thread-1 (]: Timing info for model.ecom.agg_test (execute): 17:40:54.691446 => 17:40:54.726470
[0m17:40:54.727109 [debug] [Thread-1 (]: On model.ecom.agg_test: ROLLBACK
[0m17:40:54.728501 [debug] [Thread-1 (]: Failed to rollback 'model.ecom.agg_test'
[0m17:40:54.728877 [debug] [Thread-1 (]: On model.ecom.agg_test: Close
[0m17:40:54.732722 [debug] [Thread-1 (]: Runtime Error in model agg_test (models/example/agg_test.sql)
  Binder Error: Referenced column "created_at" not found in FROM clause!
  Candidate bindings: "revenue.id"
[0m17:40:54.733229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f4a00b2-90e3-4e0f-920c-25780375d934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b0a6b1f0>]}
[0m17:40:54.733841 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.agg_test ............................. [[31mERROR[0m in 0.05s]
[0m17:40:54.734466 [debug] [Thread-1 (]: Finished running node model.ecom.agg_test
[0m17:40:54.736165 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:54.736510 [debug] [MainThread]: On master: BEGIN
[0m17:40:54.736828 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:40:54.743196 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:40:54.743629 [debug] [MainThread]: On master: COMMIT
[0m17:40:54.743947 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:54.744251 [debug] [MainThread]: On master: COMMIT
[0m17:40:54.744657 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:40:54.744982 [debug] [MainThread]: On master: Close
[0m17:40:54.746880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:54.747203 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m17:40:54.747498 [debug] [MainThread]: Connection 'model.ecom.agg_test' was properly closed.
[0m17:40:54.747847 [info ] [MainThread]: 
[0m17:40:54.748198 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m17:40:54.748830 [debug] [MainThread]: Command end result
[0m17:40:54.755883 [info ] [MainThread]: 
[0m17:40:54.756413 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:40:54.756771 [info ] [MainThread]: 
[0m17:40:54.757117 [error] [MainThread]:   Runtime Error in model agg_test (models/example/agg_test.sql)
  Binder Error: Referenced column "created_at" not found in FROM clause!
  Candidate bindings: "revenue.id"
[0m17:40:54.757458 [info ] [MainThread]: 
[0m17:40:54.757810 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:40:54.758553 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.67978644, "process_user_time": 1.846496, "process_kernel_time": 0.138487, "process_mem_max_rss": "164260", "process_in_blocks": "152", "process_out_blocks": "2528", "command_success": false}
[0m17:40:54.759070 [debug] [MainThread]: Command `dbt run` failed at 17:40:54.758948 after 0.68 seconds
[0m17:40:54.759456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37bfd568f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b2c18130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b0a69f30>]}
[0m17:40:54.759827 [debug] [MainThread]: Flushing usage events
[0m17:41:52.186547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e87d68f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e647ef80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e647f3d0>]}


============================== 17:41:52.188911 | 5f85b75b-cb9d-4d99-9154-f4de7386625b ==============================
[0m17:41:52.188911 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:41:52.189371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/peek/.dbt', 'log_path': '/home/peek/code/ecom/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models agg_test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:41:52.347352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f85b75b-cb9d-4d99-9154-f4de7386625b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e647eda0>]}
[0m17:41:52.414482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f85b75b-cb9d-4d99-9154-f4de7386625b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4db618820>]}
[0m17:41:52.415188 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m17:41:52.420698 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m17:41:52.438415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:41:52.439019 [debug] [MainThread]: Partial parsing: updated file: ecom://models/example/agg_test.sql
[0m17:41:52.655505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f85b75b-cb9d-4d99-9154-f4de7386625b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d94240d0>]}
[0m17:41:52.663186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f85b75b-cb9d-4d99-9154-f4de7386625b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4db5ed630>]}
[0m17:41:52.663703 [info ] [MainThread]: Found 11 seeds, 5 models, 3 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m17:41:52.664146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f85b75b-cb9d-4d99-9154-f4de7386625b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4db5ed690>]}
[0m17:41:52.665353 [info ] [MainThread]: 
[0m17:41:52.666062 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:41:52.667189 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m17:41:52.676288 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m17:41:52.676695 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m17:41:52.677037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:52.685939 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:41:52.687288 [debug] [ThreadPool]: On list_ecom: Close
[0m17:41:52.690330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m17:41:52.691007 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m17:41:52.694958 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m17:41:52.695344 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m17:41:52.695674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:52.701656 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:41:52.702279 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m17:41:52.702618 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m17:41:52.703044 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:41:52.703899 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m17:41:52.704231 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m17:41:52.704539 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m17:41:52.704979 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:41:52.705347 [debug] [ThreadPool]: On create_ecom_main: Close
[0m17:41:52.709300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m17:41:52.714434 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m17:41:52.714783 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m17:41:52.715103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:52.721881 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:41:52.722435 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m17:41:52.722788 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m17:41:52.733108 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:41:52.736329 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m17:41:52.736851 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m17:41:52.737174 [debug] [ThreadPool]: On list_ecom_main: Close
[0m17:41:52.742870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f85b75b-cb9d-4d99-9154-f4de7386625b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d9463640>]}
[0m17:41:52.743390 [debug] [MainThread]: Using duckdb connection "master"
[0m17:41:52.743721 [debug] [MainThread]: On master: BEGIN
[0m17:41:52.744051 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:41:52.750404 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:41:52.750799 [debug] [MainThread]: On master: COMMIT
[0m17:41:52.751135 [debug] [MainThread]: Using duckdb connection "master"
[0m17:41:52.751468 [debug] [MainThread]: On master: COMMIT
[0m17:41:52.751949 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:41:52.752307 [debug] [MainThread]: On master: Close
[0m17:41:52.754315 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:41:52.754733 [info ] [MainThread]: 
[0m17:41:52.756774 [debug] [Thread-1 (]: Began running node model.ecom.agg_test
[0m17:41:52.757394 [info ] [Thread-1 (]: 1 of 1 START sql view model main.agg_test ...................................... [RUN]
[0m17:41:52.758335 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.agg_test'
[0m17:41:52.758706 [debug] [Thread-1 (]: Began compiling node model.ecom.agg_test
[0m17:41:52.764550 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.agg_test"
[0m17:41:52.765145 [debug] [Thread-1 (]: Timing info for model.ecom.agg_test (compile): 17:41:52.758938 => 17:41:52.764940
[0m17:41:52.765506 [debug] [Thread-1 (]: Began executing node model.ecom.agg_test
[0m17:41:52.788796 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.agg_test"
[0m17:41:52.789484 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.agg_test"
[0m17:41:52.789863 [debug] [Thread-1 (]: On model.ecom.agg_test: BEGIN
[0m17:41:52.790180 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:41:52.797654 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:41:52.798175 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.agg_test"
[0m17:41:52.798549 [debug] [Thread-1 (]: On model.ecom.agg_test: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.agg_test"} */

  
  create view "ecom"."main"."agg_test__dbt_tmp" as (
    


SELECT 
    YEAR(timestamp) AS order_year,
    COUNT(id) AS total_orders,
    SUM(quantity) AS total_items_sold,
    SUM(revenue) AS total_revenue,
    AVG(price) AS avg_price,
    MAX(revenue) AS max_revenue,
    MIN(revenue) AS min_revenue,
    AVG(discount_applied) AS avg_discount_applied
FROM "ecom"."main"."revenue"
GROUP BY YEAR(timestamp)
  );

[0m17:41:52.799271 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:41:52.805146 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.agg_test"
[0m17:41:52.805544 [debug] [Thread-1 (]: On model.ecom.agg_test: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.agg_test"} */
alter view "ecom"."main"."agg_test" rename to "agg_test__dbt_backup"
[0m17:41:52.806093 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:41:52.808657 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.agg_test"
[0m17:41:52.809057 [debug] [Thread-1 (]: On model.ecom.agg_test: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.agg_test"} */
alter view "ecom"."main"."agg_test__dbt_tmp" rename to "agg_test"
[0m17:41:52.809557 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:41:52.821441 [debug] [Thread-1 (]: On model.ecom.agg_test: COMMIT
[0m17:41:52.821864 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.agg_test"
[0m17:41:52.822221 [debug] [Thread-1 (]: On model.ecom.agg_test: COMMIT
[0m17:41:52.825631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:41:52.830118 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.agg_test"
[0m17:41:52.830483 [debug] [Thread-1 (]: On model.ecom.agg_test: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.agg_test"} */
drop view if exists "ecom"."main"."agg_test__dbt_backup" cascade
[0m17:41:52.833195 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:41:52.834749 [debug] [Thread-1 (]: Timing info for model.ecom.agg_test (execute): 17:41:52.765748 => 17:41:52.834469
[0m17:41:52.835238 [debug] [Thread-1 (]: On model.ecom.agg_test: Close
[0m17:41:52.877378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f85b75b-cb9d-4d99-9154-f4de7386625b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d946d360>]}
[0m17:41:52.878248 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.agg_test ................................. [[32mOK[0m in 0.12s]
[0m17:41:52.878892 [debug] [Thread-1 (]: Finished running node model.ecom.agg_test
[0m17:41:52.880419 [debug] [MainThread]: Using duckdb connection "master"
[0m17:41:52.880774 [debug] [MainThread]: On master: BEGIN
[0m17:41:52.881121 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:41:52.887106 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:41:52.887511 [debug] [MainThread]: On master: COMMIT
[0m17:41:52.887838 [debug] [MainThread]: Using duckdb connection "master"
[0m17:41:52.888152 [debug] [MainThread]: On master: COMMIT
[0m17:41:52.888524 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:41:52.888859 [debug] [MainThread]: On master: Close
[0m17:41:52.890866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:52.891194 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m17:41:52.891495 [debug] [MainThread]: Connection 'model.ecom.agg_test' was properly closed.
[0m17:41:52.891872 [info ] [MainThread]: 
[0m17:41:52.892254 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m17:41:52.892862 [debug] [MainThread]: Command end result
[0m17:41:52.900041 [info ] [MainThread]: 
[0m17:41:52.900572 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:41:52.900943 [info ] [MainThread]: 
[0m17:41:52.901310 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:41:52.902078 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7478908, "process_user_time": 2.029219, "process_kernel_time": 0.037063, "process_mem_max_rss": "167304", "process_out_blocks": "8192", "process_in_blocks": "0"}
[0m17:41:52.902604 [debug] [MainThread]: Command `dbt run` succeeded at 17:41:52.902477 after 0.75 seconds
[0m17:41:52.902989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e87d68f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4db759b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d9443340>]}
[0m17:41:52.903396 [debug] [MainThread]: Flushing usage events
[0m17:43:55.383032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e998c68c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e975a4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e975a58d0>]}


============================== 17:43:55.385266 | ed140cb0-2934-4e65-98b5-3d1b1324f36b ==============================
[0m17:43:55.385266 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:43:55.385727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peek/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peek/code/ecom/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:43:55.547551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed140cb0-2934-4e65-98b5-3d1b1324f36b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e980ed4b0>]}
[0m17:43:55.616509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed140cb0-2934-4e65-98b5-3d1b1324f36b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8c744130>]}
[0m17:43:55.617351 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m17:43:55.623154 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m17:43:55.640979 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m17:43:55.641486 [debug] [MainThread]: Partial parsing: deleted file: ecom://models/example/agg_test.sql
[0m17:43:55.641968 [debug] [MainThread]: Partial parsing: updated file: ecom://models/example/aggregates.sql
[0m17:43:55.850886 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'agg_test' in the 'models' section of file 'models/example/schema.yml'
[0m17:43:55.860779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed140cb0-2934-4e65-98b5-3d1b1324f36b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8a5480d0>]}
[0m17:43:55.868037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed140cb0-2934-4e65-98b5-3d1b1324f36b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8c5194e0>]}
[0m17:43:55.868511 [info ] [MainThread]: Found 11 seeds, 4 models, 3 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m17:43:55.868921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed140cb0-2934-4e65-98b5-3d1b1324f36b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8c519540>]}
[0m17:43:55.870322 [info ] [MainThread]: 
[0m17:43:55.871010 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:43:55.872272 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m17:43:55.881695 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m17:43:55.882142 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m17:43:55.882481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:55.891265 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:55.892687 [debug] [ThreadPool]: On list_ecom: Close
[0m17:43:55.895358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m17:43:55.895947 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m17:43:55.899928 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m17:43:55.900290 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m17:43:55.900613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:55.906901 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:55.907474 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m17:43:55.907841 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m17:43:55.908306 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:55.909181 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m17:43:55.909553 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m17:43:55.909873 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m17:43:55.910282 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:55.910639 [debug] [ThreadPool]: On create_ecom_main: Close
[0m17:43:55.914754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m17:43:55.919372 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m17:43:55.919716 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m17:43:55.920034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:55.926393 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:55.926816 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m17:43:55.927157 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m17:43:55.937613 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:55.940774 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m17:43:55.941348 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m17:43:55.941712 [debug] [ThreadPool]: On list_ecom_main: Close
[0m17:43:55.947201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed140cb0-2934-4e65-98b5-3d1b1324f36b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8c503190>]}
[0m17:43:55.947773 [debug] [MainThread]: Using duckdb connection "master"
[0m17:43:55.948113 [debug] [MainThread]: On master: BEGIN
[0m17:43:55.948440 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:43:55.955224 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:43:55.955621 [debug] [MainThread]: On master: COMMIT
[0m17:43:55.955953 [debug] [MainThread]: Using duckdb connection "master"
[0m17:43:55.956240 [debug] [MainThread]: On master: COMMIT
[0m17:43:55.956670 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:43:55.957023 [debug] [MainThread]: On master: Close
[0m17:43:55.959487 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:43:55.959887 [info ] [MainThread]: 
[0m17:43:55.961985 [debug] [Thread-1 (]: Began running node model.ecom.OBT_ECOM
[0m17:43:55.962597 [info ] [Thread-1 (]: 1 of 4 START sql table model main.OBT_ECOM ..................................... [RUN]
[0m17:43:55.963539 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.OBT_ECOM'
[0m17:43:55.963908 [debug] [Thread-1 (]: Began compiling node model.ecom.OBT_ECOM
[0m17:43:55.969564 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.OBT_ECOM"
[0m17:43:55.970153 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECOM (compile): 17:43:55.964141 => 17:43:55.969936
[0m17:43:55.970539 [debug] [Thread-1 (]: Began executing node model.ecom.OBT_ECOM
[0m17:43:55.996279 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.OBT_ECOM"
[0m17:43:55.997028 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m17:43:55.997419 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: BEGIN
[0m17:43:55.997777 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:43:56.005099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:56.005596 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m17:43:56.005983 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECOM"} */

  
    
    

    create  table
      "ecom"."main"."OBT_ECOM__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



select *
from econ0
union all
select *
from econ1
union all
select *
from econ2
union all
select *
from econ3
union all
select *
from econ4
union all
select *
from econ5
union all
select *
from econ6
union all
select *
from econ7
union all
select *
from econ8
union all
select *
from econ9
union all
select *
from econ10

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m17:44:02.332653 [debug] [Thread-1 (]: SQL status: OK in 6.0 seconds
[0m17:44:02.339618 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m17:44:02.340148 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECOM"} */
alter table "ecom"."main"."OBT_ECOM" rename to "OBT_ECOM__dbt_backup"
[0m17:44:02.340961 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:02.343668 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m17:44:02.344059 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECOM"} */
alter table "ecom"."main"."OBT_ECOM__dbt_tmp" rename to "OBT_ECOM"
[0m17:44:02.344595 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:02.359692 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: COMMIT
[0m17:44:02.360119 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m17:44:02.360522 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: COMMIT
[0m17:44:06.401937 [debug] [Thread-1 (]: SQL status: OK in 4.0 seconds
[0m17:44:06.406928 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m17:44:06.407366 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECOM"} */
drop table if exists "ecom"."main"."OBT_ECOM__dbt_backup" cascade
[0m17:44:06.416952 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:06.418623 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECOM (execute): 17:43:55.970769 => 17:44:06.418401
[0m17:44:06.419059 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: Close
[0m17:44:06.559081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed140cb0-2934-4e65-98b5-3d1b1324f36b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8a3f7bb0>]}
[0m17:44:06.559924 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.OBT_ECOM ................................ [[32mOK[0m in 10.60s]
[0m17:44:06.560560 [debug] [Thread-1 (]: Finished running node model.ecom.OBT_ECOM
[0m17:44:06.561117 [debug] [Thread-1 (]: Began running node model.ecom.aggregates_ordered
[0m17:44:06.561586 [info ] [Thread-1 (]: 2 of 4 START sql view model main.aggregates_ordered ............................ [RUN]
[0m17:44:06.562669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.OBT_ECOM, now model.ecom.aggregates_ordered)
[0m17:44:06.563261 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates_ordered
[0m17:44:06.565880 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates_ordered"
[0m17:44:06.566517 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates_ordered (compile): 17:44:06.563522 => 17:44:06.566297
[0m17:44:06.566899 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates_ordered
[0m17:44:06.580241 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates_ordered"
[0m17:44:06.580784 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m17:44:06.581215 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: BEGIN
[0m17:44:06.581580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:06.588201 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:06.588728 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m17:44:06.589108 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */

  
  create view "ecom"."main"."aggregates_ordered__dbt_tmp" as (
    


select product_name, round(total_revenue,1) as total_revenue
from aggregates    
order by 2 desc
  );

[0m17:44:06.589899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:06.593118 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m17:44:06.593510 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
alter view "ecom"."main"."aggregates_ordered" rename to "aggregates_ordered__dbt_backup"
[0m17:44:06.594034 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:06.597476 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m17:44:06.597877 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
alter view "ecom"."main"."aggregates_ordered__dbt_tmp" rename to "aggregates_ordered"
[0m17:44:06.598371 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:06.600126 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: COMMIT
[0m17:44:06.600519 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m17:44:06.600884 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: COMMIT
[0m17:44:06.603890 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:06.606411 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m17:44:06.606791 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */
drop view if exists "ecom"."main"."aggregates_ordered__dbt_backup" cascade
[0m17:44:06.609141 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:06.610671 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates_ordered (execute): 17:44:06.567132 => 17:44:06.610392
[0m17:44:06.611128 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: Close
[0m17:44:06.653228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed140cb0-2934-4e65-98b5-3d1b1324f36b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8a44faf0>]}
[0m17:44:06.654000 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main.aggregates_ordered ....................... [[32mOK[0m in 0.09s]
[0m17:44:06.654595 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates_ordered
[0m17:44:06.655060 [debug] [Thread-1 (]: Began running node model.ecom.revenue
[0m17:44:06.655708 [info ] [Thread-1 (]: 3 of 4 START sql view model main.revenue ....................................... [RUN]
[0m17:44:06.656530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.aggregates_ordered, now model.ecom.revenue)
[0m17:44:06.656913 [debug] [Thread-1 (]: Began compiling node model.ecom.revenue
[0m17:44:06.659464 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.revenue"
[0m17:44:06.660067 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (compile): 17:44:06.657152 => 17:44:06.659864
[0m17:44:06.660440 [debug] [Thread-1 (]: Began executing node model.ecom.revenue
[0m17:44:06.664069 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.revenue"
[0m17:44:06.664567 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m17:44:06.664947 [debug] [Thread-1 (]: On model.ecom.revenue: BEGIN
[0m17:44:06.665293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:06.671491 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:06.672077 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m17:44:06.672441 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */

  
  create view "ecom"."main"."revenue__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *, quantity * price as revenue
from "ecom"."main"."OBT_ECOM"
  );

[0m17:44:06.673017 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:06.676167 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m17:44:06.676542 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue" rename to "revenue__dbt_backup"
[0m17:44:06.677013 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:06.679463 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m17:44:06.679835 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue__dbt_tmp" rename to "revenue"
[0m17:44:06.680304 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:06.681939 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m17:44:06.682318 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m17:44:06.682669 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m17:44:06.685716 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:06.688196 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m17:44:06.688590 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
drop view if exists "ecom"."main"."revenue__dbt_backup" cascade
[0m17:44:06.691148 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:06.692780 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (execute): 17:44:06.660673 => 17:44:06.692509
[0m17:44:06.693168 [debug] [Thread-1 (]: On model.ecom.revenue: Close
[0m17:44:06.734659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed140cb0-2934-4e65-98b5-3d1b1324f36b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8a481f30>]}
[0m17:44:06.735668 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main.revenue .................................. [[32mOK[0m in 0.08s]
[0m17:44:06.736428 [debug] [Thread-1 (]: Finished running node model.ecom.revenue
[0m17:44:06.737847 [debug] [Thread-1 (]: Began running node model.ecom.aggregates
[0m17:44:06.738675 [info ] [Thread-1 (]: 4 of 4 START sql view model main.aggregates .................................... [RUN]
[0m17:44:06.739382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.revenue, now model.ecom.aggregates)
[0m17:44:06.739811 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates
[0m17:44:06.743224 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates"
[0m17:44:06.743980 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (compile): 17:44:06.740097 => 17:44:06.743718
[0m17:44:06.744446 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates
[0m17:44:06.750299 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates"
[0m17:44:06.750929 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m17:44:06.751422 [debug] [Thread-1 (]: On model.ecom.aggregates: BEGIN
[0m17:44:06.751877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:06.760152 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:06.760875 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m17:44:06.761418 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */

  
  create view "ecom"."main"."aggregates__dbt_tmp" as (
    


SELECT 
    YEAR(timestamp) AS order_year,
    COUNT(id) AS total_orders,
    SUM(quantity) AS total_items_sold,
    SUM(revenue) AS total_revenue,
    AVG(price) AS avg_price,
    MAX(revenue) AS max_revenue,
    MIN(revenue) AS min_revenue,
    AVG(discount_applied) AS avg_discount_applied
FROM "ecom"."main"."revenue"
GROUP BY YEAR(timestamp)
  );

[0m17:44:06.762427 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:06.766732 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m17:44:06.767157 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
alter view "ecom"."main"."aggregates" rename to "aggregates__dbt_backup"
[0m17:44:06.767857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:06.771826 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m17:44:06.772416 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
alter view "ecom"."main"."aggregates__dbt_tmp" rename to "aggregates"
[0m17:44:06.773251 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:06.775369 [debug] [Thread-1 (]: On model.ecom.aggregates: COMMIT
[0m17:44:06.775894 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m17:44:06.776369 [debug] [Thread-1 (]: On model.ecom.aggregates: COMMIT
[0m17:44:06.779739 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:06.784109 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m17:44:06.784771 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
drop view if exists "ecom"."main"."aggregates__dbt_backup" cascade
[0m17:44:06.787750 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:06.790010 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (execute): 17:44:06.744731 => 17:44:06.789751
[0m17:44:06.790492 [debug] [Thread-1 (]: On model.ecom.aggregates: Close
[0m17:44:06.840843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed140cb0-2934-4e65-98b5-3d1b1324f36b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8a4954e0>]}
[0m17:44:06.842098 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.aggregates ............................... [[32mOK[0m in 0.10s]
[0m17:44:06.842919 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates
[0m17:44:06.844903 [debug] [MainThread]: Using duckdb connection "master"
[0m17:44:06.845759 [debug] [MainThread]: On master: BEGIN
[0m17:44:06.846376 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:44:06.871794 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:44:06.872650 [debug] [MainThread]: On master: COMMIT
[0m17:44:06.873191 [debug] [MainThread]: Using duckdb connection "master"
[0m17:44:06.873732 [debug] [MainThread]: On master: COMMIT
[0m17:44:06.874400 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:44:06.874909 [debug] [MainThread]: On master: Close
[0m17:44:06.878764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:06.879372 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m17:44:06.879790 [debug] [MainThread]: Connection 'model.ecom.aggregates' was properly closed.
[0m17:44:06.880329 [info ] [MainThread]: 
[0m17:44:06.880817 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 11.01 seconds (11.01s).
[0m17:44:06.882044 [debug] [MainThread]: Command end result
[0m17:44:06.892591 [info ] [MainThread]: 
[0m17:44:06.893976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:44:06.894870 [info ] [MainThread]: 
[0m17:44:06.895593 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:44:06.897669 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.547713, "process_user_time": 41.628345, "process_kernel_time": 3.6639, "process_mem_max_rss": "3297760", "process_in_blocks": "68032", "process_out_blocks": "2084016"}
[0m17:44:06.898729 [debug] [MainThread]: Command `dbt run` succeeded at 17:44:06.898520 after 11.55 seconds
[0m17:44:06.899374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e998c68c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8a58fb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8a4954e0>]}
[0m17:44:06.899962 [debug] [MainThread]: Flushing usage events
[0m19:27:33.457193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b8f3d28f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b8d0be110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b8d0bc430>]}


============================== 19:27:33.459741 | ebe961c1-3256-49df-9dce-a63827700d5e ==============================
[0m19:27:33.459741 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:27:33.460323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peek/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/peek/code/ecom/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:27:33.677519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebe961c1-3256-49df-9dce-a63827700d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b8d0bf6a0>]}
[0m19:27:33.747675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebe961c1-3256-49df-9dce-a63827700d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b82234df0>]}
[0m19:27:33.748608 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m19:27:33.754748 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:27:33.780795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:27:33.781623 [debug] [MainThread]: Partial parsing: updated file: ecom://models/example/schema.yml
[0m19:27:33.782014 [debug] [MainThread]: Partial parsing: updated file: ecom://models/example/aggregates.sql
[0m19:27:34.008058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebe961c1-3256-49df-9dce-a63827700d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7bd540d0>]}
[0m19:27:34.018324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebe961c1-3256-49df-9dce-a63827700d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b8200cf40>]}
[0m19:27:34.018897 [info ] [MainThread]: Found 11 seeds, 4 models, 3 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m19:27:34.019354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebe961c1-3256-49df-9dce-a63827700d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b8200cfa0>]}
[0m19:27:34.020884 [info ] [MainThread]: 
[0m19:27:34.021621 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:27:34.023106 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m19:27:34.032651 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m19:27:34.033118 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m19:27:34.033460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:34.047425 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:27:34.049099 [debug] [ThreadPool]: On list_ecom: Close
[0m19:27:34.052983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m19:27:34.053744 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m19:27:34.057674 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m19:27:34.058055 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m19:27:34.058474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:27:34.064878 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:27:34.065359 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m19:27:34.065750 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m19:27:34.066415 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:27:34.067258 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m19:27:34.067600 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m19:27:34.067914 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m19:27:34.068312 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:27:34.068694 [debug] [ThreadPool]: On create_ecom_main: Close
[0m19:27:34.072611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m19:27:34.077104 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m19:27:34.077453 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m19:27:34.077765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:27:34.084354 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:27:34.084878 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m19:27:34.085218 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m19:27:34.097184 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:27:34.100939 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m19:27:34.101646 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m19:27:34.102050 [debug] [ThreadPool]: On list_ecom_main: Close
[0m19:27:34.107313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebe961c1-3256-49df-9dce-a63827700d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7bd9bee0>]}
[0m19:27:34.108014 [debug] [MainThread]: Using duckdb connection "master"
[0m19:27:34.108478 [debug] [MainThread]: On master: BEGIN
[0m19:27:34.108810 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:27:34.115277 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:27:34.115734 [debug] [MainThread]: On master: COMMIT
[0m19:27:34.116077 [debug] [MainThread]: Using duckdb connection "master"
[0m19:27:34.116405 [debug] [MainThread]: On master: COMMIT
[0m19:27:34.116802 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:27:34.117185 [debug] [MainThread]: On master: Close
[0m19:27:34.119392 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:27:34.119800 [info ] [MainThread]: 
[0m19:27:34.122140 [debug] [Thread-1 (]: Began running node model.ecom.OBT_ECOM
[0m19:27:34.122656 [info ] [Thread-1 (]: 1 of 4 START sql table model main.OBT_ECOM ..................................... [RUN]
[0m19:27:34.123386 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.OBT_ECOM'
[0m19:27:34.123760 [debug] [Thread-1 (]: Began compiling node model.ecom.OBT_ECOM
[0m19:27:34.129754 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.OBT_ECOM"
[0m19:27:34.130507 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECOM (compile): 19:27:34.123998 => 19:27:34.130296
[0m19:27:34.130897 [debug] [Thread-1 (]: Began executing node model.ecom.OBT_ECOM
[0m19:27:34.156775 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.OBT_ECOM"
[0m19:27:34.157690 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m19:27:34.158100 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: BEGIN
[0m19:27:34.158462 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:27:34.165520 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:27:34.166088 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m19:27:34.166564 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECOM"} */

  
    
    

    create  table
      "ecom"."main"."OBT_ECOM__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



select *
from econ0
union all
select *
from econ1
union all
select *
from econ2
union all
select *
from econ3
union all
select *
from econ4
union all
select *
from econ5
union all
select *
from econ6
union all
select *
from econ7
union all
select *
from econ8
union all
select *
from econ9
union all
select *
from econ10

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m19:27:44.017589 [debug] [Thread-1 (]: SQL status: OK in 10.0 seconds
[0m19:27:44.040184 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m19:27:44.041182 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECOM"} */
alter table "ecom"."main"."OBT_ECOM" rename to "OBT_ECOM__dbt_backup"
[0m19:27:44.046155 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:27:44.051447 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m19:27:44.052384 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECOM"} */
alter table "ecom"."main"."OBT_ECOM__dbt_tmp" rename to "OBT_ECOM"
[0m19:27:44.053762 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:27:44.083199 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: COMMIT
[0m19:27:44.084015 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m19:27:44.084586 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: COMMIT
[0m19:27:49.119778 [debug] [Thread-1 (]: SQL status: OK in 5.0 seconds
[0m19:27:49.124872 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m19:27:49.125295 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECOM"} */
drop table if exists "ecom"."main"."OBT_ECOM__dbt_backup" cascade
[0m19:27:49.135632 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:27:49.137530 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECOM (execute): 19:27:34.131135 => 19:27:49.137215
[0m19:27:49.138027 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: Close
[0m19:27:49.283364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebe961c1-3256-49df-9dce-a63827700d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7bdfbd30>]}
[0m19:27:49.285020 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.OBT_ECOM ................................ [[32mOK[0m in 15.16s]
[0m19:27:49.285900 [debug] [Thread-1 (]: Finished running node model.ecom.OBT_ECOM
[0m19:27:49.286464 [debug] [Thread-1 (]: Began running node model.ecom.aggregates_ordered
[0m19:27:49.287480 [info ] [Thread-1 (]: 2 of 4 START sql view model main.aggregates_ordered ............................ [RUN]
[0m19:27:49.288477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.OBT_ECOM, now model.ecom.aggregates_ordered)
[0m19:27:49.288981 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates_ordered
[0m19:27:49.291568 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates_ordered"
[0m19:27:49.292393 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates_ordered (compile): 19:27:49.289230 => 19:27:49.292179
[0m19:27:49.292790 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates_ordered
[0m19:27:49.306963 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates_ordered"
[0m19:27:49.307732 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m19:27:49.308132 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: BEGIN
[0m19:27:49.308490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:49.320215 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:27:49.320836 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates_ordered"
[0m19:27:49.321251 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates_ordered"} */

  
  create view "ecom"."main"."aggregates_ordered__dbt_tmp" as (
    


select product_name, round(total_revenue,1) as total_revenue
from aggregates    
order by 2 desc
  );

[0m19:27:49.326385 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates_ordered (execute): 19:27:49.293028 => 19:27:49.325994
[0m19:27:49.326876 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: ROLLBACK
[0m19:27:49.333475 [debug] [Thread-1 (]: Failed to rollback 'model.ecom.aggregates_ordered'
[0m19:27:49.333985 [debug] [Thread-1 (]: On model.ecom.aggregates_ordered: Close
[0m19:27:49.336907 [debug] [Thread-1 (]: Runtime Error in model aggregates_ordered (models/example/aggregates_ordered.sql)
  Binder Error: Referenced column "product_name" not found in FROM clause!
  Candidate bindings: "aggregates.avg_price"
[0m19:27:49.337389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebe961c1-3256-49df-9dce-a63827700d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7bc5f880>]}
[0m19:27:49.338033 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model main.aggregates_ordered ................... [[31mERROR[0m in 0.05s]
[0m19:27:49.338702 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates_ordered
[0m19:27:49.339156 [debug] [Thread-1 (]: Began running node model.ecom.revenue
[0m19:27:49.339860 [info ] [Thread-1 (]: 3 of 4 START sql view model main.revenue ....................................... [RUN]
[0m19:27:49.340489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.aggregates_ordered, now model.ecom.revenue)
[0m19:27:49.340858 [debug] [Thread-1 (]: Began compiling node model.ecom.revenue
[0m19:27:49.343687 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.revenue"
[0m19:27:49.344369 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (compile): 19:27:49.341126 => 19:27:49.344139
[0m19:27:49.344737 [debug] [Thread-1 (]: Began executing node model.ecom.revenue
[0m19:27:49.349549 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.revenue"
[0m19:27:49.350251 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m19:27:49.350661 [debug] [Thread-1 (]: On model.ecom.revenue: BEGIN
[0m19:27:49.351035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:49.358892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:27:49.359432 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m19:27:49.359807 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */

  
  create view "ecom"."main"."revenue__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *, quantity * price as revenue
from "ecom"."main"."OBT_ECOM"
  );

[0m19:27:49.360534 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:27:49.363887 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m19:27:49.364271 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue" rename to "revenue__dbt_backup"
[0m19:27:49.364852 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:27:49.367492 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m19:27:49.367887 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue__dbt_tmp" rename to "revenue"
[0m19:27:49.368408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:27:49.370017 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m19:27:49.370449 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m19:27:49.370801 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m19:27:49.374161 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:27:49.377515 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m19:27:49.378066 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
drop view if exists "ecom"."main"."revenue__dbt_backup" cascade
[0m19:27:49.380779 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:27:49.382386 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (execute): 19:27:49.344989 => 19:27:49.382157
[0m19:27:49.382810 [debug] [Thread-1 (]: On model.ecom.revenue: Close
[0m19:27:49.429240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebe961c1-3256-49df-9dce-a63827700d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b821efd60>]}
[0m19:27:49.430152 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main.revenue .................................. [[32mOK[0m in 0.09s]
[0m19:27:49.430906 [debug] [Thread-1 (]: Finished running node model.ecom.revenue
[0m19:27:49.432944 [debug] [Thread-1 (]: Began running node model.ecom.aggregates
[0m19:27:49.433623 [info ] [Thread-1 (]: 4 of 4 START sql view model main.aggregates .................................... [RUN]
[0m19:27:49.434465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.revenue, now model.ecom.aggregates)
[0m19:27:49.434918 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates
[0m19:27:49.439225 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates"
[0m19:27:49.440246 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (compile): 19:27:49.435258 => 19:27:49.439940
[0m19:27:49.440756 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates
[0m19:27:49.446230 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates"
[0m19:27:49.447167 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m19:27:49.447607 [debug] [Thread-1 (]: On model.ecom.aggregates: BEGIN
[0m19:27:49.448004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:49.457347 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:27:49.458043 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m19:27:49.458613 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */

  
  create view "ecom"."main"."aggregates__dbt_tmp" as (
    


SELECT 
    YEAR(timestamp) AS order_year,
    MONTH(timestamp) AS order_month,
    COUNT(id) AS total_orders,
    SUM(quantity) AS total_items_sold,
    SUM(revenue) AS total_revenue,
    AVG(price) AS avg_price,
    MAX(revenue) AS max_revenue,
    MIN(revenue) AS min_revenue,
    AVG(discount_applied) AS avg_discount_applied
FROM "ecom"."main"."revenue"
GROUP BY YEAR(timestamp),MONTH(timestamp) AS order_month
  );

[0m19:27:49.461199 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (execute): 19:27:49.441073 => 19:27:49.460885
[0m19:27:49.461864 [debug] [Thread-1 (]: On model.ecom.aggregates: ROLLBACK
[0m19:27:49.462758 [debug] [Thread-1 (]: Failed to rollback 'model.ecom.aggregates'
[0m19:27:49.463219 [debug] [Thread-1 (]: On model.ecom.aggregates: Close
[0m19:27:49.467069 [debug] [Thread-1 (]: Runtime Error in model aggregates (models/example/aggregates.sql)
  Parser Error: syntax error at or near "AS"
  LINE 19: ...{"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
  
    
    create view "ecom"."main"."aggregates__dbt_tmp" as (
      
  
  
  SELECT 
      YEAR(timestamp) AS order_year,
      MONTH(timestamp) AS order_month,
      COUNT(id) AS total_orders,
      SUM(quantity) AS total_items_sold,
      SUM(revenue) AS total_revenue,
      AVG(price) AS avg_price,
      MAX(revenue) AS max_revenue,
      MIN(revenue) AS min_revenue,
      AVG(discount_applied) AS avg_discount_applied
  FROM "ecom"."main"."revenue"
  GROUP BY YEAR(timestamp),MONTH(timestamp) AS order_month
                                                     ^
[0m19:27:49.467968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebe961c1-3256-49df-9dce-a63827700d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7bd49f30>]}
[0m19:27:49.468830 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model main.aggregates ........................... [[31mERROR[0m in 0.03s]
[0m19:27:49.469795 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates
[0m19:27:49.472081 [debug] [MainThread]: Using duckdb connection "master"
[0m19:27:49.472606 [debug] [MainThread]: On master: BEGIN
[0m19:27:49.473017 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:27:49.503490 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:27:49.504124 [debug] [MainThread]: On master: COMMIT
[0m19:27:49.504561 [debug] [MainThread]: Using duckdb connection "master"
[0m19:27:49.504940 [debug] [MainThread]: On master: COMMIT
[0m19:27:49.505451 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:27:49.505870 [debug] [MainThread]: On master: Close
[0m19:27:49.509133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:27:49.509564 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m19:27:49.509906 [debug] [MainThread]: Connection 'model.ecom.aggregates' was properly closed.
[0m19:27:49.510391 [info ] [MainThread]: 
[0m19:27:49.510824 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 15.49 seconds (15.49s).
[0m19:27:49.512092 [debug] [MainThread]: Command end result
[0m19:27:49.527097 [info ] [MainThread]: 
[0m19:27:49.527699 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:27:49.528105 [info ] [MainThread]: 
[0m19:27:49.528553 [error] [MainThread]:   Runtime Error in model aggregates_ordered (models/example/aggregates_ordered.sql)
  Binder Error: Referenced column "product_name" not found in FROM clause!
  Candidate bindings: "aggregates.avg_price"
[0m19:27:49.528925 [info ] [MainThread]: 
[0m19:27:49.529343 [error] [MainThread]:   Runtime Error in model aggregates (models/example/aggregates.sql)
  Parser Error: syntax error at or near "AS"
  LINE 19: ...{"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
  
    
    create view "ecom"."main"."aggregates__dbt_tmp" as (
      
  
  
  SELECT 
      YEAR(timestamp) AS order_year,
      MONTH(timestamp) AS order_month,
      COUNT(id) AS total_orders,
      SUM(quantity) AS total_items_sold,
      SUM(revenue) AS total_revenue,
      AVG(price) AS avg_price,
      MAX(revenue) AS max_revenue,
      MIN(revenue) AS min_revenue,
      AVG(discount_applied) AS avg_discount_applied
  FROM "ecom"."main"."revenue"
  GROUP BY YEAR(timestamp),MONTH(timestamp) AS order_month
                                                     ^
[0m19:27:49.529775 [info ] [MainThread]: 
[0m19:27:49.530259 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m19:27:49.532409 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 16.109478, "process_user_time": 44.23566, "process_kernel_time": 23.944248, "process_mem_max_rss": "3166092", "process_in_blocks": "86880", "process_out_blocks": "2049656", "command_success": false}
[0m19:27:49.533668 [debug] [MainThread]: Command `dbt run` failed at 19:27:49.533497 after 16.11 seconds
[0m19:27:49.534446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b8f3d28f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7bdba9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7bdb8760>]}
[0m19:27:49.534886 [debug] [MainThread]: Flushing usage events
[0m19:29:43.469956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd52bd7cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd508b9db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd508bb430>]}


============================== 19:29:43.472393 | 1a7abd92-0e86-43d6-8c0b-2536f9a2705d ==============================
[0m19:29:43.472393 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:29:43.472874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/peek/code/ecom/logs', 'version_check': 'True', 'profiles_dir': '/home/peek/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:29:43.652200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a7abd92-0e86-43d6-8c0b-2536f9a2705d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd513fd570>]}
[0m19:29:43.721066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a7abd92-0e86-43d6-8c0b-2536f9a2705d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd45a37460>]}
[0m19:29:43.721820 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m19:29:43.728398 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:29:43.751044 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m19:29:43.751571 [debug] [MainThread]: Partial parsing: deleted file: ecom://models/example/aggregates_ordered.sql
[0m19:29:43.752059 [debug] [MainThread]: Partial parsing: updated file: ecom://models/example/aggregates.sql
[0m19:29:43.971830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a7abd92-0e86-43d6-8c0b-2536f9a2705d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2774c0d0>]}
[0m19:29:43.978941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a7abd92-0e86-43d6-8c0b-2536f9a2705d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd4580d090>]}
[0m19:29:43.979417 [info ] [MainThread]: Found 11 seeds, 3 models, 3 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m19:29:43.979802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a7abd92-0e86-43d6-8c0b-2536f9a2705d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd4580d120>]}
[0m19:29:43.981151 [info ] [MainThread]: 
[0m19:29:43.981894 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:29:43.982894 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom'
[0m19:29:43.992076 [debug] [ThreadPool]: Using duckdb connection "list_ecom"
[0m19:29:43.992445 [debug] [ThreadPool]: On list_ecom: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"ecom"'
    
  
  
[0m19:29:43.992775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:44.003585 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:29:44.005102 [debug] [ThreadPool]: On list_ecom: Close
[0m19:29:44.007794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecom, now create_ecom_main)
[0m19:29:44.008408 [debug] [ThreadPool]: Creating schema "database: "ecom"
schema: "main"
"
[0m19:29:44.012269 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m19:29:44.012612 [debug] [ThreadPool]: On create_ecom_main: BEGIN
[0m19:29:44.012918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:44.018187 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:29:44.018569 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m19:29:44.018885 [debug] [ThreadPool]: On create_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "create_ecom_main"} */
create schema if not exists "ecom"."main"
[0m19:29:44.019398 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:29:44.020300 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m19:29:44.020638 [debug] [ThreadPool]: Using duckdb connection "create_ecom_main"
[0m19:29:44.020968 [debug] [ThreadPool]: On create_ecom_main: COMMIT
[0m19:29:44.021369 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:29:44.021704 [debug] [ThreadPool]: On create_ecom_main: Close
[0m19:29:44.024933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecom_main, now list_ecom_main)
[0m19:29:44.029924 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m19:29:44.030283 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m19:29:44.030587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:44.037196 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:29:44.037682 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m19:29:44.038015 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m19:29:44.049182 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:29:44.052731 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m19:29:44.053320 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m19:29:44.053646 [debug] [ThreadPool]: On list_ecom_main: Close
[0m19:29:44.059016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a7abd92-0e86-43d6-8c0b-2536f9a2705d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd27793c70>]}
[0m19:29:44.059518 [debug] [MainThread]: Using duckdb connection "master"
[0m19:29:44.059851 [debug] [MainThread]: On master: BEGIN
[0m19:29:44.060175 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:29:44.066549 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:29:44.066949 [debug] [MainThread]: On master: COMMIT
[0m19:29:44.067279 [debug] [MainThread]: Using duckdb connection "master"
[0m19:29:44.067647 [debug] [MainThread]: On master: COMMIT
[0m19:29:44.068031 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:29:44.068363 [debug] [MainThread]: On master: Close
[0m19:29:44.070217 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:29:44.070607 [info ] [MainThread]: 
[0m19:29:44.072766 [debug] [Thread-1 (]: Began running node model.ecom.OBT_ECOM
[0m19:29:44.073252 [info ] [Thread-1 (]: 1 of 3 START sql table model main.OBT_ECOM ..................................... [RUN]
[0m19:29:44.073974 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecom.OBT_ECOM'
[0m19:29:44.074335 [debug] [Thread-1 (]: Began compiling node model.ecom.OBT_ECOM
[0m19:29:44.079889 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.OBT_ECOM"
[0m19:29:44.080507 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECOM (compile): 19:29:44.074564 => 19:29:44.080300
[0m19:29:44.080872 [debug] [Thread-1 (]: Began executing node model.ecom.OBT_ECOM
[0m19:29:44.105854 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.OBT_ECOM"
[0m19:29:44.106714 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m19:29:44.107263 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: BEGIN
[0m19:29:44.107624 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:29:44.115688 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:29:44.116202 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m19:29:44.116604 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECOM"} */

  
    
    

    create  table
      "ecom"."main"."OBT_ECOM__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



select *
from econ0
union all
select *
from econ1
union all
select *
from econ2
union all
select *
from econ3
union all
select *
from econ4
union all
select *
from econ5
union all
select *
from econ6
union all
select *
from econ7
union all
select *
from econ8
union all
select *
from econ9
union all
select *
from econ10

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m19:29:50.517112 [debug] [Thread-1 (]: SQL status: OK in 6.0 seconds
[0m19:29:50.523799 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m19:29:50.524232 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECOM"} */
alter table "ecom"."main"."OBT_ECOM" rename to "OBT_ECOM__dbt_backup"
[0m19:29:50.524917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:29:50.527243 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m19:29:50.527607 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECOM"} */
alter table "ecom"."main"."OBT_ECOM__dbt_tmp" rename to "OBT_ECOM"
[0m19:29:50.528086 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:29:50.542396 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: COMMIT
[0m19:29:50.542828 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m19:29:50.543206 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: COMMIT
[0m19:29:54.191263 [debug] [Thread-1 (]: SQL status: OK in 4.0 seconds
[0m19:29:54.196313 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.OBT_ECOM"
[0m19:29:54.196724 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.OBT_ECOM"} */
drop table if exists "ecom"."main"."OBT_ECOM__dbt_backup" cascade
[0m19:29:54.206390 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:29:54.207865 [debug] [Thread-1 (]: Timing info for model.ecom.OBT_ECOM (execute): 19:29:44.081130 => 19:29:54.207663
[0m19:29:54.208263 [debug] [Thread-1 (]: On model.ecom.OBT_ECOM: Close
[0m19:29:54.337445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a7abd92-0e86-43d6-8c0b-2536f9a2705d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd277f3f40>]}
[0m19:29:54.338218 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.OBT_ECOM ................................ [[32mOK[0m in 10.26s]
[0m19:29:54.338886 [debug] [Thread-1 (]: Finished running node model.ecom.OBT_ECOM
[0m19:29:54.339898 [debug] [Thread-1 (]: Began running node model.ecom.revenue
[0m19:29:54.340495 [info ] [Thread-1 (]: 2 of 3 START sql view model main.revenue ....................................... [RUN]
[0m19:29:54.341419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.OBT_ECOM, now model.ecom.revenue)
[0m19:29:54.341845 [debug] [Thread-1 (]: Began compiling node model.ecom.revenue
[0m19:29:54.344479 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.revenue"
[0m19:29:54.345088 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (compile): 19:29:54.342091 => 19:29:54.344884
[0m19:29:54.345431 [debug] [Thread-1 (]: Began executing node model.ecom.revenue
[0m19:29:54.358939 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.revenue"
[0m19:29:54.359654 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m19:29:54.360045 [debug] [Thread-1 (]: On model.ecom.revenue: BEGIN
[0m19:29:54.360397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:54.367030 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:29:54.367541 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m19:29:54.367921 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */

  
  create view "ecom"."main"."revenue__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *, quantity * price as revenue
from "ecom"."main"."OBT_ECOM"
  );

[0m19:29:54.368562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:29:54.371660 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m19:29:54.372093 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue" rename to "revenue__dbt_backup"
[0m19:29:54.372561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:29:54.376336 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m19:29:54.376764 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
alter view "ecom"."main"."revenue__dbt_tmp" rename to "revenue"
[0m19:29:54.377275 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:29:54.378788 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m19:29:54.379151 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m19:29:54.379491 [debug] [Thread-1 (]: On model.ecom.revenue: COMMIT
[0m19:29:54.382681 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:29:54.385148 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.revenue"
[0m19:29:54.385518 [debug] [Thread-1 (]: On model.ecom.revenue: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.revenue"} */
drop view if exists "ecom"."main"."revenue__dbt_backup" cascade
[0m19:29:54.388472 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:29:54.390004 [debug] [Thread-1 (]: Timing info for model.ecom.revenue (execute): 19:29:54.345656 => 19:29:54.389812
[0m19:29:54.390375 [debug] [Thread-1 (]: On model.ecom.revenue: Close
[0m19:29:54.432926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a7abd92-0e86-43d6-8c0b-2536f9a2705d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd277f3f40>]}
[0m19:29:54.433740 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.revenue .................................. [[32mOK[0m in 0.09s]
[0m19:29:54.434328 [debug] [Thread-1 (]: Finished running node model.ecom.revenue
[0m19:29:54.435526 [debug] [Thread-1 (]: Began running node model.ecom.aggregates
[0m19:29:54.435994 [info ] [Thread-1 (]: 3 of 3 START sql view model main.aggregates .................................... [RUN]
[0m19:29:54.436626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecom.revenue, now model.ecom.aggregates)
[0m19:29:54.437000 [debug] [Thread-1 (]: Began compiling node model.ecom.aggregates
[0m19:29:54.439771 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecom.aggregates"
[0m19:29:54.440380 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (compile): 19:29:54.437231 => 19:29:54.440177
[0m19:29:54.440753 [debug] [Thread-1 (]: Began executing node model.ecom.aggregates
[0m19:29:54.444273 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecom.aggregates"
[0m19:29:54.444794 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m19:29:54.445160 [debug] [Thread-1 (]: On model.ecom.aggregates: BEGIN
[0m19:29:54.445499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:54.451435 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:29:54.451928 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m19:29:54.452309 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */

  
  create view "ecom"."main"."aggregates__dbt_tmp" as (
    


SELECT 
    YEAR(timestamp) AS order_year,
    MONTH(timestamp) AS order_month,
    COUNT(id) AS total_orders,
    SUM(quantity) AS total_items_sold,
    SUM(revenue) AS total_revenue,
    AVG(price) AS avg_price,
    MAX(revenue) AS max_revenue,
    MIN(revenue) AS min_revenue,
    AVG(discount_applied) AS avg_discount_applied
FROM "ecom"."main"."revenue"
GROUP BY YEAR(timestamp),MONTH(timestamp)
  );

[0m19:29:54.453163 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:29:54.456026 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m19:29:54.456392 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
alter view "ecom"."main"."aggregates" rename to "aggregates__dbt_backup"
[0m19:29:54.456848 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:29:54.459004 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m19:29:54.459364 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
alter view "ecom"."main"."aggregates__dbt_tmp" rename to "aggregates"
[0m19:29:54.459812 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:29:54.461609 [debug] [Thread-1 (]: On model.ecom.aggregates: COMMIT
[0m19:29:54.462065 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m19:29:54.462414 [debug] [Thread-1 (]: On model.ecom.aggregates: COMMIT
[0m19:29:54.465442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:29:54.467946 [debug] [Thread-1 (]: Using duckdb connection "model.ecom.aggregates"
[0m19:29:54.468313 [debug] [Thread-1 (]: On model.ecom.aggregates: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "model.ecom.aggregates"} */
drop view if exists "ecom"."main"."aggregates__dbt_backup" cascade
[0m19:29:54.470749 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:29:54.472026 [debug] [Thread-1 (]: Timing info for model.ecom.aggregates (execute): 19:29:54.440985 => 19:29:54.471829
[0m19:29:54.472407 [debug] [Thread-1 (]: On model.ecom.aggregates: Close
[0m19:29:54.513097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a7abd92-0e86-43d6-8c0b-2536f9a2705d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd27657e80>]}
[0m19:29:54.513873 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.aggregates ............................... [[32mOK[0m in 0.08s]
[0m19:29:54.514497 [debug] [Thread-1 (]: Finished running node model.ecom.aggregates
[0m19:29:54.518476 [debug] [MainThread]: Using duckdb connection "master"
[0m19:29:54.518946 [debug] [MainThread]: On master: BEGIN
[0m19:29:54.519362 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:29:54.536979 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:29:54.537541 [debug] [MainThread]: On master: COMMIT
[0m19:29:54.537877 [debug] [MainThread]: Using duckdb connection "master"
[0m19:29:54.538194 [debug] [MainThread]: On master: COMMIT
[0m19:29:54.538571 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:29:54.538939 [debug] [MainThread]: On master: Close
[0m19:29:54.541224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:29:54.541560 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m19:29:54.541881 [debug] [MainThread]: Connection 'model.ecom.aggregates' was properly closed.
[0m19:29:54.542278 [info ] [MainThread]: 
[0m19:29:54.542679 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 10.56 seconds (10.56s).
[0m19:29:54.543507 [debug] [MainThread]: Command end result
[0m19:29:54.551143 [info ] [MainThread]: 
[0m19:29:54.551644 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:29:54.552028 [info ] [MainThread]: 
[0m19:29:54.552396 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:29:54.553148 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.116894, "process_user_time": 39.19002, "process_kernel_time": 6.516044, "process_mem_max_rss": "3268196", "process_in_blocks": "6264", "process_out_blocks": "2061432"}
[0m19:29:54.553680 [debug] [MainThread]: Command `dbt run` succeeded at 19:29:54.553558 after 11.12 seconds
[0m19:29:54.554053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd52bd7cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd45a37460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd276afc40>]}
[0m19:29:54.554429 [debug] [MainThread]: Flushing usage events
[0m01:32:34.626761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8379f3c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8356daf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8356da470>]}


============================== 01:32:34.628854 | 2632da42-98a1-4694-bd98-4c91a7290314 ==============================
[0m01:32:34.628854 [info ] [MainThread]: Running with dbt=1.7.2
[0m01:32:34.629362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/peek/code/ecom/logs', 'fail_fast': 'False', 'profiles_dir': '/home/peek/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:32:34.782016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2632da42-98a1-4694-bd98-4c91a7290314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8355c3520>]}
[0m01:32:34.846202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2632da42-98a1-4694-bd98-4c91a7290314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc82a837490>]}
[0m01:32:34.847131 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m01:32:34.853394 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m01:32:34.861937 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:32:34.862522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2632da42-98a1-4694-bd98-4c91a7290314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc82a8002b0>]}
[0m01:32:35.746054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2632da42-98a1-4694-bd98-4c91a7290314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8283d5c90>]}
[0m01:32:35.755536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2632da42-98a1-4694-bd98-4c91a7290314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc82a709ae0>]}
[0m01:32:35.756150 [info ] [MainThread]: Found 3 models, 11 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m01:32:35.756603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2632da42-98a1-4694-bd98-4c91a7290314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8283fe590>]}
[0m01:32:35.758032 [info ] [MainThread]: 
[0m01:32:35.758898 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:32:35.760862 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_ecom_main'
[0m01:32:35.769322 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m01:32:35.769948 [debug] [ThreadPool]: On list_ecom_main: BEGIN
[0m01:32:35.770350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:32:35.780027 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:32:35.780784 [debug] [ThreadPool]: Using duckdb connection "list_ecom_main"
[0m01:32:35.781141 [debug] [ThreadPool]: On list_ecom_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "connection_name": "list_ecom_main"} */
select
      'ecom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'ecom'
  
[0m01:32:35.792700 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:32:35.797458 [debug] [ThreadPool]: On list_ecom_main: ROLLBACK
[0m01:32:35.798790 [debug] [ThreadPool]: Failed to rollback 'list_ecom_main'
[0m01:32:35.799337 [debug] [ThreadPool]: On list_ecom_main: Close
[0m01:32:35.805771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2632da42-98a1-4694-bd98-4c91a7290314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8283d6b90>]}
[0m01:32:35.806415 [debug] [MainThread]: Using duckdb connection "master"
[0m01:32:35.806765 [debug] [MainThread]: On master: BEGIN
[0m01:32:35.807132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:32:35.813723 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:32:35.814324 [debug] [MainThread]: On master: COMMIT
[0m01:32:35.814694 [debug] [MainThread]: Using duckdb connection "master"
[0m01:32:35.815018 [debug] [MainThread]: On master: COMMIT
[0m01:32:35.815528 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:32:35.815871 [debug] [MainThread]: On master: Close
[0m01:32:35.818353 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:32:35.818824 [info ] [MainThread]: 
[0m01:32:35.821058 [debug] [Thread-1 (]: Began running node test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6
[0m01:32:35.821811 [info ] [Thread-1 (]: 1 of 3 START test not_null_OBT_ECOM_id ......................................... [RUN]
[0m01:32:35.822677 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6'
[0m01:32:35.823066 [debug] [Thread-1 (]: Began compiling node test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6
[0m01:32:35.836400 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6"
[0m01:32:35.837472 [debug] [Thread-1 (]: Timing info for test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6 (compile): 01:32:35.823301 => 01:32:35.837202
[0m01:32:35.837902 [debug] [Thread-1 (]: Began executing node test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6
[0m01:32:35.849535 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6"
[0m01:32:35.850255 [debug] [Thread-1 (]: Using duckdb connection "test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6"
[0m01:32:35.850635 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6: BEGIN
[0m01:32:35.850982 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:32:35.857903 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:32:35.858426 [debug] [Thread-1 (]: Using duckdb connection "test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6"
[0m01:32:35.858797 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "ecom"."main"."OBT_ECOM"
where id is null



      
    ) dbt_internal_test
[0m01:32:35.860512 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:32:35.862852 [debug] [Thread-1 (]: Timing info for test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6 (execute): 01:32:35.838149 => 01:32:35.862626
[0m01:32:35.863259 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6: ROLLBACK
[0m01:32:35.863676 [debug] [Thread-1 (]: Failed to rollback 'test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6'
[0m01:32:35.864039 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6: Close
[0m01:32:35.866584 [info ] [Thread-1 (]: 1 of 3 PASS not_null_OBT_ECOM_id ............................................... [[32mPASS[0m in 0.04s]
[0m01:32:35.867255 [debug] [Thread-1 (]: Finished running node test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6
[0m01:32:35.867693 [debug] [Thread-1 (]: Began running node test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95
[0m01:32:35.868183 [info ] [Thread-1 (]: 2 of 3 START test not_null_OBT_ECOM_timestamp .................................. [RUN]
[0m01:32:35.868793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecom.not_null_OBT_ECOM_id.4f2a4de7d6, now test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95)
[0m01:32:35.869162 [debug] [Thread-1 (]: Began compiling node test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95
[0m01:32:35.872782 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95"
[0m01:32:35.873393 [debug] [Thread-1 (]: Timing info for test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95 (compile): 01:32:35.869397 => 01:32:35.873190
[0m01:32:35.873776 [debug] [Thread-1 (]: Began executing node test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95
[0m01:32:35.875920 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95"
[0m01:32:35.876568 [debug] [Thread-1 (]: Using duckdb connection "test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95"
[0m01:32:35.876955 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95: BEGIN
[0m01:32:35.877361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:35.883930 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:32:35.884483 [debug] [Thread-1 (]: Using duckdb connection "test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95"
[0m01:32:35.884881 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "ecom"."main"."OBT_ECOM"
where timestamp is null



      
    ) dbt_internal_test
[0m01:32:35.885814 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:32:35.887201 [debug] [Thread-1 (]: Timing info for test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95 (execute): 01:32:35.874036 => 01:32:35.886936
[0m01:32:35.887596 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95: ROLLBACK
[0m01:32:35.888017 [debug] [Thread-1 (]: Failed to rollback 'test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95'
[0m01:32:35.888372 [debug] [Thread-1 (]: On test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95: Close
[0m01:32:35.891413 [info ] [Thread-1 (]: 2 of 3 PASS not_null_OBT_ECOM_timestamp ........................................ [[32mPASS[0m in 0.02s]
[0m01:32:35.892114 [debug] [Thread-1 (]: Finished running node test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95
[0m01:32:35.892561 [debug] [Thread-1 (]: Began running node test.ecom.unique_OBT_ECOM_id.d0ccddc384
[0m01:32:35.893060 [info ] [Thread-1 (]: 3 of 3 START test unique_OBT_ECOM_id ........................................... [RUN]
[0m01:32:35.893682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecom.not_null_OBT_ECOM_timestamp.0f0bd2dc95, now test.ecom.unique_OBT_ECOM_id.d0ccddc384)
[0m01:32:35.894053 [debug] [Thread-1 (]: Began compiling node test.ecom.unique_OBT_ECOM_id.d0ccddc384
[0m01:32:35.900460 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecom.unique_OBT_ECOM_id.d0ccddc384"
[0m01:32:35.901230 [debug] [Thread-1 (]: Timing info for test.ecom.unique_OBT_ECOM_id.d0ccddc384 (compile): 01:32:35.894287 => 01:32:35.901004
[0m01:32:35.901667 [debug] [Thread-1 (]: Began executing node test.ecom.unique_OBT_ECOM_id.d0ccddc384
[0m01:32:35.904080 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecom.unique_OBT_ECOM_id.d0ccddc384"
[0m01:32:35.904844 [debug] [Thread-1 (]: Using duckdb connection "test.ecom.unique_OBT_ECOM_id.d0ccddc384"
[0m01:32:35.905320 [debug] [Thread-1 (]: On test.ecom.unique_OBT_ECOM_id.d0ccddc384: BEGIN
[0m01:32:35.905673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:35.911643 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:32:35.912189 [debug] [Thread-1 (]: Using duckdb connection "test.ecom.unique_OBT_ECOM_id.d0ccddc384"
[0m01:32:35.912577 [debug] [Thread-1 (]: On test.ecom.unique_OBT_ECOM_id.d0ccddc384: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "ecom", "target_name": "dev", "node_id": "test.ecom.unique_OBT_ECOM_id.d0ccddc384"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "ecom"."main"."OBT_ECOM"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:32:36.277662 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:32:36.279916 [debug] [Thread-1 (]: Timing info for test.ecom.unique_OBT_ECOM_id.d0ccddc384 (execute): 01:32:35.901908 => 01:32:36.279631
[0m01:32:36.280445 [debug] [Thread-1 (]: On test.ecom.unique_OBT_ECOM_id.d0ccddc384: ROLLBACK
[0m01:32:36.281059 [debug] [Thread-1 (]: Failed to rollback 'test.ecom.unique_OBT_ECOM_id.d0ccddc384'
[0m01:32:36.281575 [debug] [Thread-1 (]: On test.ecom.unique_OBT_ECOM_id.d0ccddc384: Close
[0m01:32:36.296510 [error] [Thread-1 (]: 3 of 3 FAIL 80000 unique_OBT_ECOM_id ........................................... [[31mFAIL 80000[0m in 0.40s]
[0m01:32:36.297541 [debug] [Thread-1 (]: Finished running node test.ecom.unique_OBT_ECOM_id.d0ccddc384
[0m01:32:36.299536 [debug] [MainThread]: Using duckdb connection "master"
[0m01:32:36.300050 [debug] [MainThread]: On master: BEGIN
[0m01:32:36.300432 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:32:36.307633 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:32:36.308481 [debug] [MainThread]: On master: COMMIT
[0m01:32:36.309240 [debug] [MainThread]: Using duckdb connection "master"
[0m01:32:36.309783 [debug] [MainThread]: On master: COMMIT
[0m01:32:36.310416 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:32:36.311196 [debug] [MainThread]: On master: Close
[0m01:32:36.315778 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:32:36.316293 [debug] [MainThread]: Connection 'list_ecom_main' was properly closed.
[0m01:32:36.316723 [debug] [MainThread]: Connection 'test.ecom.unique_OBT_ECOM_id.d0ccddc384' was properly closed.
[0m01:32:36.317324 [info ] [MainThread]: 
[0m01:32:36.317957 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m01:32:36.319056 [debug] [MainThread]: Command end result
[0m01:32:36.329308 [info ] [MainThread]: 
[0m01:32:36.330075 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:32:36.330662 [info ] [MainThread]: 
[0m01:32:36.331322 [error] [MainThread]: [31mFailure in test unique_OBT_ECOM_id (models/example/schema.yml)[0m
[0m01:32:36.331942 [error] [MainThread]:   Got 80000 results, configured to fail if != 0
[0m01:32:36.332629 [info ] [MainThread]: 
[0m01:32:36.333284 [info ] [MainThread]:   compiled Code at target/compiled/ecom/models/example/schema.yml/unique_OBT_ECOM_id.sql
[0m01:32:36.333906 [info ] [MainThread]: 
[0m01:32:36.334539 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m01:32:36.336775 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.7408594, "process_user_time": 5.295116, "process_kernel_time": 0.703336, "process_mem_max_rss": "570816", "process_in_blocks": "465664", "process_out_blocks": "2544", "command_success": false}
[0m01:32:36.337895 [debug] [MainThread]: Command `cli test` failed at 01:32:36.337657 after 1.74 seconds
[0m01:32:36.338572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8379f3c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc82a837490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8355d5180>]}
[0m01:32:36.339225 [debug] [MainThread]: Flushing usage events
